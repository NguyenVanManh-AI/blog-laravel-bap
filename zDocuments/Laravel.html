



Laravel 
laravel1 
video39 : webvideo39.php + routes/web.php + app/http/controller/UserController.php + routes/api.php + resources/views/welcome.blade.php
           resources/views/xinchao.blade.php + app/http/controller/ArticleController.php + app/http/controller/Admin/ManageUser.php 
           app/User.php + app/Book.php + app/Models/Person.php 
laravel2 
video40 : webvideo40.php + .env + config/app.php + routes/web.php + resources/views/xinchao.blade.php + config/game.php + app/Http/Controller/UserController.php 
          app/Http/Requests/LoginRequest.php + app/Http/Controller/ArticleController.php + views/article.blade.php + views/master.blade.php 
          views/inheritanceTemplate.blade.php + views/parts/div.blade.php + Database : tintuc3 + htdocs/tintuc3.sql
          app/database/migrations/2021_09_06_160627_create_articles_table.php
laravel3 
video41 : webvideo41.php + laravel2/database/migrations/2021_09_08_045945_catogories.php + 2021_09_08_050119_create_categories_table.php  
          2021_09_06_160627_create_articles_table.php + 2021_09_08_085334_create_product_table.php
          laravel3 + database: news3 + app/.env + laravel3/database/migrations/2021_09_08_152310_create_articles_table.php
          2021_09_08_160158_add_author_to_articles_table.php + 2021_09_08_162137_add_votes_to_articles_table.php + database/seeds/DatabaseSeeder.php
          database/seeds/UsersTableSeeder.php + database/seeds/ArticlesTableSeeder.php + app/Models/Article.php + app/Models/Product.php
          laravel3/database/migrations/2021_09_09_055150_create_products_table.php + app/Http/Controllers/ArticleController.php + routes/web.php 
laravel4 
video42 : webvideo42.php + Database : news4 + .env + app/Models/Article.php  + resources/Articles.blade.php   
          database/migrations/2021_09_10_015907_create_articles_table + database/seeds/ArticlesTableSeeder.php  
          database/seeds/DatabaseSeeder.php  + app/Http/Controllers/ArticleController.php  + routes/web.php + htdocs/news4.sql
laravel5 
video43 : webvideo43.php + Database : tintuc43 + .env + routes/web.php + app/Models/Post.php + database/migrations/2021_09_10_193312_create_posts_table.php    
          resources/views/welcome.blade.php + app/Http/Controllers/PostController.php + resources/views/layouts/master.blade.php 
          resources/views/post/create.blade.php + app/Http/Request/post/CreatePostRequest.php + resources/views/post/list.blade.php 
          resources/views/post/detail.blade.php + htdocs/posts_project.sql + app/Models/Category.php + migrations/2021_09_11_193451_create_categories_table.php
          resources/views/post/category.blade.php + app/Models/Tag.php + database/migrations/2021_09_12_093227_create_tags_table.php
          database/migrations/2021_09_12_093901_create_post_tag_table.php + htdocs/tintuc43.sql 
laravel6
video44 : webvideo44.php + Database: tintuc44 + .env + app/Http/Controllers/PostController.php + resources/views/post/detail.blade.php + app/Models/Comment.php 
          database/migrations/2021_09_13_110058_create_comments_table + app/Models/Post.php  + app/Models/Category.php + resources/views/post/category.blade.php 
          app/Models/Menu.php + app/Http/Controllers/MenuController.php + htdocs/tintuc44.sql 
laravel7
video45 : webvideo45.php + Database : tintuc45 + .env  + web.php + app/Http/Controllers/PostController.php + resources/lang/en/validation.php 
          resources/views/post/create.blade.php + resources/lang/en/ + resources/lang/vi/ + config/app.php + resources/lang/vi/validation.php 
          app/Http/Request/post/CreatePostRequest.php + app/Rules/CauVanHoa.php + resources/js/components/ExampleComponent.vue 
          resources/js/app.js + resources/js/bootstrap.js  + views/auth / nhiều file views (/blade.php) + views/auth/passwords / nhiều file views (.blade.php) resources/views/layouts/app.blade.php + resources/views/home.blade.php + app/Http/Controllers/Auth/ nhiều file controller 
          app/Http/Controllers/HomeController.php + app/Http/Middleware/BlockIpMiddleware.php + app\Http\Kernel.php 
          database/migrations/2014_10_12_000000_create_users_table.php + app/Http/Middleware/RoleMiddleware.php + htdocs/tintuc45.sql
laravelAuth
video46 : webvideo46.php + Database : auth + .env + database/migrations/2014_10_12_000000_create_users_table.php 
          app/Http/Controllers/Auth/RegisterController.php + resources/views/auth/register.blade.php + app/User.php+ resources/views/auth/login.blade.php
          app/Http/Controllers/Auth/LoginController.php + laravel/laravelAuth/vendor/laravel/ui/auth-backend/AuthenticatesUsers.php/{}AuthenticatesUsers (chỉ đọc and copy) + package.json + webpack.mix.js + resources/views/layouts/app.blade.php+ config/services.php + app/Providers/EventServiceProvider.php
          app/Http/Controllers/Auth/SocialLoginController.php + htdocs/auth.sql 
laravelAuth
video47 : webvideo47.php + Database : auth + app/Jobs/SendWelcomeMail.php + app/Http/Controllers/Auth/RegisterController.php + .env + config/queue.php
          database/2021_09_17_103236_create_jobs_table.php + database/2019_08_19_000000_create_failed_jobs_table.php + app/Console/Commands/ClearCacheCommand.php
          app/Console/Kernel.php + app/Jobs/DailyReportJob.php + a.txt + htdocs/auth47.sql 
laravel10 
video48 : webvideo48.php + Database : auth48 + .env + app/Models/Article.php + database/migrations/2021_09_17_202607_create_articles_table.php 
          database/seeds/ArticlesTableSeeder.php + database/seeds/DatabaseSeeder.php + app/Http/Controllers/LandingPageController.php
          routes/web.php + resources/views/landing.blade.php + config/cache.php + app/Console/Commands/CreateHomePageCache.php + app/Console/Kernel.php 
          storage/framework/cache/data/f1/0d (chỉ đọc) + database/migrations/2014_10_12_000000_create_users_table.php + database/seeds/UsersTableSeeder.php 
          app/User.php + app/Http/Controllers/ArticleController.php  + app/Policies/ArticlePolicy.php + app/Providers/AuthServiceProvider.php + htdocs/auth48.sql 
laravel11 + qlct 
video49 : laravel11 : Database : auth49 + .env + app/Models/Article.php + app/User.php + app/Http/Controllers/ArticleController.php 
          app/Policies/ArticlePolicy.php + app/Providers/AuthServiceProvider.php + routes/web.php + htdocs/auth49.sql 
          
          qlct      : Database : qlct + .env + database/migrations/2014_10_12_000000_create_users_table.php + app/Http/Middleware/RoleMiddleware.php
          app/Http/Kernel.php + routes/web.php + app/Http/Controllers/AdminController.php + app/Models/Permission.php
          database/migrations/2021_09_19_091429_create_permissions_table.php + app/User.php 
          database/migrations/2021_09_19_092226_create_user_permission_table.php + app/Policies/UserPolicy.php + app/Policies/ArticlePolicy.php
          app/Models/Menu.php + database/migrations/2021_09_19_094533_create_menus_table.php + htdocs/qlct.sql
laravel12
video50 : 


Xong Lravel  
Xong Back-End 

Chuuyển qua học Docker và những kiến thức Laravel nâng cao khác , kết hợp Laravel + Vuejs.
Docker và những kiến thức tổng hợp : Html Css Bootstrap Js Jquery Vuejs Php Lavel mySQL api và những kiến thức khác.













--------------------------------------------------------------------------------------------------------------------
                                                  Laravel let's go  


(video39)

Laravel 
- Cài đặt Laravel :
    + Bất kì một framework nào cũng lên trang chủ của nó để đọc xong tải xuống .
    + Dùng laravel 7 (Hiện tại đã có laravel 8) Kinh nghiệm là nên chọn version mà đã hoạt động ổn định . Vì một version mới ra chưa chắc là đã tốt ,nó còn lỗi,còn nhiều thứ nữa,và quan trọng là nếu code version mới nhất đôi lúc lên các group để hỏi thì lại ít người biết,ít người trả lời => Chọn version đã hoạt động ổn định là tốt nhất.
    + Laravel v7 yêu cầu PHP>=7.2.5 , để xem php version bao nhiều thì cũng làm giống lúc trước thôi . 
    Sau khi đã cài đặt global (gõ được bất kì đâu) => php -v : C:\WINDOWS\system32>php -v 
    => PHP 7.4.21 (cli) => được 
    + Xem version composer => Sau khi đã cài global thì tại bất kì đầu gõ : composer là được => Composer version 2.1.6
    + Cài đặt bằng composer : composer create-project --prefer-dist laravel/laravel:^7.0 [tên_project]
    Tạo thư mục Laravel\laravel
    + C:\>cd Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel> : chuyển đến thư mục Laravel\laravel
        C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel>composer create-project --prefer-dist laravel/laravel:^7.0 laravel1  (tạo project là : laravel1) 
        + Hiện ra bla bla như thế này: 
        Creating a "laravel/laravel:7.0" project at "./laravel1"
        Installing laravel/laravel (v7.0.0)
        - Downloading laravel/laravel (v7.0.0)
        - Installing laravel/laravel (v7.0.0): Extracting archive
        Created project in C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel1
        > @php -r "file_exists('.env') || copy('.env.example', '.env');" 
        ... tải nhiều cái khác nữa... 
        => Đợi cho máy tải xong 
        Package manifest generated successfully.
        67 packages you are using are looking for funding.
        Use the `composer fund` command to find out more!
        > @php artisan key:generate --ansi
        Application key set successfully. => là đã thành công
        => Trong thư mục Laravel\laravel sẽ xuất hiện thư mục laravel1 và thư mục vendor 
    + php artisan serve (Chạy server)
        + C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel>cd laravel1 (chuyển đến thư mục project)
        + C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel1>php artisan serve
            + Laravel development server started: http://127.0.0.1:8000 (Hiện ra cổng để truy cập vào)(Như này là đã thành công)
              => vào cổng này (http://127.0.0.1:8000/) => Hiện ra chữ Laravel và một số cái khác 
        + artisan : 
            + Ở phần php cơ bản ta đã chạy lệnh : php a.php (chạy file a.php) với bộ xử lí php (Thực ra ta có thể chạy bất cứ thứ gì sau php không nhất thiết phải là .php )
            + Thì ở đây ta chạy : php artisan serve (chạy bằng bộ xử lí php) , artisan là một phần mềm => được viết bằng php 
            + artisan là công cụ để viết code trong laravel tiện hơn 

Cấu trúc file và thư mục : 
- artisan : là một phần mềm => viết bằng php 
    + công cụ để viết code trong laravel tiện hơn
- app :  
    + Thư mục viết code logic của app 
    - Http : 
        + Controller :chứa các file điều khiển
        + Middleware : 
    - Exceptions : xử lí lỗi 
    - Console : các file xử lí dòng lệnh 
    - Providers : 
- bootstrap: ít khi làm việc
    - Chứa các file khởi động của laravel (chú ý không phải này Bootstrap css framework)
    - cache : file tạm 
- config : 
    - Cấu hình 
- database : 
    - Viết code xử lí database 
    - factories : nhà máy 
    - migrations :
        - file để tạo ra cơ sở dữ liệu 
        - (thông thường ta sẽ vào trực tiếp dbms để tạo database,rồi thao tác sửa,thêm,xóa,... trực tiếp trên đó nhưng này thì không)
        - (ví dụ khi làm cho facebook chẳng hạn thì không được thao tác trực tiếp với database,không được xem bất cứ dữ liệu nào từ databse, mà ta chỉ được phép tạo ra các migrations rồi đẩy lên server để thực hiện các thao tác (thêm,xóa,sửa,...) đó. Tất cả mọi người đều không được biết dữ liệu trong database)
    - seeds : 
        - Chứa các seeder dữ liệu mẫu => có sẵn 
        - Tạo ra các dữ liệu có sẵn 
        ex :một trang Tin tức:có các danh mục có sẵn , khi mà đẩy lên server thì tự động tạo ra các danh mục này 
- public : 
    - giống thư mục dist (npm)
        + được người dùng truy cập vào : và chỉ vào được đến đây , người dùng khôgng thể truy cập vào các file ngoài thư mục public 
          Các xử lí thì ta xử lí phía sau rồi đẩy vào thư mục này .
- resources : (các tài nguyên)(tất cả code front-end)
    - js: viết code js ở đây 
    - lang: language:ngôn ngữ 
    - sass: scss => css (sau khi viết xong thì sẽ build ra một file ở thư mục public giống bên vuejs)
    - view: chứa các file html (dưới dạng blade template)
- routes : 
    - chứa các routes 
    - web.php: chứa các route cho web (chứa các đường dẫn cho web)
    - api.php: chứa các route cho api (chứa các đường dẫn cho api)
- storage:  
    - cache
    - upload 
- test: 
    - Chứa các test 
        + Khi đi làm ở một số công ty mà chuyên nghiệp sẽ có yêu cầu viết thêm các cái test này.Thậm chí có nhiều leader chỉ chuyên viết các test ,đại khái là khi mà build thì ứng dụng của ta phải vượt qua hết các test ở trong này mới đạt yêu cầu .
- vendor : giống thư mục node_modeles (npm)
- .env (cực kì quan trọng)(hay sửa trên này):
    - file cấu hình (cấu hình môi trường)

- app 
    + app/Http/Requests : các file request,chứa hàm authorize() và rules() để viết các luật 
    + app/Rules         : tự tạo ra các hàm,luật để check  


Sử dụng vuejs với laravel
Sử dụng reactjs với laravel

Mô hình mvc: model - view - controller 
- Ứng dụng: chia thành 3 phần : 
    + model: class, thực thể trong ứng dụng 
        + conVat,conVoi,... 
        + Articles,category,user 
    + controller: thành phần xử lí 
        + làm nhiệm vụ xử lí logic 
        + gọi các model lên => tương tác với nhau
    + view: thành phần hiển thị (giống bên vuejs là <template></templace>)

- Truy cập web : (trình tự khi một người truy cập web)
    + router : 
    + controller => model 
    + view 


- Router : 
    Vào routes/web.php 
    + Route::[method] (:: là static method)
    + route::get('đường dẫn',hàm xử lí)
        ex : Route::get('/', function () {
                return view('welcome');
             });
        ex : Route::get('/login', function () {
                 return 'Hello Nguyễn Văn Mạnh';
             }); 
             => vào trang http://127.0.0.1:8000/login => sẽ có 'Hello Nguyễn Văn Mạnh';
             giả sử không có đường dẫn : http://127.0.0.1:8000/loginssssvnskjgnwe chằng hạn => khi mà ta truy cập vào thì 404 | Not Found
    + route::get('đường dẫn',chuỗi)
        + Chuỗi : tên controller @ method 
            ex : Route::get('/login', 'UserController'); // khi mà truyền chuỗi kiểu này thì nó sẽ gọi đến file UserController.php nằm trong thư
            mục Controllers : app\Http\Controllers\UserController.php 
        + Route::get('/login', 'UserController@login');  
            => Khi mà truy cập đến địa chỉ login bằng method là get() thì nó sẽ gọi đến UserController.php và gọi hàm login  nằm trong file UserController.php đó 
            @ : là gọi hàm 

        Tạo file UserController.php trong thư mục Controllers 
        C:\>cd Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel1
        C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel1>php artisan make:controller UserController
        => Controller created successfully. (thành công)
        C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel1>php artisan serve (chạy lại server)
    tương tự với route::get() có : 
    + route::post()
        + 'đường dẫn',hàm 
        + 'đường dẫn',chuỗi
    + router::put()
        + 'đường dẫn',hàm 
        + 'đường dẫn',chuỗi
    + router::detele()
        + 'đường dẫn',hàm 
        + 'đường dẫn',chuỗi
        ex tương tự có một số cái : 
        Route::post('/saveuser','UserController@save');
        Route::get('/article/edit','ArticleController@edit');
    (get,post,put,delete đề có route ,mỗi route đều có hai loại như trên)


    + Route group:: 
    Route::group([arttributes], hàm xử lí);

        Thay vì mình viết 
            Route::get('/article/show', 'ArticleController@show');
            Route::get('/article/create', 'ArticleController@create' );
            Route::get('/article/edit', 'ArticleController@edit' );
            Route::get('/article/delete', 'ArticleController@delete' );
        Thì chuyển thành như dưới này : không viết lại article nữa và sau này nếu mình có áp dụng một cái middleware nào đó cho cả mấy cái thì chỉ cần áp dụng chung cho cá group là được 
            Route::group(['prefix' => 'article'], function(){
                Route::get('/edit','ArticleController@edit');
                Route::get('/show','ArticleController@show');
                Route::get('/create','ArticleController@create');
            })->middleware('kgergoireiergowjfk'); // chỉ cần áp dụng chung cho cả group là các dòng trong cũng như thế 
    + Route resource 
        + Resource:
            + Tài nguyên
            + Route::resource('đường dẫn','Resource Controller')
            + Resource Controller:
                + Là một controller bình thường 
                + Có sẵn các hàm: get, edit, update, delete.
        C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel1>php artisan make:controller ArticleController --resource
        Tạo trong thư mục controller một file ArticleController.php mà có resource (có đầy đủ và có sẵn các hàm index,create,store, show, edit, update, destroy) 
        Sau đó trong file web.php ta chỉ cần ghi : Route::view('/article','ArticleController'); 
        ta không cần gọi thêm các hàm (không cần ghi kiểu Route::view('/article','ArticleController@show');) bởi vì khi mà truy cập đến địa chỉ 
        http://localhost:8000/article        thì nó sẽ tự động gọi đến hàm index trong ArticleController.php 
        http://localhost:8000/article/1      thì nó sẽ tự động gọi đến hàm show trong ArticleController.php (hiển thị ra bài viết số 1)
        http://localhost:8000/article/edit/1 thì nó sẽ tự động gọi đến hàm edit trong ArticleController.php (chỉnh sửa bài viết số 1)
        Tương tự đối với create,store, update, destroy
        + Lưu ý : các tên các hàm, class được tạo tự động trong file ArticleController.php không được đổi , vì nó đã tạo chính xác như thế rồi .
        + Name : 
            + Route::view('/welcome','welcome')->name('chaomung');
            // giống như vuejs có name để truy cập cho dễ thì bên laravel cũng có name 
            //và từ một hàm có thể gọi tiếp đến một hàm, tìm hiểu (fluent interface) là được. 
    
    + Route view: trả về view 
        thay vì như thế này : 
        ex : Route::get('/welcome', function () {
                return view('welcome');
             });
        khi vào http://127.0.0.1:8000/ nó sẽ hiển thị file resources/views/welcome.blade.php ở server
        thì như thế này : Route::view('/welcome','welcome'); => vẫn cho kết quả tương tự 
        => trả về view luôn 
        (http://localhost:8000/welcome là link của file hiển thị welcome.blade.php trong thư mục views)
        (Route::view('/abc','welcome'); như thế này vẫn được => truy cập vào http://localhost:8000/abc là sẽ có)
        (quan trọng là file welcome phía sau phải đúng mới được , file welcome phía sau là file welcome.blade.php nằm trong thư mục views)
    + namespace and use 
        + Trong ArticleController.php cũng như php cơ bản , nó có namespace App\Http\Controllers; => có thể use 
        tại web.php ta có thể use App\Http\Controllers\ArticleController; từ đó thay vì Route::view('/article','ArticleController'); 
        ta cũng ghi như thế này được : Route::view('/article',ArticleController::class); 
        thậm chí ta viết như thế này cũng được Route::view('/article','App\Http\Controllers\ArticleController');

- Artisan và các lệnh cơ bản : 
    + php artisan [câu lệnh]
    + make : 
        + make:controller
            + không có resource:
                + ex : php artisan make:controller ArticleController                // không có resource(các hàm index,create,store, show, edit, update, destroy)
            + có resource:
                + ex : php artisan make:controller ArticleController --resource     // có sẵn resource
            + Giả sử trong thư mục controller ta muốn tạo thêm thư mục Admin , trongAdmin tạo thêm thư mục ManageUser.php 
            => thì ta không nên thao tác tạo trực tiếp , nên dùng bằng câu lệnh : 
            C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel1>php artisan make:controller Admin/ManageUser
            => sẽ có thư mục Admin và file ManageUser.php ở trong đó.
            (Tạo kiểu này có cái lợi đó chính là namespace nó sẽ tự thêm cho mình đầy đủ Admin vào cho mình luôn namespace App\Http\Controllers\Admin;).
        + make:model
            + Các thực thể,các class 
            + Laravel có sẵn một model cho ta đó là User model (User.php nằm trong thư mục app)
            + C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel1>php artisan make:model Book
            => file Book.php sẽ được thêm vào thư mục app 
            Ta cũng có thể thêm vào thư mục thay vì để các model ở thư mục app 
            => Nên cho các model được tạo ra vào một thư mục : Models 
            + C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel1>php artisan make:model Models/Person (tương tự phía trên thôi)
        + make:migration 
        + make:seeder
        + make:command


BTVN : 
    + Cài đặt laravel thành công 
    + serve laravel lên 
    + tạo controller tên là BookController
    + tạo controller tên là CategoryController là resource
    + Tạo route đến 2 controller trên 
    + Tạo model Book 
    + Tạo model Category  

(video40)

Tạo project mới : laravel2 trong thư mục learnlaravel 
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel>composer create-project --prefer-dist laravel/laravel:^7.0 laravel2
Chạy server 
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel2> php artisan serve
Thực hiện tất cả các thao tác trên laravel2 







- Config: Configuration (Cấu hình)
    - .env    (file .env trong thư mục laravel2 (thư mục project))
    - /config (thư mục laravel/config)
    - Hàm env()
        - Lấy biến môi trường theo thứ tự (xem giải thích chi tiết ở phần dưới) //(video40)
            + Lấy biến của server (Vào CMD export APP_NAME=Laravel)
            + Lấy từ file .env 
            + Lấy từ file trong thư mục config (app.php,queue.php,...)
            ex : ta có + Vào CMD : export APP_NAME=Manh (gán giá trị Manh cho biến APP_NAME)
                       + Vào file .env : ghi thêm dòng : APP_NAME = Store ;
                       + Vào file app.php trong thư mục config : có 'name' => env('APP_NAME', 'Laravel'),
                => Thì khi mà server đọc nó sẽ ưu tiên lấy giá trị được gán từ CMD đến file .env rồi cuối cùng đến app.php 
                Nếu có gán bằng CMD thì lấy APP_NAME = Store; không lấy hai cái sau.Còn nếu không có CMD export thì lấy APP_NAME trong file .env tức là Store , còn nếu không có nữa thì nó sẽ lấy cái mặc định là APP_NAME=Laravel
                Luôn có cái mặc định,nếu không có tất cả cái trên thì server sẽ lấy cái mặc định.(Ta cũng có thể sửa cái mặc định bằng thứ ta muốn)(Nó vẫn tuân theo quy tắc lấy biến môi trường theo tứ tự đó)
    
        - Vào file views/xinchao.php : code thêm : <p>{{config('app.name')}}</p>  
        (tương tự như buổi trước thôi thêm route : Route::view('/xinchaolaravel2','xinchao'); vào file web.php)
        => vào http://127.0.0.1:8000/xinchaolaravel2 sẽ thấy có : Store là kết quả của câu lệnh trong thẻ <p> phía trên 
            <p>{{config('app.name')}}</p> : Chính là vào file app.php trong thư mục config rồi trỏ đến cái 'name trong đó'
        (file app.php có 'name' => env('APP_NAME', 'Laravel'),) => name sẽ gọi hàm env() và lấy giá trị trong biến APP_NAME 
        => vào file .env (có APP_NAME=Store) => xuất ra 
        (Nhắt lại Laravel ở dòng 'name' => env('APP_NAME', 'Laravel') của file app.php trong thư mục config sẽ không được lấy trừ khi vào file .env không có giá trị của biến APP_NAME,trong trường hợp này vào file .env (có APP_NAME=Store) => lấy Store)
        => Vậy thì nếu như nội dung phía trên , giả sử vào .env đổi APP_NAME=Shop thì , khi reques lại thì có thay đổi từ 
        Store chuyển sang Shop hay không . => Không thay đổi 
        (Nếu sau khi sửa thành Shop , ta tắt server đi rồi run lại server : php artisan serve => Thì khi này request lại sẽ có Shop)
        Chỉ khi khởi động server lại thì mới thấy sự thay đổi.
    - Config thì được cache (lưu tạm)(cache : bộ nhớ đệm)
        + Tắt server => run lại server cũng được , nhưng bản chất của nó là như thế này.
        Đổi từ Store => Shop thì . Store vẫn được server lưu tạm ở đâu đấy ,server đang chạy thì vẫn chạy Store
        (Bởi vì không thể mỗi lần lưu cái gì đó thì server lại khởi động) 
        + php artisan config:clear => Lệnh này sẽ giúp xóa cache , tức là xóa cái lưu tạm ở đấy đi 
        + php artisan config:cache => Cập nhật lại cache mới => lúc này request lại thì Store mới thay đổi thành Shop
        tiếp tục lúc này Shop lại được lưu tạm ở đâu đấy 
        (Thực tế thì config cũng ít khi thay đổi)
        => Cứ khi nào sửa file .env hoặc sửa một file trong thư mục config => thì dùng hai câu lệnh trên để cập nhật lại cache 
    - Tự tạo một config:
        + Tạo một file trong thư mục config 
        => tạo file game.php trong thư mục config => thêm vào nội dung : <?php
                                                                             return [
                                                                                 'hardness'=> 2 
                                                                             ];
        => vào file xinchao.blade.php => <p>{{config('game.hardness')}}</p> => bởi vì ta thay đổi ở config nên xóa cache và cập nhật lại 
        php artisan config:clear php artisan config:cache => Lúc này vào http://127.0.0.1:8000/xinchaolaravel2 => có thêm số 2 
    - Trong file .env chú ý một số biến sau 
        + APP_NAME : tên app 
        + APP_ENV  : Môi trường hoạt động 
            + APP_ENV=local 
            + Đưa lên server thì là APP_ENV=testing , hoặc APP_ENV=production 
        + APP_KEY  : Dùng làm tiền tố để mã hóa mật khẩu 
          Mỗi khi mà khởi tạo một project thì nó sẽ tạo ra một Key (rất là khó đoán)
          Khi mà cài lên server thì từ key ban đầu này nó sẽ gen (generate)(phát ra) một key mới 
          Và cho dù ta có dùng database thì cũng không biết được mật khẩu của họ là gì .
          Ngoài ra còn có thể dùng để sử dụng rất nhiều thứ ,session,...
          Chú ý là key chỉ được phép gen ra một lần bởi vì nếu khi ta thay đổi key ở project thì tài khoản và mật khẩu của người dùng (user) trước   sẽ không đăng nhập được nữa .
        + APP_DEBUG : true : Hiển thị lỗi , nếu để fale => thì không hiển thị lỗi
        + APP_URL=http : //localhost

        + Những cái dưới này thì giống bên MySQL 
        DB_CONNECTION=mysql
        DB_HOST=127.0.0.1
        DB_PORT=3306
        DB_DATABASE=laravel
        DB_USERNAME=root
        DB_PASSWORD=

- Request : 
    + Nguyên lí hoạt động của Request trong laravel : 
        C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel2>php artisan make:controller UserController
        Tạo ra file UserController.php thêm hàm vào public function login(){
                                                        return 'Đây là trang login';
                                                    }
        thêm vào web.php : Route::get('/login','UserController@login');
        => Khi mà ta vào trang này http://127.0.0.1:8000/login => Nhấn Request 
        => Tìm đến dòng Route::get('/login','UserController@login'); trong file web.php 
        => gọi đến Router => Router sẽ tạo ra một request mới => Gủi đến Controller 
        => PHP sẽ có một biến $request để accept hết tất cả những gì mà nhận được ở Controller
        Vào lại UserController.php thêm vào public function login(Request $Request){
                                                print_r($Request);
                                                return 'Đây là trang login Laravel2';
                                            }
        Request ở đầu trong (Request $Request) , bắt nguồn từ : use Illuminate\Http\Request;
        (Thật ra ở đây ghi login(Request $abc) sau đó print_r($abc) cũng được)
        Biến đầu tiên được truyền vào đó là $Request
        => Vào lại http://127.0.0.1:8000/login => request lại thì sẽ thấy một đống code bla bla ...
        Biến $Request chứa toàn bộ thông tin của một request (kể cả session,cookie,... tất cả trong lần request đó)
        ex : thêm dòng này vào hàm login : echo $Request->name; , đến http://127.0.0.1:8000/login 
        sửa thành http://127.0.0.1:8000/login?name=Manh => thì nó sẽ hiển thị ra 'Manh' , (ta đã biết biến $_GET sẽ lưu vào [name] => 'Manh' , và ở đây khi ra echo $Request->name; cũng cho 'Manh' => chứng tỏ biến $Request chứa cả biến $_GET)
    + Request : 
        + Là một biến 
        + Chứa toàn bộ thông tin của request 
        + Lấy các giá trị của request có các cách sau: 
            + $request->[tên_giá_trị]       ex : echo $Request->name;
            + $request->post('tên_giá_trị') ex : echo $Request->post('name');
            + $request->get('tên_giá_trị')  ex : echo $Request->post('name');
+ Tự tạo một request:
    + php artisan make:request [tên_request]
        ex : C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel2>php artisan make:request LoginRequest
        => Trong app/Http có thêm thư mục Requests/LoginRequest.php 
        => vào file UserController.php thêm : use App\Http\Requests\LoginRequest; 
        và sửa thành (LoginRequest $Request) => thì đến http://127.0.0.1:8000/login?name=MANH  request lại vẫn được giống như request trước 
        => Request tự tạo không khác gì request của máy 
        Vào file LoginRequest.php 
        + authorize() : 
            + Kiểm tra xem có quyền truy cập hay không 
            + Ta vẫn có thể viết code login trong hàm này được 
        => trong authorize() sửa return false thành return true => có thể truy cập được .
    + Mỗi reuquest => phải đảm bảo rằng nó hợp lệ => thì mới đến được controller 
        (file LoginRequest.php phải đảm bảo rằng nó đúng =>(use Illuminate\Http\Requests\LoginRequest;) mới đến được hàm login trong UserController.php)
        ex : nếu ta sửa thành return false => vào lại trang => request lại thì sẽ là : 403 | This action is unauthorized.
        + rules() : 
            + Dùng để viết các luật 
        => Giả sử bây giờ request đã chạy qua được hàm authorize() , không lỗi gì => đến hàm rules(), trong rules() có luật là return ['name' => 'min:6'];
        (yêu cầu name ít nhất 6 kí tự => http://127.0.0.1:8000/login?name=MANH sẽ bị lỗi ,http://127.0.0.1:8000/login?name=An => sẽ bị lỗi ,...)
        (nhưng mà http://127.0.0.1:8000/login?name=nguyen => được (vì đủ 6 kí tự trở lên))
        Vào file xinchao.blade.php  <form action="/login" method="post">
                                        @csrf
                                        <input type="text" name="name"> => Nhập An => gửi đi thì name=An 
                                        <button type="submit">Dang Nhap</button>
                                    </form>
        Vào file web.php : Route::post('/login','UserController@login');
        => đến http://127.0.0.1:8000/xinchaolaravel2 , khi ta nhập vào form dưới 6 kí tự thì sẽ không đến được http://127.0.0.1:8000/login
        còn nếu nhập >= 6 kí tự => đến được trang login 
        Trình tự : vào http://127.0.0.1:8000/xinchaolaravel2 => Nhập 'An' (2 kí tự) => nhấn button => submit => gửi name=An (input có name='name') 
        (<form action="/login" method="post">) gửi form đến http://127.0.0.1:8000/login =>[trong khi đó trong web.php có
        (Route::post('/login','UserController@login');) : yêu cầu để đến http://127.0.0.1:8000/login =>thì phải gọi hàm login trong file UserController.php] => mà file UserController.php dùng use App\Http\Requests\LoginRequest; và login(LoginRequest $Request) => đến kiểm tra $Request trong file request LoginRequest.php =>phải chạy qua hàm authorize() => pass => chạy hàm rules() (không pass bởi vì trong rules() có 'name' => 'min:6' yêu cầu name ít nhất 6 kí tự) => không đến được http://127.0.0.1:8000/login . Ngược lại nếu nhập vào input >= 6 kí tự ex : nguyenvanmanh => pass => đến được trang login và hiển thị ra echo $request->name là nguyenvanmanh
        thêm đoạn này vào xinchao.blade.php <!-- hiển thị ra lỗi gì -->
                                            @foreach ($errors->all() as $error)
                                                <li>{{ $error }}</li>
                                            @endforeach
                                            <!-- hiển thị ra lỗi gì --><!--nếu dưới 6 kí tự => sẽ báo lỗi : The name must be at least 6 characters. -->

        Khi code mà vào http://127.0.0.1:8000/... mà bị lỗi thì laravel sẽ báo lỗi cho ta, tại file nào dòng mấy .

(Trên đó là quá trình từ Router đến Controller)(Là một trong những phần của mô hình MVC)
(Tiếp đến là quá trình từ Controller đến View)(Là một trong những phần của mô hình MVC) 
(MVC : Model-View-Controller)
    Tạo file ArticleController.php : C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel2>php artisan make:controller ArticleController
    // Ví dụ khi mà đã có câu lệnh Route::get('/article','ArticleController@show') trong web.php => thì máy sẽ hiểu là đã có file ArticleController.php 
    => lúc này lệnh tạo file phía trên sẽ không thực hiện được. Điều này cũng tốt vì nhỡ nếu đặt tên trùng file (tránh được việc tạo file có tên giống vs file trước)
    Dùng sẵn request có sẵn của laravel 
    + Thêm vào file web.php : Route::get('/article','ArticleController@show')
    Tạo file views/article.blade.php Thêm code vào : <h2>Đây là trang bài viết !</h2>
      Thêm vào file ArticleController.php : public function show(Request $Request){
                                                return view('article');
                                            }
    => đến http://127.0.0.1:8000/article => trỏ đến file ArticleController gọi hàm show => return view('article');
    return view('article'); là in ra toàn bộ file article.blade.php trong thư mục vews 
    (Ta thườn thấy Route::view('/xinchaolaravel2','xinchao'); => đến link này hiển thị file này)
    (còn bây giờ là Route::get('/article','ArticleController@show') => đến link này chạy hàm trong file này , trong hàm show này có return view('article'); )
    (có chức năng giống với câu lệnh Route::view('/article','article')  Nhưng mà khác ở chỗ là dòng này chỉ là hiển thị ra, còn dòng gọi hàm show thì trước return có thể code thêm nhiều thứ (nhắt lại : chỉ thực hiện đến câu lệnh return , code sau return sẽ không thực hiện)
    + Giả sử : file article.blade.php không nằm trong thư mục views mà là nằm trong thư mục : views/frontend/article.blade.php 
    => return view('frontend.article'); : Cứ mỗi thư mục là một chấm  ex : views/client/frontend/article.blade.php => return view('client.frontend.article');

    + Thêm biến vào return view('tên_file','biến')
        public function show(Request $Request){
            $name = 'Nguyen Van Manh';
            $age = 20;
            return view('article',['ten' => $name,'tuoi' => $age]);
        }

        ở file : article.blade.php : <p>{{$ten}} {{$tuoi}}</p> // Nguyen Van Manh 20
        // ta cũng có thể viết theo kiểu này <p><?php echo $ten.$tuoi ?></p>
        // Chú ý : biến là mảng hay object ta đều truyền được 
        biến từ file ArticleController.php truyền qua được file article.blade.php thông qua : return view('article',['ten' => $name,'tuoi' => $age]);
        // mỗi cái key của mảng này ['ten' => $name,'tuoi' => $age] mà khi đẩy ra view => thì sẽ ra một biến $ten,$tuoi
        + <p>{{$ten}} {{$tuoi}}</p>       : Blade Templates (Viết theo kiểu Blade Templates) => máy sẽ tự động chuyển thành một đoạn php 
        + <p><?php echo $ten.$tuoi ?></p> : Cách 2 

Controller return view :
    + return view('tên_view',[các key và biến tương ứng]) nếu một biến thì 
        + ex : return view('article',['ten' => $name,'tuoi' => $age,'students' => $students]);
    + return view('tên_view')->with([các key và biến tương ứng]) 
        + ex : return view('article')->with(['ten'=>$name,'tuoi' => $age]); return view('article')->with('ten',$name);//cách 2
    + Nếu chỉ truyền vào một biến => return view('tên_view')->with('key',$biến);                       
        + ex : return view('article')->with('ten',$name); 
    + return view('tên_view')->with('key',$biến)->with('key',$biến)->with('key',$biến)->...->with('key',$biến);   (with nhiều lần)
        + ex : return view('article')->with('ten',$name)->with('tuoi',$age);
    + withInput();

+ Blade template: 
    + Template engine:
        + Dịch các file đặc biệt thành => php thuần = cache   
    + Muốn laravel chủ động cache => php artisan view:cache 
      ta cũng có php artisan view:clear : xóa đi bộ cache trong view  
      (ví dụ khi mà thay đổi gì đó ở file views/.blade.php mà chưa thấy nó thay đổi gì => thì php artisan view:clear là được)
+ Các câu lệnh cơ bản trong Blade template : 
    + Xuất một biến: {{ $tên_biến }}
    + Vòng lặp:
        @foreach ( $students as $student )
        @endforeach
        ex : @foreach ( $students as $student)                       <?php foreach ($students as $student){
             <p>{{ $student }}</p>                  bằng với             echo '<p>'.$student.'</p>'; // echo "<p>$student</p>"; cũng được
             @endforeach                                             }?>
    + Câu lệnh điều kiện 
        @if(điều_kiện)

        @elseif

        @else  

        @endif 

        + ex : @if ($agree)
               <p>Ban da dong y</p> <!-- Nếu true thì no xuấ thẻ p ra , còn false thì không xuất gì (không thực hiện)-->
               @endif 

        + ex : @if ($number==1)
                   <p>Một</p>
               @elseif ($number==2)
                   <p>Hai</p>
               @elseif ($number==3)
                   <p>Ba</p>
               @else 
                   <p>Else</p>
               @endif 

+ Kế thừa template (gần giống với router vue)
    + Ở tenplate cha : @yield('tên section')
    + Ở template con : 
        @extends('tên_cha') // chú ý nếu có nằm trong thư mục nào nữa thì vẫn cứ chấm '.' , cứ một thư mục sau views sẽ là một chấm '.'

        @section('tên section','Nội dung') // Nếu mà Nội dung ngắn có thể dùng trực tiếp như thế này luôn cũng được 

        @section('tên section')

        @endsection

        + Ta có trang :         <!DOCTYPE html>
          master.blade.php      <html>
                                <head>
                                    <title>Article</title>
                                    <meta charset="utf-8">
                                    <meta name="viewport" content="width=device-width, initial-scale=1">
                                    <meta http-equiv="X-UA-Compatible" content="ie=edge">
                                </head>
                                <body>
                                <header>
                                    <h1>Day la web pro</h1>
                                </header>
                                <div>
                                    @yield('noidung')         // Khu vực để cho nội dung của file kế thừa vào đây 
                                </div>
                                <footer>
                                    <p>Ban quyen thuoc laptrinhcuocsong</p>
                                </footer>
                                </body>
                                </html>

        + Ta có file views/inheritanceTemplate.blade.php : 
                                @extends('master') 
                                
                                @section('tieude','Trang web pro')
                                
                                @section('noidung')
                                <?php
                                
                                echo "<h2>Đây là trang bài viết !</h2>";
                                $students =[
                                            'Nguyen Van Manh',
                                            'Bui Van Nguyen',
                                            'Huong Giang',
                                            'Hoang Phuc'
                                        ];
                                foreach ($students as $student){
                                        # code...
                                        echo '<p>'.$student.'</p>';
                                        // echo "<p>$student</p>";
                                }
                                ?>
                                @endsection
        
        + Trong file master.blade.php : (file cho kế thừa)
            + <div> @yield('noidung') </div>
              => Khi mà file khác kế thừa thì nội dung sẽ bỏ vào đây 
        + Trong file views/inheritanceTemplate.blade.php : (file kế thừa file khác)
            + @extends('master') : Kế thừa từ file master.blade.php (trong thư mục views)
              Nếu như master.blade.php nằm trong thư mục views/client/frontend/
              => @extends('client.frontend.master') (tương tự như đã nói ở trên)
            + @section('noidung') /Nội dung/ @endsection 
              ('noidung') là từ @yield('noidung') của file master.blade.php 
        => Kết quả là khi quy cập đến http://127.0.0.1:8000/inheritanceTemplate
        (Route::view('/inheritanceTemplate','inheritanceTemplate');)
        thì sẽ hiển thị như file master.blade.php nhưng ở phần <div> @yield('noidung') </div> sẽ hiển thị nội dung của file     inheritanceTemplate.blade.php
        Tức là file inheritanceTemplate.blade.php đã kế thừa những cái có sẵn ở file master.blade.php , và chỉ cần code thêm phần cần hiển thị thêm là được
        (giống như file master được chèn thêm đoạn code của file inheritanceTemplate ở phần @yield('noidung') vậy)
        => có lợi => giúp tăng tốc độ thời gian => không cần code lại những thứ đã có 
        @section('tieude','Trang web pro') => // Nếu mà Nội dung ngắn có thể dùng trực tiếp như thế này luôn cũng được 

    + Đấy là trường hợp file cha cho file con kế thừa .
        Còn trường hợp một file sử dụng một đoạn code của file khác: 
        + @include('tên_cha')
            + ex : @include('parts.div')
        ex : có file views/parts/div.blade.php : <div>
                                                    <p>Chào mừng bạn đến với trang web</p>
                                                </div>
        Thì nếu file master.blade.php nếu muốn sử dụng đoạn code này thì :thêm @include('parts.div') vào vị trí trong file master.blade.php mà muốn hiển thị đoạn code đó  


+ Kết nối database: (DATABASE & LARAVEL)
Tạo một bảng database : tintuc3 
Vào .env sửa : DB_HOST=localhost, DB_DATABASE=tintuc3
Chạy : php artisan config:cache ,để cập nhật lại cache

B1 :
// một project chỉ có một database , như này là : project laravel2 gắn với database : tintuc3 
// php artisan make:migration [tên_migration] (Tạo một bảng dữ liệu)(một file trong thư mục migrations là một bảng dữ liệu)
// ex : php artisan make:migration create_articles_table , tạo ra bảng articles trong database : tintuc3  
// chú ý : việc tạo ở bước này là chỉ mới tạo ra file trong thư mục migrations thôi , nó chỉ mới tạo ra file tượng trưng cho bảng dữ liệu thôi 
// chứ nếu dừng ngang bước này thì bảng articles vẫn chưa xuất hiện trên database : tintuc3 
- Tạo ra file migration
+ migration: (app/database/migrations)
    + Cách để tạo cấu trúc cơ sở dữ liệu trong laravel  
      (Tức là ta không vào dbms để tạo trực tiếp ,mà là ta tạo thông qua migration)
    + php artisan make:migration [tên_migration]
      ex : php artisan make:migration create_articles_table
          + php artisan make:migration [tên_migration] 
              + ex : php artisan make:migration catogories => sau B3 trong database : tintuc3 sẽ có thêm bảng catogories 
              => chỉ tạo ra file đó với các hàm up() , down() không có gì thêm 
              (file 2021_09_08_045945_catogories.php được tạo)
          + php artisan make:migration create_[tên_migration]_table 
              + ex : php artisan make:migration create_categories_table => sau B3 trong database : tintuc3 sẽ có thêm bảng catogories
              => trong các hàm up() , down() sẽ có thêm các Chema:: , các hàm table->id();$table->timestamps();,... 
              (file 2021_09_08_050119_create_categories_table.php được tạo)
          + Chú ý :nếu cả hai câu lệnh sau được thực thi php artisan make:migration catogories,ex : php artisan make:migration create_categories_table sau bước 3 đều cho một bảng catogories trong tintuc3 
          (vẫn tạo hai file trong thư mục migrations, nhưng chỉ cho một bảng catogories ở tintuc3)

          => Nên tạo theo kiểu : php artisan make:migration create_[tên_migration]_table 
          Bởi vì bảng nào cũng cần có cột(trường) id do hàm id() tạo ra, cột(trường) created_at (lưu thời gian tạo hàng), updated_at(lưu thời gian cập nhật hàm) do hàm timestamps() tạo ra 


      C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel2>php artisan make:migration create_articles_table
      => Created Migration: 2021_09_06_160627_create_articles_table        (06/09/2021)
      (file 2021_09_06_160627_create_articles_table.php xuất hiện trong thư mục : migrations)(sau B3 sẽ tạo ra bảng articles trong database : tintuc3)
    + Sau khi tạo thì các migration sẽ nằm trong thư mục database/migrations
    
    (vào file 2021_09_06_160627_create_articles_table.php)

B2:
// code vào file migration (2021_09_06_160627_create_articles_table.php) để tạo thêm các cột cho bảng dữ liệu 
// ở đây cũng chỉ mới là code , chưa có chính thức trên database
// muốn tạo cột(trường) nào thì code vào hàm up() trong file tượng trưng cho bảng đó   
+ Mỗi migration có : 
    + up() : 
        + $table : đại diện cho một bảng dữ liệu 
            + từ $table có thể tạo ra các cột dữ liệu 
            + $table->id(); => laravel có sẵn hàm id() để tạo id 
            => code thêm : $table->string('title'); // bài viết // tạo trường title 
            => code thêm : $table->text('content'); // nội dung // tạo trường content 
               $table->timestamps();

    + down() : 

B3:
// php artisan migrate : (chạy php artisan migrate để chạy tất cả các file trong thư mục migrations => để tạo ra các bảng tương ứng với các file đã tạo ở B1)
// cũng như tạo ra các cột(trường) trong các file đó 
+ Chạy migration : 
    Sau khi đã code ở file 2021_09_06_160627_create_articles_table.php trong thư mục migrations, chạy lệnh để tạo ra các bảng,các cột ở database 
    + php artisan migrate 
    C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel2>php artisan migrate
    Migration table created successfully. (thành công) => vào lại database : tintuc3 , lúc này đã có các cột 
    bảng article : id, title, content, created_at, updated_at  (hai trường created_at, updated_at là do $table->timestamps(); tạo ra để kiểm tra xem bài viết đấy được tạo lúc nào,cập nhật lúc nào)(title,content thì do ta tự tạo,id do hàm id() tự tạo)
    (chạy hàm up()) và một số bảng khác .

+ Rollback:
    + php artisan migrate:rollback 
    C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel2>php artisan migrate:rollback
    Lúc nãy ta vừa làm cái gì thì giờ hủy cái đấy 
    (chạy hàm down())
    => Vào lại database : tintuc3 thì không còn bảng nào nữa ,chỉ còn bảng migrations (bảng đặc biệt)
        + Giải thích thêm : Giả sử ban đầu chưa có gì hết  
            php artisan make:migration create_articles_table
            php artisan migrate => trong tintuc3 bảng articles được tạo ra 

            php artisan make:migration create_categories_table
            php artisan migrate => trong tintuc3 bảng categories được tạo ra 

            php artisan migrate:rollback => chỉ xóa đi bảng categories (bảng articles trước đó vẫn còn)
            (tức là chỉ xóa một thao tác trước đó , (còn trước đó nữa thì không))
            giả sử lúc này ta php artisan migrate:rollback nữa thì => nó sẽ xóa bảng articles

            + php artisan migrate : giống như là đi tiến 
            + còn php artisan migrate:rollback giống như là đi lùi ,cứ php artisan migrate:rollback một lần là lùi một bước 

            tiếp tục nếu bây giờ ta php artisan migrate thì như đã nói ở trên nó sẽ tạo lại tất cả các bảng đã từng có : bao gồm cả articles và categories
            vẫn theo quy luật đó nếu php artisan migrate:rollback => xóa hết tất cả các bảng (vì bước trước đó là tạo tất cả các bảng)

        + Chú ý php artisan migrate:rollback sẽ xóa hết dữ liệu có trong bảng đó php artisan migrate thì chỉ tạo lại cấu trúc các côt(trường) của bảng chứ không tạo lại dữ liệu.

       

        + Thao tác thêm xóa sửa,... các cột dữ liệu ở databse dbms (ex phpmyadmin) không làm thay đổi gì đối với code ở trong các file migrations 
        (khi php artisan migrate:refresh => nó cứ theo code của các file trong migrations mà thực hiện còn thao tác ở ngoài phpmyadmin thì nó không tính => các cột hay những thao tác ta thực hiện ngoài đó sẽ không còn)

+ Bảng : migrations (bảng đặc biệt)(không có file trong folder laravel , chỉ có bảng trong phpmyadmin)
    + Chứa toàn bộ lịch sử migrate 
    + Khi mà chạy lại C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel2>php artisan migrate
    => Vào database : tintuc3 thì lại có lại tất cả các bản , và vào bảng migrate sẽ lưu lại những thứ ta đã chạy 
    => vào tintuc3 => vào bảng migrations , ở đây ta có thể thêm bớt các bảng tùy ý => sau đó chạy lại thì cũng tạo ra được các bảng. Thêm id : 48,migrations : 2021_09_08_085334_create_orders_table,Filter:1 
    => php artisan migrate => vào lại 


(video41)
(Dùng thư mục laravel2)

Tạo project mới : laravel3 trong thư mục learnlaravel 
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel>composer create-project --prefer-dist laravel/laravel:^7.0 laravel3
Chạy server 
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3> php artisan serve
Thực hiện tất cả các thao tác trên laravel3
Tạo mới databse : news3 
(Nhắc lại : mỗi project chỉ nên gắn với một database duy nhất)

file .env có 
DB_CONNECTION=mysql
DB_HOST=localhost
DB_PORT=3306
DB_DATABASE=news3
DB_USERNAME=root
DB_PASSWORD=

Chạy : php artisan config:cache ,để cập nhật lại cache

+ Reset : 
    + php artisan migrate:reset 
    + xóa toàn bộ (giống như php artisan migrate:rollback nhiều lần cho đến khi hết các bảng trong database)
    => lưu ý là lệnh này cũng làm cho bảng migrations mất hết lịch sử các thứ đã chạy 
    Nhưng khi dùng Refresh thì nó lại khôi phục lại toàn bộ 

+ Refresh : 
    + php artisan migrate:refresh
    + xóa toàn bộ database => migrate lại 
    => khi chạy Refresh thì cần phải đặt biệt lưu ý 
    (php artisan migrate:refresh giống như php artisan migrate:rollback lại toàn bộ (xóa hết) rồi php artisan migrate tạo lại hết)
    (Ban đầu trong laravel3 ở thư mục migrations chưa có gì => muốn tạo lại một số bảng như laravel2 => copy file của bảng đó vào thư mục migrations của laravle3 rồi chạy php artisan migrate:refresh là được)
    + Khi mà update serve sẽ thường dùng : php artisan migrate:refresh

+ $table : 
    + id() => tạo ra các cột(trường) id => khóa chính 
    + string() => tạo các cột(trường) có kiểu : varchar 
    + string(60) => tạo ra cột(trường) varchar 60 ký tự 
    + string(tên cột, chiều dài) 
    + string('title',60) => tạo ra cột(trường) title có kiểu : varchar, độ dài 60 ký tự 
    + integer => tạo ra một cột(trường) kiểu integer (kiểu int) 
    + text(tên cột) => text 
    + date() => ngày 
    + dateTime => ngày giờ 
    + time() => giờ 
    + boolean() => true or false 
    + softDeletes() (xóa mềm)=> deleted_at => lưu thời gian xóa 
        + ex : Hệ thống ngân hàng, khi mà xóa 1 giao dịch => truy vết được , deleted_at 
        + Để bảo mật hệ thống 
            + Mysql => tạo ra một user riêng => không có quyền xóa trong db 
            + Dữ liệu không thể bị xóa 
            + Khi xóa => đánh dấu vào cột deleted_at 
        => Thêm vào => không thể bị xóa thực sự (xóa vật lí) 
    + timestamps() 
        + created_at : biết được hàng dữ liệu đó được tạo khi nào 
        + updated_at : biết được hàng dữ liệu đó được cập nhật khi nào 

    + index (có hai cách)
        + index([mảng các giá trị đánh index]);
            ex : $table->index(['title','content']); (title và content là các trường được tạo trước đó) 
        +  $table->kiểu('tên trường')->index(); : Đánh index trực tiếp 
            ex : $table->string('title')->index(); 
            ex : $table->string('content')->index();
    + default() => mặc định 
        + ex : $table->integer('views_count')->default(0); (mặc định số lượt xem là 0)
    + unique() => duy nhất 
        + ex : $table->string('username')->unique(); (không có hai người có cùng username)
        + ex : $table->string('email')->unique();    (không có hai người có cùng email)  
    + nullable() => có thể null 
        + ex : $table->string('title')->index()->nullable();
    + Chú ý : ta cũng có thể ghi nhiều hàm cùng một lúc ex : $table->string('title')->index()->nullable();
      Nhưng cũng có một số trường hợp cần lưu ý : ex : $table->string('code')->unique()->nullable();
      giả sử nếu có cái nào đó nullable, rồi có một cái khác cũng có thể nullable => vi phạm nguyên tác vì unique() quy định mỗi cái chỉ được là duy nhất . 
    => vào Database: Migrations (https://laravel.com/docs/8.x/migrations) kéo xuống dưới cùng để đọc nhiều hơn 

+ add_[tên cột]_to_[tên bảng]_table : Thêm một cột vào bảng 
    + Giả sử project ta đã hoàn thành , đã chạy php artisan migrate, đã có hết dữ liệu,... đầy đủ hết .
    => bây giờ update lên version mới , update nhiều cái mới , ex : trong bảng articles cần thêm cột author 
    
    + B1 :  đến project đó : ex project3 
        C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3>php artisan make:migration add_author_to_articles_table 
        => Created Migration: 2021_09_08_160158_add_author_to_articles_table
        (Tạo ra một file 2021_09_08_160158_add_author_to_articles_table.php trong migrations, máy sẽ hiểu là đã có bảng articles bây giờ chỉ cần thêm cột author là được)
        Ở file mà ta tạo bình thường sẽ là : Schema::create
        Còn file thêm cột sẽ là : Schema::table
    
    + B2 : vào file đó => 
        trong hàm up() :    Schema::table('articles', function (Blueprint $table) {
                                $table->string('author');
                            });

        trong hàm down() :  Schema::table('articles', function (Blueprint $table) {
                               $table->dropColumn('author');
                            });
    + B3 : C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3>php artisan migrate 
    => chính thức thêm cột đó vào bảng ở database 
+ Cột được thêm vào sẽ nằm cuối cùng (dùng ->after())
    => Để thêm cột vào vị trí ta muốn thì làm như sau :
    giả sử thêm cột votes vào sau cột content 
    C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3>php artisan make:migration add_votes_to_articles_table 
        trong hàm up() :    Schema::table('articles', function (Blueprint $table) {
                                    $table->string('votes')->after('content');
                                });
        trong hàm down() :  Schema::table('articles', function (Blueprint $table) {
                                   $table->dropColumn('votes');
                                });                        
    C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3>php artisan migrate 
    => cột votes thêm vào sau cột content 

+ Seeder: 
    + Công cụ tạo dữ liệu mẫu 
    + Admin user 
    + database/seeds (thư mục database/seeds , file DatabaseSeeder.php)
    + Tạo một databaseSeeder 
        + php artisan make:seeder UsersTableSeeder  
         => Seeder created successfully. (tạo file thành công)
        (nên đặt theo kiểu này)(thêm dữ liệu vào bảng user)
        code thêm vào file đó : <?php
                                use Illuminate\Database\Seeder;
                                use App\User;
                                use Illuminate\Support\Facades\Hash;
                                class UsersTableSeeder extends Seeder                      (1)
                                {
                                    public function run()
                                    {
                                        // viết code để tạo dữ liệu ở đây 
                                        User::create([
                                            'name'=>'Manh',
                                            'email'=>'nguyenvanmanh@gmail.com',
                                            'password'=>hash::make('123456')
                                            ]);
                                    }
                                }
        + php artisan db:seed --class=UsersTableSeeder
            + ex : C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3>php artisan db:seed --class=UsersTableSeeder  (2)
                   => Database seeding completed successfully. (Thêm dữ liệu thành công)
                   (UsersTableSeeder ở (2) chính là bắt nguồn từ class UsersTableSeeder ở (1))
                   => Dữ liệu đã được thêm vào bảng users trong database : news3 
                   (bảng user là bảng do laravel tự tạo sẵn)


        + Ưu điểm : 
            + Ta đã có nhiều cách thêm dữ liệu vào database : viết trực tiếp vào database thông qua một số dbms như phpmyadmin,vd code,.. 
            + Dùng câu lệnh sql ex : insert,... trong ô nhập (ex : phpmyadmin,vs code)
            + Dùng câu lệnh trong php tương tác với database 
            => Chậm , tốn thời gian 
        + Còn nếu như theo cách này nếu có nhiều database thì chỉ cần tạo vòng lặp ,... rồi 
        Chạy seeder một lần là có thêm được tất cả dữ liệu ex vào bảng User : php artisan db:seed --class=UsersTableSeeder

+ Chạy seeder: 
    + php artisan db:seed --class=[Tên class muốn seed]    
        + Cách 1 : chạy databaseseeder cụ thể 
        + ex : php artisan db:seed --class=UsersTableSeeder => chạy UsersTableSeeder.php 
    + php artisan db:seed      
        + Cách 2 : chạy file database/seeds/DatabaseSeeder.php (file chung)
        => chạy databaseSeeder 
        (nếu không ghi rõ file cụ thể thì nó sẽ chạy file này)
            + B1 : vào file DatabaseSeeder.php gõ $this->call(UsersTableSeeder::class); (3)
            + B2 : C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3>php artisan db:seed
            => Database seeding completed successfully. (Thành công)
            (UsersTableSeeder ở (3) cũng từ (1)) 
    + Đôi khi không chạy: 
        + Chạy lệnh : composer dump-autoload 
        (nhiều lỗi khác cũng nên chạy lệnh này để fix)

+ Father: (hay)(tìm hiểu thêm về father)
    + Là một thư viện tạo dữ liệu mẫu 
    + EX : 
        C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3>php artisan make:seeder ArticlesTableSeeder
        => Seeder created successfully. (tạo file thành công)
        Vào file ArticlesTableSeeder.php code <?php
                                              use Illuminate\Database\Seeder;
                                              use Illuminate\Support\Facades\DB;
                                              
                                              class ArticlesTableSeeder extends Seeder
                                              {
                                                  public function run()
                                                  {
                                                      //
                                                      $faker = Faker\Factory::create();
                                                      for($i = 0;$i<300;$i++){
                                                          DB::table('articles')->insert([
                                                              'title'=>$faker->realText(rand(10,20)),
                                                              'content'=>$faker->text,
                                                              'author'=>$faker->name,
                                                              'email'=>$faker->name,
                                                              'votes'=>$faker->name,
                                                              'username'=>$faker->name,
                                                              'views_count'=>$faker->randomDigitNot(10)
                                                          ]);
                                                      }
                                                  }
                                              }
                    => Những cột nào có ở bảng articles đều phải được điền vào.
        Vào file : database/seeds/DatabaseSeeder.php code thêm : $this->call(ArticlesTableSeeder::class);
        => Chạy : C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3>php artisan db:seed
        Seeding: UsersTableSeeder
        Seeded:  UsersTableSeeder (0.28 seconds)
        Seeding: ArticlesTableSeeder
        ... (đã thành công)
        => Vào bảng articles thì có một loạt dòng dữ liệu được tạo ra ngẫu nhiên (không có bài nào trùng nài nào)
    + Một số kinh nghiệm cần lưu ý : 
        + Không tìm thấy : ex : ta đã tạo ra một file migration sau đó tạo ra bảng chính thức rồi xóa đi => rồi chạy refresh lại đôi lúc sẽ không được vì máy sẽ không tìm thấy file đó để tạo lại ,...
        + Sự trùng lặp : ex : Đã tạo ra một file rồi mà tạo lại file nữa => lỗi , tạo ra một dòng dữ liệu rồi tạo lại 
        => lỗi 
        + Những lỗi này đều bắt nguồn từ các câu lệnh chạy hàng loạt như 
            + php artisan migrate:reset (xóa hết)
            + php artisan migrate:refresh (xóa hết => tải lại hết)
            + php artisan db:seed (chạy toàn bộ database) 
        + Giả sử như trên ta không muốn chạy php artisan db:seed --class=ArticlesTableSeeder
        mà ta thêm Vào file : database/seeds/DatabaseSeeder.php code thêm : $this->call(ArticlesTableSeeder::class);
        rồi php artisan db:seed => dữ liệu ở file ArticlesTableSeeder.php thì được thêm mới , nhưng dữ liệu trước đó của file 
        UsersTableSeeder.php lại được thêm vào database vì chạy php artisan db:seed là chạy hết
        => Cách khắc phục : 
            + Xóa hết database đã thêm vào trước đó ở bảng users
            + Hoặc bỏ đi dòng $this->call(UsersTableSeeder::class); (không chạy file UsersTableSeeder.php khi chạy file DatabaseSeeder.php) 
        + Một số lỗi khác như : ghi tên cột không đúng : trong articles có cột votes nhưng lại ghi 'vote'=>$faker->name,
                                thiếu dấu,... 'email'=>$faker->name           (giữa hai dòng không có dấu ',') 
                                              'votes'=>$faker->name,
        + Tất cả lỗi trên đều có thể tạo ra lỗi "671" : 
        at C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3\vendor\laravel\framework\src\Illuminate\Database\Connection.php:671
          667|         // If an exception occurs when attempting to run a query, we'll format the error
          668|         // message to include the bindings with SQL, which will make this exception a
          669|         // lot more helpful to the developer instead of just the database's errors.
          670|         catch (Exception $e) {
        > 671|             throw new QueryException(
          672|                 $query, $this->prepareBindings($bindings), $e
          673|             );
          674|         }
          675|

        => Cách fix là cứ chú tâm và những gì mình đã code và fix nó 
        + Máy cũng sẽ thông báo cho ta biết lỗi là gì ở file nào dòng nào (xem dưới ghi chú , ghi chú 2)
        + Còn nếu request xem trên client mà có lỗi thì laravel nó cũng hiện ra cho mình là lỗi ở file nào dòng nào . (Bảng bên trái là file nào,click vào các hàng bên trái thì sẽ xuất hiện code của file đó bên phải và laravel sẽ chỉ dòng bị lỗi cho chúng ta)
        => fix bug nhanh hơn . 
        Laravel cũng giống như Vuejs => chỉ cho ta biết code có bug ở dòng nào , file nào => từ đó fix nhanh hơn. 


+ PHẦN QUAN TRỌNG NHẤT CỦA LARAVEL: 
+ Model : 
    + Mô hình mvc
+ Tạo model : 
    + php artisan make:model [tên model]
    C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3>php artisan make:model Models/Article
    Nên thêm model vào một thư mục chung là Models cho gọn 
    => Model created successfully. (Thành công)
    
    + php artisan make:model [tên model] -m (tạo migration)

    Tạo ra một file model trong thư mục app và đồng thời tạo ra một file migration trong thư mục database/migrations
    C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3>php artisan make:model Models/Product  -m
    Model created successfully.
    Created Migration: 2021_09_09_055150_create_products_table
    => Xuất hiện file Product.php trong thư mục app/Models 
    và file 2021_09_09_055150_create_products_table.php trong thư mục database/migrations 
    Bởi vì như đã nói ở dưới (model-database) có sự liên kết chặc chẽ với nhau 
    => và ta cũng nên làm theo cách này 

+ ORM 
    + object relation maping: 
        + ex : 
            model:
                + Class Article (code)
                    {
                        title : 'bai viet 1',
                        content: 'noi dung bai viet 1'
                    }
                + Class User 
            database:
                + articles (database)
                    title 
                    content 
                + users 
            => cứ mỗi cái class trên model là tương ứng với mỗi database ở database 
            => Tạo file : app/Http/Controllers/ArticleController.php 
            C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3>php artisan make:controller ArticleController 
            Controller created successfully.
            code vào file ArticleController.php 
                    <?php
                    namespace App\Http\Controllers;
                    
                    use Illuminate\Http\Request;
                    use App\Models\Article; // chính là tên file Article.php trong thư mục Models 
                    
                    class ArticleController extends Controller
                    {
                        //
                        public function test(){
                            $article = new Article;
                            $article->title = 'tieu de 1';
                            $article->content = 'noi dung 1';
                            $article->author = 'tac gia 1';
                            $article->email = 'email 1';
                            $article->votes = 'votes 1';
                            $article->username = 'user name1';
                            $article->views_count =99;
                    
                            $article->save(); // lưu lại 
                            //return 'test';
                        }
                    }

            thêm route vào file web.php : Route::get('/test','ArticleController@test');
            => vào http://localhost:8000/test => hiện ra file ArticleController.php 
            dòng dữ liệu này : tieu de 1 | noi dung 1 | votes 1 | user name1 | email 1 | 99 | tac gia 1
            sẽ được thêm vào cuối database : articles 

            - file routes/web.php                                                       : quản lí các đường dẫn (route) link đến .blade.php,controller,...
                + Route::get('/test','ArticleController@test'); => http://localhost:8000/test
            - laravel3/database/migrations/2021_09_08_152310_create_articles_table.php  : tạo các cột cho bảng database (database)
            - app/Models/Article.php                                                    : chứa hết tất các thuộc tính dưới database (model)(M)
              (tạo file model mà -m => tạo luôn file migration , hai file có quan hệ với nhau) 
            - resources/views/Articles.blade.php                                        : hiển thị giao diện để người dùng tương tác trên đó(V)      
            - app/Http/Controllers/ArticleController.php                                : code logic liên hệ giữa tương tác người dùng trên client và database(C) 
                + use App\Models\Article; // chính là tên file Article.php trong thư mục Models  
                + có thể thêm dữ liệu vào database 
                + có thể lấy dữ liệu ra từ database
            - database/seeds/ArticlesTableSeeder.php                                    : tạo dữ liệu mẫu 
            => MVC 
            database/seeds/ArticlesTableSeeder.php tạo ra dữ liệu mẫu,model chứa hết tất các thuộc tính dưới database => tạo file model => tạo luôn file migration để tạo cấu trúc bảng database => model liên hệ mật thiết với database => model như là database => controller => use App\Models\Article; => dùng đến model => dùng đến bảng database ,có quyền thao tác trên database =>controller có những code logic để thao tác với database : thêm dữ liệu vào database hoặc gọi dữ liệu ra từ database để làm gì đó => controller có những hàm logic để xử lí gọi đến các file trong thư mục views => bằng routes => hiển thị => tương tác ...
            public function test(){ 
            // quá trình lưu database xuống 
              // $article = new Article;
              // $article->title = 'tieu de 1';
              // $article->content = 'noi dung 1';
              // $article->author = 'tac gia 1';
              // $article->email = 'email 1';
              // $article->votes = 'votes 1';
              // $article->username = 'user name1';
              // $article->views_count =99;

            // $article->save();
            //return 'test';

            // quá trình gọi database lên 
                $article = Article::find(847362); // 847362 là id của dòng dữ liệu đó 
                print_r($article); // hàm find() là hàm chuyển một dòng dữ liệu có id đó thành một object
                echo $article->title;
                echo $article->content;

            // các trường là các property (thuộc tính) , giá trị trong các trường là các giá trị của property 
            // hai qúa trình này gọi là ORM 
            }
            // 1 object trên code tương ứng với một dòng dữ liệu ở database (lưu xuống)
            // và ngược lại 1 dòng dữ liệu tương ứng với một object trên code (gọi lên)


    + ORM chính là mối liên kết giữa model và database 


(video42)
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel>composer create-project --prefer-dist laravel/laravel:^7.0 laravel4
Thao tác trên laravel4 
Database : news4 

.env
DB_CONNECTION=mysql
DB_HOST=localhost
DB_PORT=3306
DB_DATABASE=news4
DB_USERNAME=root
DB_PASSWORD=

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel4>php artisan make:controller ArticleController
Controller created successfully.   => Máy báo tạo file controller thành công 

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel4>php artisan make:model Models/Article -m
Model created successfully.        => Máy báo tạo file model thành công 
Created Migration: 2021_09_10_015907_create_articles_table => Máy báo tạo file migration thành công 

Tạo Articles.blade.php             => Tự tạo file views 

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel4>php artisan make:seeder ArticlesTableSeeder
Seeder created successfully.       => Máy báo tạo file seeder thành công 
Thao tác trên laravel4 
Database : news4 
app/Http/Controllers/ArticleController.php 
app/Models/Article.php 
database/migrations/2021_09_10_015907_create_articles_table  
resources/Articles.blade.php             
routes/web.php 
database/seeds/ArticlesTableSeeder.php 


Tạo các cột(trường) cho bảng dữ liệu articles 
=> vào file 2021_09_10_015907_create_articles_table.php code thêm các cột: title,content,author,views_count

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel4>php artisan migrate 
Migration table created successfully.  => Tạo các bảng và cột ở bảng thành công 
Migrated:  2014_10_12_000000_create_users_table (0.07 seconds)       Đã tạo bảng users
Migrated:  2019_08_19_000000_create_failed_jobs_table (0.03 seconds) Đã tạo bảng failed_jobs
Migrated:  2021_09_10_015907_create_articles_table (0.07 seconds)    Đã tạo bảng articles 

Tạo dữ liệu mẫu để có cái mà thực hành với database 
=> vào file database/seeds/ArticlesTableSeeder.php code thêm , dùng thư viện father tạo khoản vài trăm dòng dữ liệu 
Vào file : database/seeds/DatabaseSeeder.php code thêm : $this->call(ArticlesTableSeeder::class);
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel4>php artisan db:seed    
// chạy file DatabaseSeeder.php (chạy toàn bộ file seeds được call trong file DatabaseSeeder.php)
Seeded:  ArticlesTableSeeder (0.98 seconds)  => Tạo dữ lệu mẫu thành công .
Database seeding completed successfully. 
vào file app/Http/Controllers/ArticleController.php để viết các code logic thao tác với database 
vào routes/web.php tạo route cho file ArticleController.php : Route::get('/test','ArticleController@test')
=> Ctrl + C để tắt serve => C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel4>  php artisan serve
Nến khởi động lại serve để serve chạy lại hết tất cả những gì ta thay đổi cho an toàn .
Nhiều trường hợp nhập xong chưa chạy => khởi động lại serve thì chạy được 


+ Eloquent model : 
    + model của chúng ta extends model trong namespace Eloquent
+ Các hàm Eloquent model :
    + Cùng với code logic ở controller để gọi và lưu dữ liệu ở database 
    + Khá là giống với những câu lệnh trong mysql
    + Hàm đọc dữ liệu :
        ==========================Hàm đọc dữ liệu==========================
        Hàm đọc dữ liệu bao gồm : 
        + find(id)        => trả về một object    
        + findOrFail(id)  => trả về một object   
        + first()         => trả về một object     
        + firstOrFail()   => trả về một object         
        + max()           => trả về một số     
        + min()           => trả về một số     
        + count()         => trả về một số           
        + all()           => trả về một collection (mảng) các object       
        + paginate()      => trả về một collection (mảng) các object         
        + get()           => trả về một collection (mảng) các object         
        => Khi mà đã đọc đến các hàm này rồi thì => query xuống database => sẽ không đọc các hàm sau nó nữa 
            + ex : ->get()->where()->limit()->offset()->.... sau get() sẽ không được đọc nữa 
        => khi mà gọi một trong các hàm này thì trước đó phải chuẩn bị build ra câu lệnh query rồi 
        -------------------------------------------------------
        Hàm build câu lệnh query : 
        + where()
        + limit()
        + offset()
        + take()
        + orderBy()
        + orderByDesc()
        -------------------------------------------------------
        + find(id) => trả về một object chứa tất cả các cột (chỉ tìm được bằng id)
            + Nếu không có id đó => lỗi => dùng if 
              $article = Article::find(301); => $article lúc này là hàng dữ liệu có id là 301 
              if($article){do something...} // nếu có thì làm gì đấy , không thì thôi , cũng không báo lỗi gì luôn
              vì nó là một câu lệnh hợp lí , đúng thì làm , không thì thôi 
              => Laravel vẫn có một cái đó là : findOrFail(id)
        + findOrFail(id) => giống hàm trên => nếu không tồn tại => báo lỗi 
            + Nếu findOrFail(id) một id không tồn tại thì vẫn in ra kết quả đúng của những câu lệnh trước nó,còn nó thì in ra thêm 404 | Not Found,còn sau nó thì không thực hiện vì đến findOrFail(id) thì bị lỗi và dừng ngang đấy.
        + first() => tra về bản ghi đầu tiên thõa mãn điều kiện 
        + firstOrFail() => nếu không tồn tại => báo lỗi 
            + firstOr(function(){
                echo 'Đọc ra cái đầu tiên , nếu lỗi thì chạy function này';
              })
        + max(tên cột) => lấy số nhiều nhất 
        + count()
        ---------------------------------------------------
        + all() => trả về tất cả dữ liệu
            + ex : $articles = Article::all(); => $articles như là bảng dữ liệu Article luôn 
                   $articles = Article::all();
                   echo count($articles);    // in ra số hàng dữ liệu của bảng đó 
                   print_r($articles);       // in ra tất cả 
                   print_r($articles[1]); echo '<br><br>';   
                   echo $articles[1]->title; echo '<br><br>'; // in ra title của hàng thứ 2  
                   foreach ($articles as $article) { // lặp qua tất cả các hàng của bảng đó 
                       echo $article->title;         // in ra title của hàng đó 
                       echo '<br>';
                   }
            + Đối với find hay findOrFail sẽ lưu một hàng dữ liệu vào một biến dưới dạng một objetc , các trường là tên các thuộc tính , giá trị trên hàng dữ liệu
                đó là giá trị của các property ex : title là tên property , 'bai viet 1' la giá trị của property 
                $article->title; (object lấy ra giá trị từ property)
                $articles[1] giống như $article = Article::find(1) // hàng dữ liệu có id=1 
            + Đối với all() => lưu cả một bảng dữ liệu vào biến dưới dạng một mảng , trong mảng chứa các phần tử là các object , mối object tương ứng với mỗi hàng 
               dữ liệu trên bảng . $articles = Article::all(); : $articles là một bảng dữ liệu, $articles[1] là phần tử thứ 2 của mảng $articles và cũng là dòng 
               thứ 2 của bảng dữ liệu . echo $articles[1]->title => in ra title của hàng thứ 2
            + Khi all() => thứ tự phần tử cũng là thứ tự của dòng dữ liệu (chú ý mảng bắt đầu đếm từ vị trí 0) , [0] => thứ nhất => dòng thứ nhất trong bảng 
               database hoặc là [1] => phần tử thứ 2 => hàng thứ hai trong bảng database,thứ tự phần tử cũng là thứ tự của dòng dữ liệu nhưng chưa chắc giống với id
               vì có thể id là 5 nhưng nằm ở dòng 3 => thứ tự phần tử là 3 => [2] (vì có thể các dòng id trước đó ví dụ id=2 id=3 bị xóa hay bị bỏ đi chẳng hạn thì id=5 sẽ được dòn lên hàng phía trên hoặc là do người dùng không đặt id theo thứ tự ,... nói chung id chưa chắc giống với thứ tự)
               (và nếu có bình thường tức là không xóa , không sửa,... id tăng dần theo thứ tự thi id bắt đầu đếm từ 1 còn mảng thị bắt đầu đếm từ 0 
               nên chú ý [0] thì tức là id=1 , cái này cũng nói thêm thôi chứ , vị trí trong mảng và id chẳng có quy định gì liên quan đến nhau cả)
               Chỉ có thứ tự trong mảng và thứ tự trong bảng là giống nhau , ex : [5] => phần tử thứ 6 => hàng thứ 6 

               + Còn nếu là không phải all() => thì không có mối liên hệ nào luôn , id thì khỏi nói rồi nó không có quy ước liên quan nào cả.
                 Còn thứ tự trong bảng lớn và thứ tự trong mảng thường thì cũng khác nhau luôn 
                 ex : $articles4s = Article::where('title','like','%you%')->get(); // lấy ra tất cả những bài viết có title có chữ 'you'
                 => tạo ra một bảng mới chứa tất cả các bài viết có title có chữ 'you' , bảng này thì tất nhiên sẽ sắp xếp theo thứ tự từ 1 => đến n 
                 lưu vào biến dưới dạng mảng thì sắp xếp theo thứ tự từ 0 -> n-1 , còn tất nhiên sẽ khác thứ tự trong bảng lớn vì bảng lớn sắp xếp các bài viết ngẫu nhiên chứ theo quy tắc nào đâu tất nhiên là cũng không liên quan đến title có 'you' ,... 

        + paginate(số lượng) phân trang (hay)
            + ex : $articles2 = Article::paginate(10); // mỗi lần chỉ lấy ra 10 bài viết 
                   foreach ($articles2 as $article) {
                       echo $article->title;
                       echo '<br>';
                   }  
                   và điều đặc biệt là : http://localhost:8000/test?page=2 , khi mà ta nhập thì sẽ link đến danh sách trang đó luôn 
                   + page tự động có trong laravel  
                   http://localhost:8000/test?page=1 => bài 1 đến bài 10 
                   http://localhost:8000/test?page=2 => bài 11 đến bài 20 
                   http://localhost:8000/test?page=3 => bài 21 đến bài 30 
                           ...
                   http://localhost:8000/test?page=30 => bài 291 đến bài 300
                           ... 
            + echo $articles->link(); : Laravel cũng chuẩn bị sẵn link cho chúng ta 
                + Hiển thị ra tất cả các link đến các page (ex : 301 bài => mà ta hiển thị trên mỗi page là 10 bài => có 31 page) 
                => echo $articles->link(); => in ra số từ 1 đến 31 và có hai dấu '<' , '>' để back và next nữa 
                click vào số 1 => đến http://localhost:8000/test?page=1 , click vào 6 => đến http://localhost:8000/test?page=6 ,...
        + get() => lấy tất cả theo điều kiện 
            + Nếu không có gì thì giống all()
            + Có thể lấy theo điều kiện 
            + Câu lệnh điều kiện cũng khá là giống với câu lệnh bên database msql 
            + Chú ý : get() vẫn giống all() là lưu vào biến dưới dạng một mảng , còn trong đó một hay nhiều phần tử thì tính sau .
            + ex : $article3s = Article::where('id',10)->get();    // lấy "Những" bài viết có id = 10 
                   "Những" bài viết => Nghe thì không hợp lí, vì thường trong bảng dữ liệu thì mỗi dòng có một id và các id thường không giống nhau => Nhưng nguyên tắc của get() vẫn vậy , lấy ra tất cả , thực tế thì trong bảng dữ liệu không có hai id giống nhau => where id thì chỉ có một phần tử 
                   => vẫn lưu dưới dạng mảng ,khi lưu vào biến, thì biến đó thường chi có một phần tử echo $article3s[0]->id;
            + ex : $articles4s = Article::where('title','like','%you%')->get(); => Tìm ra những bài viết có title có chữ 'you' => lưu vào một bảng riêng rồi lưu vào biến $articles4s dưới dạng mảng , bắt đầu từ [0] đến [n] , mỗi phần tử là một object tương đương với mỗi hàng dữ liệu (giống all)
            + get() cũng giống all() là lấy ra nhiều dòng dữ liệu , nhưng all() là lấy ra hết tất cả các dòng trong bảng , còn nếu get() không có điều kiện thì như all() , mà có điều kiện thì lấy ra những dòng dữ liệu theo điều kiện .
        ==========================Hàm đọc dữ liệu==========================
        + => Build query 
        + ex : $article14s = Article::where('id','>',100)->limit(10)->get();
            quá trình build query
            $article14s = Article::where('id','>',100) // thêm where 
                                   ->limit(10)  // thêm limit 
            => lúc này laravel mới build ra câu lệnh này thôi : SELECT * FROM articles WHERE id >100 LIMIT 10;
                                   ->get(); // chạy hàm get() mới chính thức Đọc database (query xuống database)

            ex : trường hợp : đặt vấn đề là code như sau vẫn chạy vẫn cho kết quả giống code phía trên, mặc dù đã nói là đến hàm get() thì đã đọc xuống database 
            $article14s = Article::where('id','>',100) // thêm where 
                                   ->get(); // chạy get() => đọc rất nhiều dữ liệu lên ram 
                                   ->limit(10)  // thêm limit => lấy ra 10 bài đầu tiên 
                => chạy thì cho kết quả giống => nhưng không được => bởi vì nếu trừng hợp database của ta có rất nhiều dữ liệu => chạy get() => lấy ra nhiều dữ liệu => sập server => không được (khi đi làm tuyệt đối không được viết kiểu này)
            => Tốt nhất là cứ tuân thủ nguyên tắc cứ gọi đến các hàm đọc dữ liệu (khi gọi đến sẽ query xuống database) thì dừng là ok nhất .
            => Các hàm đọc dữ liệu (khi gọi đến sẽ query xuống database) sẽ được viết cuối cùng.

        + Các điều kiện : 
            + where('cột','giá trị') => so sánh bảng 
                + ex : $article = Article::where('id',10)->get(); // lấy ra "Những" bài viết có id = 10 ;
            + where[tên_cột](giá trị)
                + ex : $article5s = Article::whereId(301)->get();                 // lấy "những" bài viết có id = 301 
                + ex : $article6s = Article::whereTitle('I should say.')->get();  // lấy những bài viết có title là 'I should say.'
                + Chú ý : whereId,whereTitle,... cũng được mà whereid,wheretitle cũng được 
                + Chú ý : nếu ta có trường views_count => thì phải viết là whereViewsCount()  (chứ whereviews_count) là sai (bỏ dấu "_" đi)
            + where('cột','so sánh','giá trị')
                + ex : $article9s = Article::where('views_count','>=',100)->get();
                + ex : $article4s = Article::where('title','like','%you%')->get(); // lấy ra những bài có title có chữ 'you' 
        + where nhiều điều kiện 
            + where()->where()->where->....->get()
                + ex : $article10s = Article::where('views_count','>=',100)->where('title','like','%you%')->get();
                views_count >=100 và title có chữ "you" 
            + where([mảng các điều kiện])
                + ex : $article11s = Article::where([
                           'id' => 2,                    // bài viết có id = 2 , title = 'I gave her.''
                           'title' => 'I gave her.'])
                           ->get();
                + Cách này có nhược điểm là không thể so sánh hay tìm văn bảng như cách trên , mà chỉ có thể so sánh bằng "="   
            + Kết hợp cả hai cách (hay)
                + ex : $article12s = Article::where([
                                     'views_count' => 99,                      
                                     'title' => 'Let me.'])
                                     ->where('id','>=',100)->get(); 
                        => Lấy ra những bài viết có views_count = 99 và title = 'Let me.' và id >= 100 
                 + ex : $article12s = Article::where([
                                     'views_count' => 99,                      
                                     'title' => 'Let me.'])
                                     ->where('id','>=',100)->where('content','like','%pro%')->get(); 
                        => Lấy ra những bài viết có views_count = 99 và title = 'Let me.' và id >= 100 và content có chữ "pro"
        + limit() : giới hạn số lượng bảng ghi cần lấy 
            + ex : $article14s = Article::where('id','>',100)->limit(10)->get(); 
            => nếu không có offset() thì mặc định lấy từ đầu , lấy 10 bài viết đầu (bài viết có id từ 101 đến 110)
        + offset() : cùng với limit() và điều kiện => xác định vị trí bắt đầu lấy 
            + $article15s = Article::where('id','>',100)->limit(10)->offset(16)->get();
            => lấy 10 bài viết đầu tiên (bắt đầu từ bài viết có id > 100+16) (117 đến 216) 
        + first() => tra về một bản ghi đầu tiên thõa mãn điều kiện 
            + $article16 = Article::where('id','>',100)->first();  // lấy bài viết đầu tiên => bài có id = 101 
            + echo $article16->title;
            => first() lưu vào biến dưới dạng object luôn (không lưu dưới dạng mảng) giống như find(id) và findOrFail(id)
        + firstOrFail() => nếu không tồn tại => báo lỗi (giống với findOrFail(id)) 
        + take() giống limit() chỉ khác tên gọi 
        + orderBy('tên cột') => sắp xếp tăng 
            + $article17s = Article::where('id','>',100)->limit(10)->orderBy('views_count')->get();
            => lấy ra tất cả các hàng có id>100 => sắp xếp theo chiều tăng dần views_count => lấy 10 bài đầu tiên của danh sách sau khi xếp đó
        + orderByDesc('tên cột') => sắp xếp giảm 
            + $article17s = Article::where('id','>',100)->limit(10)->orderByDesc('views_count')->get();
            => lấy ra tất cả các hàng có id>100 => sắp xếp theo chiều giảm dần views_count => lấy 10 bài đầu tiên của danh sách sau khi xếp đó
        + max(tên cột) => lấy số lớn nhất 
            + $MaxViews_count = Article::max('views_count');
        + min(tên cột) => lấy số nhỏ nhất 
            + $MinViews_count = Article::min('views_count');
        + count() : số các hàng dữ liệu của bảng 
            + $columsNumber = Article::count('views_count');
        => Các hàm được liệt kê phía trên có thể kết hợp lại dùng chung với nhau tùy vào yêu cầu của ta muốn gì .

tạo hàm test2 để thực hành ghi dữ liệu trong file ArticleController.php
    public function test2(){

    }
thêm route vào web.php : Route::get('/test2','ArticleController@test2');
=> http://127.0.0.1:8000/test2

    + Các hàm tạo dữ liệu :
        + Cách 1 : 
            + tạo ra một object => đổ dữ liệu vào => save xuống database => save()
                + ex : cách đổ dữ liệu bằng tay 
                       $article = new Article; 
                       $article->title = 'tieu de 1';
                       $article->content = 'noi dung 1';
                       $article->author = 'tac gia 1';
                       $article->views_count =99;
            + save() => thực hiện lưu xuống database 

        + Cách 2 : (hay)
            + đổ dữ liệu vào model 
                + fillable: các cột mà dữ liệu mà model được đổ vào 
                    + vào file Models/Article.php => code thêm : class Article extends Model{protected $fillable = ['title','content','author','views_count'];}
                    + chú ý :phải viết chính xác tên biến là như thế này : $fillable
                    + Các trường được đổ dữ liệu vào => viết vào trong mảng  
                    + vào file ArticleController.php code 
                       $article = new Article;
                       $article->fill([
                        'title' => 'bai viet 3',
                        'content' => 'noi dung 3',
                        'author' => 'manh',
                        'views_count' => 9999
                       ]);
                    + chú ý một lần request là lưu thêm vào database 
                    + $article->save(); // thực hiện lưu db
                + Chú ý : 
                + fillable chỉ lưu những thứ có viết vào hàm 
                ex : $article->fill([
                        'title' => 'bai viet 3',
                        'content' => 'noi dung 3',
                        'author' => 'manh',
                        'views_count' => 9999,
                        'abc' => 'xyz',
                        'mnvaojwfiegj' => 'avwegiowhoi'
                        'dia chi' ='hue'
                       ]);
                => Thì fillable cũng chỉ lấy những giá trị của trường có ghi vào $fillable = ['title','content','author','views_count']
                + Biến $request => chứa rất nhiều thông tin , gồm cả thông tin ta cần (thông tin user nhập vào) và cả những thông tin ta không cần .
                + => Thì ta có thể tận dụng biến $request để lấy thông tin một cách nhanh chóng và hàm fill sẽ lọc ra các thông tin mà ta cần 
                +      public function test2(Request $request){
                          $article = new Article;
                          $article->fill($request->all() ); // $request sẽ đổ vào tất cả => fill chỉ lọc để lấy ra : title,content,author,views_count
                          $article->save(); 
                       }
                => Nhanh, đầy đủ và chính xác , $request và hàm fill kết hợp lại sẽ sử dụng tốt biến $request
                => dùng nhiều 

        + Cách 3: (hay)
            + create([]) 
            + vào file Models/Article.php => code thêm : class Article extends Model{protected $fillable = ['title','content','author','views_count'];}
                + $article4 = Article::create([
                      'title' => 'tieu de 1',
                      'content' => 'noi dung 1',
                      'author' => 'tac gia 1',
                      'views_count' => 99
                  ]); 
                  // create() yêu cầu phải đúng chính xác những thứ mà bảng Article cần , không viết sai giá trị khác vào được 
                  hoặc 
                + $article5 = Article::create($request->only(['title','content','author','views_count'])); (hay)
                + => only([]) cũng là hàm lọc ra những thứ mà ta cần 

        + Cách 4: 
            + insert([[],[],[],...]) 
            + cũng giống với create([]) nhưng khác ở chỗ cõ thể insert nhiều hàng dữ liệu cùng lúc 
            + vào file Models/Article.php => code thêm : class Article extends Model{protected $fillable = ['title','content','author','views_count'];}
            + ex : 
                $article6 = Article::insert([
                    [
                    'title' => 'tieu de 1',
                    'content' => 'noi dung 1',
                    'author' => 'tac gia 1',
                    'views_count' => 99
                    ],
                    [
                    'title' => 'tieu de 2',
                    'content' => 'noi dung 2',
                    'author' => 'tac gia 2',
                    'views_count' => 99
                    ],
                  ]); 
                => thêm hai hàng dữ liệu cùng lúc .

tạo hàm test3 để thực hành Vừa đọc và vừa ghi dữ liệu trong file ArticleController.php
    public function test3(){

    }
thêm route vào web.php : Route::get('/test3','ArticleController@test2');
=> http://127.0.0.1:8000/test3

    + Vừa đọc và vừa ghi (hay dùng)
        + firstOrCreate()                            
        + firstOrNew() (giống hệt firstOrCreate()) 
            + Nếu như đã tồn tại rồi => đọc 
            + Nếu như chưa tồn tại => tạo mới => lưu xuống database 
            + ex :  $article = Article::firstOrCreate(
                    ['title' => 'bai viet 1000'],                          // tìm có thì thôi còn nếu tìm không có bài viết có title = 'bai viet 5'  
                    ['content' => 'noi dung bai viet 5','author' => 'manh','views_count' => 999] // thì tạo ra bài viết với dầy đủ nội dung như sau 
                );
                // lưu ý là phải viết đúng và đầy đủ tên các cột trong bảng 
        + updateOrCreate() 
        + updateOrNew() (giống hệt updateOrCreate())
            + Nếu như đã tồn tại rồi => update
            + Nếu như chưa tồn tại => tạo mới => lưu xuống database 
            + ex :  $article2 = Article::updateOrCreate(
                        ['title' => 'bai viet 999999'],  // tìm nếu có bài viết có title = 'bai viet 999999' 
                        // thì sửa content thành 'noi dung bai viet 9999999'  sửa author thành 'manh pro' , sửa views_count thành 999 
                        ['content' => 'noi dung bai viet 9999999','author' => 'manh pro','views_count' => 999]
                    );
    
    + Cập nhật dữ liệu : update()
        + đọc model ra => sửa => save(); (cách 1)
            + ex : $article3 = Article::find(316);
                   $article3->title = 'tieu de moi';
                   $article3->content = 'noi dung bai viet moi';
                   $article3->author = 'tac gia manh pro';
                   $article3->views_count =99;
                   $article3->save(); 
               => phải chạy hai lệnh query 
        + update([các filed cần sửa]);   (cách 2)
            + ex : $article4 = Article::whereId(312)->update([
                       'title' =>  'tieu de rat la moi',
                       'content' =>  'noi dung bai viet rat la moi',
                       'author' =>  'tac gia manh pro',
                       'views_count' => 99
                   ]);   
                => chạy đúng một câu query 
    + Xóa dữ liệu : 
        + đọc model ra => gọi hàm delete();
            + ex : $article5 = Article::find(313); // kiểu như còn xuất ra một số câu như bạn có muốn xóa hay không hay kểu kểu thế 
                   $article5->detete();
        + destroy(id)  // nếu xóa luôn mà không cần làm gì nữa thì dùng lệnh này 
            + ex : Article::destroy(313); // xóa bàii viết có id = 313 
        + destroy([id,id,id,id]) // xóa nhiều bài cùng lúc 
            + ex : Article::destroy([308,303,304]); // xóa bài viết có id = 308 , id = 303 , id = 304 


(video43)
tạo mới thư mục laravel5 
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel>composer create-project --prefer-dist laravel/laravel:^7.0 laravel5
tạo mới database : tintuc43 

.env
DB_CONNECTION=mysql
DB_HOST=localhost
DB_PORT=3306
DB_DATABASE=tintuc43
DB_USERNAME=root
DB_PASSWORD=

tạo file models Post và file migrations 
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel5>php artisan make:model Models/Post -m
Model created successfully.               
Created Migration: 2021_09_10_193312_create_posts_table

tạo file controller : PostController.php 
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel5>php artisan make:controller PostController --resource
Controller created successfully.
code vào file PostController.php tại hàm create : return view('post.create');

vào file web.php 
=> thêm route => Route::resource('/post','PostController');
=> khi đến http://localhost:8000/post => chạy tất cả các hàm của file PostController.php 
=> đến hàm create => return view('post.create'); => hiển thị file create.blade.php trong thư mục views/post 

+ Artisan hiển thị các route: 
    + php artisan route:list 
    => Hiển thị danh sách các route (các route trong web.php)
    => hiển thị ra đầy đủ hết, kể cả link đến các hàm ,...


+ Thực hành: 
Blog: 
    - Danh sách bài viết 
    - Tạo bài viết 
    - Sửa bài viết 
    - Xóa bài viết 

vào file 2021_09_11_122435_create_posts_table.php code :  
tạo các trường 
Schema::create('posts', function (Blueprint $table) {
    $table->id();
    $table->string('title');
    $table->text('content');
    $table->timestamps();
});
=> php artisan migrate => Migration table created successfully. (thành công)

=> Trong thư mục views thường tạo thư mục : layouts để chứa những cái file .blade.php ,các file khác extends các file này  
resources/views/layouts/master.blade.php            

tạo thư mục post chứa các file extends các file trong thư mục layouts 
(các file trong thư mục post sẽ kế thừa những thứ có sẵn , khung ,... các thú có sãn trong thư mục layouts, chỉ cần code thêm nội dung)
=> resources/views/post 
=> tạo file resources/views/post/create.blade.php
code vào resources/views/layouts/master.blade.php : 
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>@yield('title')</title>   // để hiển thị nội dung file khác 
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"  crossorigin="anonymous">
</head>
<body>
<div class="container">
    <div class="row">
        @yield('content')  // hiển thị nội dung phần @section('content') của file create (phần tạo bài viết)
    </div>
</div>
</body>
</html>

code vào file resources/views/post/create.blade.php : 

@extends('layouts.master') // extends code của file master.blade.php nằm trong thư mục layouts trong viewss

@section('title','Tạo bài viết') // truyền một nội dung đơn giản thì truyền trực tiếp 

@section('content') // mở // truyền nhiều code thì có mở và đóng 

<form action="{{route('post.store')}}" method="post">
    <div class="form-group">
        <label for="title">Tiêu đề :</label>
        <input class="form-control" type="text" name="title">
    </div>
    <div class="form-group">
        <label for="content">Nội dung : </label>
        <textarea class="form-control" name="content" id="content" rows="10"></textarea>
    </div>
    <div>
        <button type="submit">Đăng bài</button>
    </div>

</form>

@endsection  // đóng 

+ resources/views/layouts/master.blade.php : 
ở action thay vì truyền vào link  <form action="http://localhost:8000/post" method="post"> thì ta nên <form action="{{route('post.store')}}" method="post">
=> hàm route() đại khái là hàm lấy giá trị => chuyển thành link , và post.store bắt nguồn từ bảng route 
Như đã nói ở trên C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel5>php artisan route:list => hiện ra tất cả các route 

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel5>php artisan route:list
+--------+-----------+------------------+--------------+---------------------------------------------+------------+
| Domain | Method    | URI              | Name         | Action                                      | Middleware |
+--------+-----------+------------------+--------------+---------------------------------------------+------------+
|        | GET|HEAD  | /                |              | Closure                                     | web        |
|        | GET|HEAD  | api/user         |              | Closure                                     | api        |
|        |           |                  |              |                                             | auth:api   |
|        | GET|HEAD  | post             | post.index   | App\Http\Controllers\PostController@index   | web        |
|        | POST      | post             | post.store   | App\Http\Controllers\PostController@store   | web        |
|        | GET|HEAD  | post/create      | post.create  | App\Http\Controllers\PostController@create  | web        |
|        | GET|HEAD  | post/{post}      | post.show    | App\Http\Controllers\PostController@show    | web        |
|        | PUT|PATCH | post/{post}      | post.update  | App\Http\Controllers\PostController@update  | web        |
|        | DELETE    | post/{post}      | post.destroy | App\Http\Controllers\PostController@destroy | web        |
|        | GET|HEAD  | post/{post}/edit | post.edit    | App\Http\Controllers\PostController@edit    | web        |
+--------+-----------+------------------+--------------+---------------------------------------------+------------+

=> Name : post.store có gía trị URI là : post => {{route('post.store')}} = http://localhost:8000/post
(nếu muốn kiểm tra thì => vào http://localhost:8000/post/create?title=&content= ) => inspects 
=><form action="{{route('post.store')}}" method="post"> nhưng tại action ta vẫn thấy <form action="http://localhost:8000/post" method="post"> 
=> đúng 
+ Từ đây sau này muốn lấy link của file hay hàm nào thì cứ vào CMD => php artisan route:list => hiện ra các Name tương ứng với các link 
=> cho Name đó vào hàm route() là được 

+ Lỗi csrf : Kỹ thuật tấn công giả mạo : (lúc trước học php phần session và cookie ta có nói đến lỗi xss), giờ đến csrf 
=> Hack sẽ tấn công thông qua form => Tạo ra một token rất là khó đoán để ngăn chặn đều đó . Đối với laravel thì có sẵn luôn 
+ => @csrf 
<form action="{{route('post.store')}}" method="post">
    @csrf                                               + Dưới mỗi form phải luôn luôn để @csrf 
    <div class="form-group">
      ...
    </div>
</form>
+ Dưới mỗi form phải luôn luôn để @csrf => khi mà vào file này => http://localhost:8000/post/create => inspect để xem trang nguồn 
=> tại dòng có @csrf => sẽ xuất hiện : <input type="hidden" name="_token" value="doNUbWZlhlJqaLaRiNN0Ca66G0NyU62mnr4cWl8g"> <div class="form-group"> 
=> tạo ra một token có value rất là khó đoán 

+ Vào file app/Http/Controllers/PostController.php 
code vào hàm store : return 'Đây là hàm lưu';
=> đến địa chỉ http://localhost:8000/post/create => nhấn 'Đăng bài' => sẽ chuyển đến hàm đó => hiện ra Đây là hàm lưu (đến hàm store thành công)

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel5>php artisan make:request post/CreatePostRequest
Request created successfully.
=> tạo ra file CreatePostRequest.php trong app/Http/Request/post/CreatePostRequest.php 
(request đã học ở buối trước , chạy pass qua các hàm các thứ ,... mới đến được file hoặc hàm cần đến)
code vào file CreatePostRequest.php : 
    public function authorize(){
        return true;                         // tạm thời để true , xem như pass qua được hàm authorize()
    }
    public function rules(){                 // ghi các luật 
        return [
            'title' => 'required|max:500',   // cụ thể ở đây là title bắt buộc không tối đa 500 kí tự 
            'content' => 'required'          // content => bắt buộc => phải có 
        ];
    }

code vào file PostController.php 
use App\Http\Requests\post\CreatePostRequest; // App\Http\Requests\post là namespace của file CreatePostRequest.php , CreatePostRequest là class trong file đó
public function store(CreatePostRequest $request) // thay vì dùng store(Request $request)
=> nó chỉ đến được hàm store của file PostController.php khi mà pass qua được hai hàm authorize() và rules()
=> ex không nhập gì mà bấm 'Đăng bài' => thì quay lại link này http://localhost:8000/post/create => sẽ không đến được hàm store 

+ Laravel show error 
code vào file resources/views/post/create.blade.php :
@foreach ($errors->all() as $error)
    <div class="alert alert-danger">{{ $error }}</div>
@endforeach
=> bào ra lỗi gì ở client 

+ code vào file Models/Post.php : protected $fillable = ['title','content'];

+ code vào file PostController.php : use App\Models\Post; // App\Models là namespace của file app\Models\Post.php , Post là class trong file đó
+ Chú ý : file nào cũng có một : namespace từ đó ta muốn dùng class nào thì kết hợp namespace và tên class của file đó lại (đã học ở php)
public function store(CreatePostRequest $request) // thay vì dùng store(Request $request)
+ Giống như bài trước tại file controller , viết code logic để lấy dữ liệu 
  
  public function store(CreatePostRequest $request)  
    {
        $post = new Post;
        $post->fill($request->all());
        $post->save();
    }
----------------------------hay------------------------------------
=> Giải thích lại thứ tự một lần nữa (giống như bài video41) về MVC 
=> Tạo file model -m => tạo luôn file migration => để tạo các trường cho bảng , file model liên kết chặc chẽ với database (Post.php như là bảng posts)
=> Tạo file .blade.php để hiển thị lấy database từ user (xem như mặc rontend, mặc nền phía trên cũng được vì chủ yếu code html , css ,bootstrap ,js)
=> Tạo file controller để code logic , thao tác với user , lấy database ,... (backend điều khiển ở mặc dưới)
=> Tạo file web.php để tạo các route cho các file , các hàm
=> Tạo file request (CreatePostRequest.php) để ghi vào đó các luật , cũng như lấy tất cả thông tin tại lần request đó tại trang .blade.php đó lưu vào biến $request
Trình tự 
=> user vào link http://localhost:8000/post => file web.php có route Route::resource('/post','PostController');
=> đến file PostController.php => chạy lần lượt qua tất cả các hàm trong file đó => đến hàm create => 
    public function create(){
        return view('post.create'); // => hiển thị ra file create.blade.php của thư mục post 
    } 
// file create.blade.php của thư mục post để code cho nhanh thì chỉ cần ghi nội dung chính còn lại phần khung cơ bản thì extends từ file master.blade.php của thư mục layouts  
=> hiện ra form nhập title và content => bấm 'Đăng bài' , gửi form đến link trong <form action="{{route('post.store')}}" method="post">
=> đến http://localhost:8000/post 
+ Nếu như nhập sai yêu cầu trong file request không pass qua được hàm authorize() và các luật trong hàm rules() thì không đến được hàm store trong file controller 
+ Còn nếu pass qua được các hàm => dữ liệu mà người dùng nhập vào form 
<input class="form-control" type="text" name="title"> => lưu vào biến $_POST, biến $request có key là title , giá trị là nội dung mà user nhập 
<textarea class="form-control" name="content" id="content" rows="10"></textarea> =lưu vào biến $_POST,biến $request với key là content ,nội dung là user nhập 
=> mà biến $request chứa tất cả những thông tin , thao tác của user 
=> pass qua được thì chuyển đến hàm store của file controller , 
trong file controller có 
use App\Http\Requests\post\CreatePostRequest; => lấy được biến $request => lấy được toàn bộ data 
use App\Models\Post;  => gửi đến model => lưu xuống database 

public function store(CreatePostRequest $request)  // use App\Http\Requests\post\CreatePostRequest; để lấy được biến $request
    {
        $post = new Post; // tạo ra một biến để thao tác với nó // use App\Models\Post; để liên kết được với Post.php => liên kết được với bảng database : posts  
        $post->fill($request->all());  
        $post->save();
    }

$post = new Post; // tạo ra một biến để thao tác với nó // Post.php như là bảng database posts => $post = new Post; => biến $post như là file Post.php 
=> như là bảng posts => lúc này biến $post như là bảng database posts trên cở sở dữ liệu , tintuc43 
=> thao tác trên biến $post => như thao tác trên bảng posts 
=> Tại file Models/Post.php (dùng biến $fillable) để chỉ lấy hai cột mà bảng posts có và cần đổ dữ liệu vào : protected $fillable = ['title','content'];
=> $request chứa tất cả database , bao gồm cả gía trị của hai key title và content đã nhập vào form 
( [title] => 'giá trị mà user nhập vào', [content] => 'giá trị mà user nhập vào')
$post->fill($request->all()); // => dùng hàm all() để lấy ra hết tất cả dữ liệu rồi dùng hàm fill để lọc ra các trường mà model/post.php cần : title và content 
$post->save(); => lưu giá trị của title và content xuống bảng posts ở database : tintuc43 
=> Ngoài title và content , trong bảng post có hai trường do hàm $table->timestamps(); created_at và updated_at 
là ngày tạo và ngày update bài viết đều được lưu vào database => rất là được 
---------------------------------hay-----------------------------------------
tiếp tục 

+ code vào file : PostController.php 
// sau khi mà lưu xong thì 
        return redirect('/post/create') // trở về trang cũ http://localhost:8000/post/create 
               ->with('success',true);  // tạo và lưu vào biến success là true 

+ code vào file resources/views/post/create.blade.php :
@if(session('success')) // trong session sẽ có lưu biến success được tạo ra ở code phái trên, nếu như trong if là truthy => thực hiện 
    <div class="alert alert-success"> // xuất ra thẻ div : Thêm bài viết thành công ! 
        Thêm bài viết thành công !      
    </div>
@endif


+ code vào file : app/Http/Request/post/CreatePostRequest.php 
return [
    'title' => 'required|max:500|min:10',
    'content' => 'required|min:5'
    ];

+ Đặt vấn đề : giả sử nhập vào file title ít hơn 10 kí tự hoặc content ít hơn 5 kí tự =>chỉ hiện ra The title must be at least 10 characters.
hoặc The content must be at least 5 characters. => còn nội dung ở title và content mà ta đã nhập => đã biến mất 
=> để khăc phục cái này thì Laravel có hafm old()
<input class="form-control" type="text" name="title" value="{{old('title')}}">
        <textarea class="form-control" name="content" id="content" rows="10">{{old('content')}}</textarea>
+ Hàm old() sẽ lưu lại gía trị mà ta đã nhập trước đó
=> ở bài trước có nói , value='cái gì đó' thì là hiển thị ra ở ô input (vì input là chỉ có 1 thẻ mở)
=> còn đối với thẻ có cả mở và đóng thì hiển thị ra ở giữa thẻ mở và đóng <textarea>{{old('content')}}</textarea>
=> value="{{old('title')}}" // old lưu lại giá trị title đã nhập , value hiển thị ra giá trị mà old lưu lại 
tương tự với <textarea>{{old('content')}}</textarea>

---------------------------------Hiển thị danh sách bài viết-----------------------------------------
=> Trong thư mục views/post tạo file list.blade.php => code vào đó 
@extends('layouts.master') // kết thừa khung code sẵn ở file master.blade.php trong thư mục layouts 

@section('title','Danh sách bài viết') // truyền vào nội dung đơn giản 

@section('content') // chỉ cần code thêm nội dung 

<div>
    @foreach($posts as $post) // lặp qua từng biến post trong mảng posts 
    <li><a href="{{route('post.show',['post'=>$post->id])}}">{{$post->title}}</a></li>
    @endforeach
</div>
@endsection 
{{$post->title}} thì khỏi nói rồi => xuất ra title 
=> ở bảng php artisan route:list ta thấy Name : post.show với URI là post/{post}
{{route('post.show',['post'=>$post->id])}} => 'post.show' = http://localhost:8000/post/
['post'=>$post->id] => lấy ra giá trị id của hàng dữ liệu đó 
=> kết hợp lại được http://localhost:8000/post/id 

=> Truy cập vào : Name : post.index => URI : post => http://localhost:8000/post/  hiển thị danh sách bài viết .
+ code vào file app/Http/Controllers/PostController.php : 
public function index()
    {
        $posts = Post::latest()->paginate(10); // hiển thị 10 bài viết trên một trang 
        return view('post.list')->with('posts',$posts); // chuyển đến hiển thị file list.blade.php trong thư mục post 
    } 

=> return view('post.list')->with('posts',$posts);
với biến là posts (ở trước là biến trong  @foreach($posts as $post) đến file list.blade.php)
biến truyền vào là $posts (là biến $posts = Post::latest()->paginate(10);)

---------------------------------Hiển thị Chi tiết bài viết-----------------------------------------

+ Chú ý trong bảng php artisan route:list , chi tiết trên mỗi hàng là 
Method : Hàm thuộc loại nào 
    + GET|HEAD : 
    + POST : 
    + PUT|PATCH : 
    + DELETE : 
URI : Đường dẫn 
    + post : /post                              ex : http://localhost:8000/post
    + post/create : /post/create                ex : http://localhost:8000/post/create
    + post/{post} : ví dụ như : post/id của bài viết đó : ex : http://localhost:8000/post/1 
    + post/{post}/edit ,ex : http://localhost:8000/post/1/edit
Name : => xem như là tên biến lưu giá trị URI => để truyền vào ex : {{route('post.store')}}, {{route('post.show',['post'=>$post->id])}}
Action : Tên hàm được gọi trong file đó 

=> Thì khi php artisan route:list , in bảng này ra thì ta sẽ biết, với hàm này để làm chức năng này thì link đến link nào, name của nó gì, thuộc loại method nào 
ex : post.create => chứa giá trị : post/create => ex link đến ex : http://localhost:8000/post/create 
=> Action : App\Http\Controllers\PostController@create => gọi hàm create() (hàm tạo bài viết)(giống với tên gọi của nó) 
trong file PostController.php với loại Method là : GET|HEAD => từ đó biết rõ hơn => là chủ các đường dẫn và các hàm => thao tác tốt hơn .

=> Tạo file : views/post/detail.blade.php 
vào file views/post/detail.blade.php code : 
@extends('layouts.master')

@section('title',$post->title)

@section('content')

<div>
    <h1>{{$post->title}}</h1>
    <div>{{$post->content}}</div>
</div>
@endsection 

+ vào file app/Http/Controllers/PostController.php code : 
public function show(Request $request, $id){
        // return $id;
        $post = Post::findOrFail($id);
        return view('post.detail')->with('post',$post); // truyền vào biến $post => truyền đến post/detail.blade.php là biến post (phía trước)
        => <h1>{{$post->title}}</h1> <div>{{$post->content}}</div>
    }

=> ex : nếu ->with('abc',$post); => <h1>{{$abc->title}}</h1> <div>{{$abc->content}}</div>
+ Nếu route có tham số : các tham số sẽ nằm lần lượt trong hàm controller 
    + Nằm phía sau request;
        + ex : public function show(Request $request, $id){
                   // return $id;
                   $post = Post::findOrFail($id);
                   return view('post.detail')->with('post',$post);
               }

=> Tại http://localhost:8000/post : hiển thị danh sách bài viết 
=> Click vào mỗi bài viết => Chi tiết bài viết (ex : http://localhost:8000/post/1)

+ implicit binding: 
    + Nếu như không có kiểu dữ liệu : dạng thông thường 
    + Nếu truyền kiểu dữ liệu => laravel tự động bind 
        + ex : public function show(Request $request, $id){ // trường hợp $id như thế này 
                   // return $id;
                   $post = Post::findOrFail($id);
                   return view('post.detail')->with('post',$post);
               }
               => thì laravel mặc định là số luôn => $id là một con số 
        + ex : public function show(Request $request, Post $post){ // Nếu có khai báo kiểu 
                   // return $id;
                   // $post = Post::findOrFail($id);
                   return view('post.detail')->with('post',$post);
               }
               => Laravel sẽ hiểu là $post là một Post Models 
               => Không cần thực hiện lệnh // $post = Post::findOrFail($id); này nữa 
               => Post $post là xem như đã thực hiện lệnh : $post = Post::findOrFail($id);
               => viết lại : 
               public function show(Post $post){  
                   return view('post.detail')->with('post',$post);
               }
               => http://localhost:8000/post/3 => biến $post sẽ có id là 3 luôn 
        + ex : tương tự public function show(User $user){ => lấy ra user có id cụ thể luôn 


+ Laravle 8 và laravel 7 (HAY)
    + Laravel7 :
        + Tạo một models => gõ php artisan make:model Models/Post -m 
        => Tạo cả hai file model và file migration 
    + Laravel8 : 
        + Tạo một models => gõ php artisan make:model Models/Post -m -c 
        => Tạo cả ba file model , migration và controller 
        + Ngoài ra còn tự động viết hàm cho ta luôn : ví dụ 
              public function show(Request $request, Post $post){
                  return view('post.detail')->with('post',$post);
              }
        + php artisan make:model Models/Post -m -c -v -s  
        => Tạo cả model, migration, controller, views, seeds luôn và có một số hàm thì laravel 8 tự động viết cho ta luôn 

Cơ bản thì nó vẫn thế => cứ phân tích từ từ, nắm chắc cấu trúc hoạt động giữa các file là được 
=> Cấu trúc MVC,phần này khá là hay
--------------------


Eloquent relationship:
+ Mối quan hệ giữa các model 

Nhắt lại kiến thức quan hệ (file php.html)
+ Thiết lập quan hệ : 
        + 1-1 : Thiết lập trực tiếp id của hai bảng 
        + 1-n : Tạo thêm trường cho bảng ở phía n (ex : nhiều bài viết thuộc một chuyên mục thì tạo thêm trường category_id ở bảng articles)
        + n-n : Tạo bảng phụ 

Bảng dữ liệu trong database 
1-n : 
+ Một danh mục thì có nhiều bài viết 
+ Một bài viết thì trong 1 danh mục 
=> quan hệ 1-n 
+ categories
    + id,name 
+ article
    + id,category_id, title, content 

1-1 : 
1 User thì có 1 số điện thoại 
1 số điện thoại thì => 1 user 
=> 1-1 

n-n : 
+ 1 sản phẩm thì có thể trong nhiều danh mục 
+ 1 danh mục thì có nhiều sản phầm 
=> quan hệ n-n  

=> bảng phụ 
+ products 
    + id,name 
+ categories 
    + id,name 
+ products_category 
    + id, product_id, category_id 

Như đã biết các Model cũng giống như các bảng dữ liệu ở database 
Tạo các model cho các bảng, và quan hệ giữa các model (Eloquent relationship)
1-n : 
+ Một danh mục thì có nhiều bài viết 
+ Một bài viết thì trong 1 danh mục 
=> quan hệ 1-n 
+ categories : model Category 
    + id,name 
+ article : model Article 
    + id,category_id, title, content 

(dùng Post model cũng được vì nó cũng chứa các bài viết => khỏi cần tạo Article model)
tạo thêm model Category để thực hành 
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel5>php artisan make:model Models/Category -m
Model created successfully. (tạo model thành công)
Created Migration: 2021_09_11_193451_create_categories_table
=> Ta thấy laravel cực kì là ok , ta tạo Post model => thì có file Post.php (số ít) và file migration là 2021_09_10_193312_create_posts_table.php (số nhiều)
=> ta tạo file Category model => có file Category.php và file migration 2021_09_11_193451_create_categories_table (categories : đặt tên file rất là hợp lí)

+ code file 2021_09_11_193451_create_categories_table.php : 
Schema::create('categories', function (Blueprint $table) {
    $table->id();
    $table->string('name');
    $table->timestamps();
});

+ code thêm vào file 2021_09_10_193312_create_posts_table.php : 
Schema::create('posts', function (Blueprint $table) {
    $table->id();
    $table->string('title');
    $table->text('content');
    $table->text('category_id')->nullable();     // chú ý phải đặt chính xác như thế này laravel mới nhận 
    $table->timestamps();
});
// như đã nói ở trên => tạo file model ,... => laravel đặt tên cũng khá là thông minh và theo quy tắc 
=> tốt hơn hết là nên đặc theo quy tắc 
=> cũng có cách đặt không theo quy tắc nhưng đặt theo quy tắc thì dễ hơn 
$table->text('category_id')->nullable(); liên kết với trường id của bảng : category
(một danh mục có nhiều bài viết)

code xong thì tiến hành xóa hết rồi tạo lại để cho có thêm các cột và các bảng mới : 
(chú ý : như đã nói ở những bài trước php artisan migrate:refresh => dữ liệu vẫn bị xóa hết)
=> có xuất một bảng posts_project.sql => để nếu sau này có thực hành thì nhập vào lại là được  
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel5>php artisan migrate:refresh

Cách tạo mối quan hệ: 
+ 1-n 
    + Model cha : hasMany('tên model con')
    + model con : belongsTo('tên model cha')
    + ex : 
        + file Category.php : 
          public function posts(){
              return $this->hasMany('App\Models\Post');         // model cha có nhiều model con, model con là App\Post model 
          }
        + file Post.php 
          public function category(){
              return $this->belongsTo('App\Models\Category')    // model con có một model cha, model cha là App\Category model 
          }
    + Thêm vào posts : id = 1 ,title ='bài viết 1' , content='nội dung 1', category_id = 1    (thuộc chuyên mục 'xa hoi')
                       id = 2 ,title ='bài viết 1' , content='nội dung 1', category_id = 1    (thuộc chuyên mục 'xa hoi')
    thêm vài categories : id=1, name ='xa hoi' . id=2 , name'chinh tri'
    vào file detail.blade.php code thêm : <h1>{{$post->category->name}}</h1> // Từ thằng con có thể trỏ đến thằng cha
    + Từ thằng con có thể trỏ đến thằng cha
    + Từ thằng cha có thể trỏ xuống thằng con 
=> Hiển thị ra các bài viết thuộc chuyên mục 'xa hoi' : 
    + vào file PostController.php code thêm : 
    use App\Models\Category;
    public function showCategoryPost(Category $category){ // implicit binding: 
        return view('post.category')->with('category',$category);
    }
    + vào file web.php code thêm route : 
    Route::get('/category/{category}','PostController@showCategoryPost');  // /category/{category} = category/id 
    + Tạo file views/post/category.blade.php  code vào file đó : 
        @extends('layouts.master')
        @section('title',$category->name)
        @section('content')
        <div>
            <h2>Các bài viết thuộc chuyên mục : {{$category->name}}</h2>
            @foreach($category->posts as $post)
            <li><a href="{{route('post.show',['post'=>$post->id])}}">{{$post->title}}</a></li>
            @endforeach
        </div>
        @endsection 
    + Vào http://localhost:8000/category/1 => hiển thị tất cả các bài viết thuộc chuyên mục 1 , chuyên mục 'xa hoi'

+ Giải thích thêm (hay): 
    + file controller 
        + return view('post.category')->with('category',$category); (1)
            + $category là biến hiện có của file controller 
            + category => là tên của biến với giá trị = $category được sử dụng tại file views 
    + file model 
        + public function posts(){
              return $this->hasMany('App\Models\Post');        
          }
          => tên hàm posts() sẽ được sử dụng tại views 
    + file views 
        + => Thu được : $category->posts as $post
            + $category là 'category' trong dòng (1) của file controller 
            + ->posts : là gọi hàm posts của file model 
            + $post là biến tự tạo (tùy ý) để dùng tại file views 
    ex : return view('post.category')->with('abc',$category); (controller)
         public function xyz(){
              return $this->hasMany('App\Models\Post');        (model)
          }
          => $abc->xyz as $bienviews 
    
=> ' ' trong with của file controller sẽ là tên biến tại file views 
    Tên hàm tại file model sẽ là tên hàm tại file views 
    
    ex : file controller : return view('post.detail')->with('post',$post); (1)
         file model      : public function category(){ (2)
                               return $this->belongsTo('App\Models\Category');
                           }
          file views     : <h1>{{$post->category->name}}</h1>
              + $post : là 'post' tại (1)
              + ->category : là hàm category() tại (2)



+ n-n 
    + Model 1 : belongsToMany('tên model 2')
    + Model 2 : belongsToMany('tên model 1')

=> Một bài viết thì có nhiều tag , một tag thì có nhiều bài viết 
=> Bảng posts quan hệ nhiều-nhiều với bảng tag , ta có Post model rồi , tạo ra Tag model 
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel5>php artisan make:model Models\Tag -m
Model created successfully. (tạo Tag model thành công)
Created Migration: 2021_09_12_093227_create_tags_table

+ Tạo bảng phụ : 
    + Chú ý : posts 
              tags 
    => Đặt post_tag thì laravel mới hiểu được (chú ý cách đặt tên cho đúng)
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel5>php artisan make:migration createPostTagsTable
Created Migration: 2021_09_12_093901_create_post_tag_table
+ Code vào file 2021_09_12_093901_create_post_tag_table.php để tạo các cột 
            $table->integer('post_id');
            $table->integer('tag_id');
+ Code vào file 2021_09_12_093227_create_tags_table.php để tạo các cột 
            $table->string('name');

+ Code vào file Tag.php 
    public function posts(){ // posts là số nhiều để sau này ở file views : $tag->posts ($tag sẽ là 'tag' ở trong with() ở trong controller)
            return $this->belongsTo('App\Models\Post');
        }
+ Code vào file Post.php 
    public function tags(){  // tags là số nhiều để sau này ở file views : $post->tags ($post sẽ là 'post' ở trong with() ở trong controller)
            return $this->belongsToMany('App\Models\Tag');
        }
=> Thật ra như đã nói ở trên đặt tên hàm gì cx đc , đặc kiểu gì thì ở file views dùng tên đấy thôi  
chỉ là đặt kiểu này => thì ta sẽ hiểu là : $tag->posts (một tag thì có nhiều post), tương tự $post->tags (một post thì có nhều tag)

code xong thì tiến hành xóa hết rồi tạo lại để cho có thêm các cột và các bảng mới : 
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel5>php artisan make:migration createPostTagsTable
Created Migration: 2021_09_12_093901_create_post_tag_table 
(chú ý : như đã nói ở những bài trước php artisan migrate:refresh => dữ liệu vẫn bị xóa hết)

+ vào file resources/views/post/detail.blade.php (chi tiết bài viết)
Tag:
    @foreach($post->tags as $tag)
        {{$tag->name}}
    @endforeach

=> mỗi bài viết sẽ có nhiều tag , mỗi tag sẽ có nhiều bài viết 
giả sử 
bảng : categories : id : 1 , name : xa hoi 
bảng : post : id 1 , title : bài 1 , content : nội dung 1 
              id 2 , title : bài 2 , content : nội dung 2 
bảng : tag : id : 1 , name : gioi tre  
             id : 2 , name : hiphop   
bảng post_tag : id : 1 , post_id : 1 , tag_id : 1
                id : 2 , post_id : 1 , tag_id : 2
=> vào http://localhost:8000/post/1 sẽ thấy : bài 1 thuộc tag : gioi tre và hiphop 

+ n-n 
    + Cách 1 : Phải đặt chính xác 
        + Model 1 : belongsToMany('tên model 2')
        + Model 2 : belongsToMany('tên model 1')
        + ex : 
        + file Tag.php : 
          public function posts(){  
            return $this->belongsTo('App\Models\Post');
        }
        + file Post.php 
          public function tags(){   
            return $this->belongsToMany('App\Models\Tag');
        }
        => ta có bảng posts , bảng tags => CHÚ Ý : tên bảng phụ phải là : post_tag (phải chính xác như thế này)
        php artisan make:model Tag -m
        php artisan make:model Post -m
        => (database/migrations/2021_09_10_193312_create_posts_table.php)   
        => (database/migrations/2021_09_12_093227_create_tags_table.php)
        php artisan make:migration createPostTagTable
        => (database/migrations/2021_09_12_093901_create_post_tag_table.php)

    + Cách 2 : Đặt tùy ý 
        + Model 1 : belongsToMany('tên model 2','tên_bảng_phụ')
        + Model 2 : belongsToMany('tên model 1','tên_bảng_phụ')
        + Tên bảng phụ là tùy ý : ex : 
        php artisan make:migration createvanmanhproTable => bảng phụ : vanmanhpro
        => (database/migrations/2021_09_12_093901_create_vanmanhpro_table.php)
        Thì phải 
        + file Tag.php : 
          public function posts(){  
            return $this->belongsTo('App\Models\Post','vanmanhpro');
        }
        + file Post.php 
          public function tags(){   
            return $this->belongsToMany('App\Models\Tag','vanmanhpro');
        }
    => tùy vào cách đặt, cách nào cũng được nhưng cách 2 có vẽ an toàn hơn 

+ 1-1 
    + ít khi dùng , vì nếu 1-1 thì dùng chung một bảng luôn hoặc id của bảng này liên kết với id của bảng kia 
    + model 1: hasOne('tên model 2')
    + model 2: hasOne('tên model 1')


(video44)
 

copy laravel5 sang laravel6 
tạo database : tintuc44 => nhập file tintuc43.sql bữa trước vào (htdocs/tintuc43.sql)

.env 
DB_CONNECTION=mysql
DB_HOST=localhost
DB_PORT=3306
DB_DATABASE=tintuc44
DB_USERNAME=root
DB_PASSWORD=

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel6> php artisan serve
=> chạy lại serve 

+ vào file : app/Http/Controllers/PostController.php 

+ Laravel sẽ tự động tạo ra property nếu có relationship (nếu có mối quan hệ giữa các model)
$post->category->name 
=> tốn thêm một lần query 
select * from posts where id = 1
select * from categories where id = category_id 
=> 2 lần query 

+ Eagle loading (xem video sẽ dễ hiểu hơn)
(Tìm hiểu Eagle loading để tối ưu hơn tốc độ chạy của web khi đọc database)
Lấy ra 1 bài viết và tên chuyên mục của nó 
select * from post,category where posts.id = 1 and category.id = posts.id 
select * from posts where id =1 left join categories = posts.id  

tức là thay vì : 
public function show(Post $post){
        return view('post.detail')->with('post',$post);
    }

thì ta viết : 
public function show($id) (1)
    {
        $post = Post::whereId($id)->with('category')->firstOrFail();
        return view('post.detail')->with('post',$post);
    }
$id ở (1) là id của bài viết 
ở file resources/views/post/detail.blade.php
có : @foreach($post->tags as $tag)
        {{$tag->name}}
    @endforeach
=> có gọi đến tags => ta có thể viết sẵn luôn để tăng tốc độ đọc 
public function show($id) 
    {
        $post = Post::whereId($id)->with('category')->with('tags')->firstOrFail();
        return view('post.detail')->with('post',$post);
    }

+ Eagle loading : Nhằm mục đích tăng tốc độ đọc, nếu viết theo cách cũ vẫn được
=> Để load nhanh hơn nữa => viết sẵn ra các trường bảng bảng luôn 
ex : 
 @foreach($post->tags as $tag) , tags là bảng ta cần load rồi
        {{$tag->name}}    => đến name là trường ta cần load 
    @endforeach
public function show($id) 
    {
        $post = Post::whereId($id)->with('category:id,name')->with('tags:id,name')->firstOrFail(); (3)
        return view('post.detail')->with('post',$post);
    }

(3) => viết thêm các trường vao phía sau dấu : ->with('tags:id,name')
ex : nếu abc là bảng cần load , trong bảng đó có các trường a1,a2,a3 => thì ta ghi 
->with('abc:a1,a2,a3') 
+ Chú ý : phải ghi là : ->with('tags:id,name') , không được ghi ->with('tags: id,name') (cách ra là không được)

+ Custom Eager loading 

 // lấy ra tag đầu tiên 
        $firstTag = $post->tags->first(); // cách 1
        // select * from tags where id = posts.id => đọc tất cả mới nhặt ra 1 cái 
        $firstTag = $post->tags()->first();// cách 2  // nhanh hơn , đọc 1 phát là 1 cái luôn 
        // select * from tags where id = posts.id limit 1 

        // cũng phải tùy từng trường hợp mà viết theo cách 1 hay cách 2 
        /* Giống như fb , một bài viết thì chỉ load vài comment thôi , nếu muốn xem nhiều hơn => bấm xem thêm => lúc này mới load ra nhiều hơn để xem , còn nếu mà ban đầu load hết luôn thì serve sẽ mệt*/

=> tìm hiểu các bài về Eagle loading để tham khảo thêm (Eagle loading, tăng tốc Eloquent model)

+ Contrain query : 
thay vì $post = Post::whereId($id)->with('category:id,name')->with('tags:id,name')->firstOrFail();
ex : $post = Post::whereId($id)
                 ->with('category:id,name')
                 ->with('tags' => function($query){
                     return $query->orderBy('create_at')->limit(5);
                 })
                 ->firstOrFail();

+ Hàm Load 
nên viết như thế này : 
public function showCategoryPost( Category $category){
    $category->load('comments');
    return view('post.category')->with('category',$category);
}
thay vì viết như thế này 
public function showCategoryPost($id){
    $category = Category::whereId($id)
                          ->with('comments')
                          ->first();
    return view('post.category')->with('category',$category);
}




Model Morph (polymorphic relation): (Dùng cực kỳ nhiều)(học kỹ)
    + morphTo,morphMany
    + ex : file Comment.php (quan hệ đến nhiều model khác)
                function commentable(){      
                    return $this->morphTo();
                }
           file Post.php,Category.php (những file có quan hệ với file Comment.php)
                public function comments(){
                    return $this->morphMany('App\Models\Comment','commentable');
                }

+ 1 model quan hệ đến nhiều model khác 
    + ex : một bảng comment 
        + comment vào bài viết (post)
        + comment vào hình ảnh (image)
        + comment vào video (video)
        + comment vào comment => reply (trả lời)

        + ex : thay vì tạo thêm các bảng phụ và các trường post_id, video_id, image_id,...

    => thì ta tạo bảng comments : 
        + id 
        + content
        + target_type : // post , video , image 
        + target_id :  

            ex : id : 1
                 content : xin chao 
                 target_type : video 
                 target_id : 3
                 => comment vào video có id là 3 
            ex : id : 1
                 content : xin chao 
                 target_type : post 
                 target_id : 2
                      => comment vào post có id là 2  
     
=> Laravel cũng hỗ trợ luôn

=> comment mọi thứ 

comment vào bài viết, comment vào category 

posts:id ,content, title 
categories: id, name 
comments: 
    id 
    content 
    commentable_id      => integer    (số => để integer)
    commentable_type    => string     (type nên để string)

Tạo Comment model và migration 
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel6>php artisan make:model Models\omment -m
Model created successfully.
Created Migration: 2021_09_13_110058_create_comments_table

+ code vào 2021_09_13_110058_create_comments_table.php để tạo các cột 
Schema::create('comments', function (Blueprint $table) {
    $table->id();
    $table->text('content');
    $table->integer('commentable_id');      // chú ý phải viết chính xác như thế này => [tên_bảng]able_... 
    $table->string('commentable_type');     // chú ý phải viết chính xác như thế này => [tên_bảng]able_...
    $table->timestamps();
});

+ code vào file Comment.php 
protected $fillable = ['content'];
function commentable(){      (1)
    return $this->morphTo();
}
+ code vào file Post.php 
public function comments(){
    return $this->morphMany('App\Models\Comment','commentable'); (2)
}
+ code vào file Category.php 
public function comments(){
    return $this->morphMany('App\Models\Comment','commentable');  (3)
}
=> commentable ở (2) và (3) là từ (1) mà ra , là tên hàm trong file Comment.php  model 

+ lưu vào posts tạo một hàng dữ liệu : id : 1,title : bai 1, content : noi dung 1, (category_id : 1 , cái này điền thêm cho có thôi)
+ Giống như kiến thức về đổ dữ liệu xuống database , thử đổ bằng tay dữ liệu xuống database , cụ thể là 
lưu một hàng dữ liệu vào bảng comments, content : 'comment 1'  
(những việc lưu này chỉ là bước phụ để kiểm tra xem Model Morph (polymorphic relation) hoặc động như thế nào thôi)
=> để lưu dữ liệu vào bảng comments như đã học => vào model Comment code : protected $fillable = ['content'];
+ và code vào hàm index() trong file PostController.php
$post = Post::whereId(1)->first()->comments()->insert([
    'content' => 'comment 1'
]);

=> đến database vào bảng comments 
=> id : 1,content: 'comment 1',commentable_id : 1,commentable_type : App\Models\Post ,...
=> tức là comment này có id :1 , nội dung là : comment 1, là comment của (comment vào): App\Models\Post, comment vào Post có id : 1 (commentable_id : 1)

+ code thêm vào hàm show của file app/Http/Controllers/PostController.php : ->with('comments')
public function show($id)  
=>  {
        $post = Post::whereId($id)
                ->with('category:id,name')
                ->with(['tags' => function($query){
                    return $query->orderByDesc('created_at')->limit(1);

                }])
                ->with('comments')  // có mối quan hệ rồi thì cứ viết vào thoải mái, cái nào hiển thị ra ở .blade.php mà viết vào đây thì càng tăng tốc độ đọc 
                ->firstOrFail();
        return view('post.detail')->with('post',$post);
    }

+ code thêm vào file : resources/views/post/detail.blade.php để hiển thị ra các comment 
<div>
Comments:
@foreach($post->comments as $comment)
    {{$comment->content}}
@endforeach
</div>

=> http://localhost:8000/post/1 (xem chi tiết bài viết 1)
=> 
bai 1 (title bài viết 1)
xa hoi (chuyên mục bài viết 1)
Tag: gioi tre (tag)
noi dung 1 (content bài viết 1)
Comments: comment 1 comment 1 (comment vào bài viết 1)

+ comment cho category chuyên mục
$category = Category::find(1);
$category->comments()->create([
    'content' => 'đây là comment chuyên mục'
]);

=> vào http://localhost:8000/post => bấm request để tạo comment (hoặc enter gì cũng được)
=> vào database bảng comments có thêm :  
=> id : 3,content: 'đây là comment chuyên mục',commentable_id : 1,commentable_type : App\Models\Category ,...
nghĩa là comment có id : 3 , comment vào App\Models\Category , Category có id là 1 
(chú ý, mỗi lần reuquest là mỗi lần chạy file => tạo thêm dữ liệu)


+ hiển thị các comment của category 
+ code thêm vào hàm showCategoryPost trong file app/Http/Controllers/PostController.php 
public function showCategoryPost(/* Category $category */ $id){
    $category = Category::whereId($id)
                          ->with('comments')
                          ->first();
    return view('post.category')->with('category',$category);
}
+ code thêm vào file resources/views/post/category.blade.php
<div>
    @foreach($category->comments as $comment)
    {{$comment->content}}
    @endforeach
</div>


HomePageItems: 

home_page_items: 
    id 
    home_page_itemable_id 
    home_page_itemable_type  ,...

Model Morph (polymorphic relation): (Dùng cực kỳ nhiều)(học kỹ)

+ 1 model quan hệ đến nhiều model khác 
    + ex : một bảng comment 
        + comment vào bài viết (post)
        + comment vào hình ảnh (image)
        + comment vào video (video)
        + comment vào comment => reply (trả lời)

Giống như đã nói và lấy ví dụ ở trên, khi mà một model quan hệ đến nhiều model khác => nên dùng Model Morph (polymorphic relation)
Một cái bảng chung chung , nhưng ví dụ trường hợp này chỉ cần hai cột đơn giản thì ta đã lưu được dữ liệu thay vì tạo thêm nhiều bảng nhiều cột nữa.
Một bảng comments lưu được coment của nhiều loại, post,image,video,category,...
Sau này cứ không phải quan hệ 1-1,1-n,n-n, mà cần lưu dữ liệu của một model quan hệ đến nhiều model khác => thì dùng Model Morph (polymorphic relation)
Sau này ứng dụng và dùng cái này cực kì nhiều,code cũng khá là đơn giản.

+ code reply comment (comment của comment)(tương tự như trên)
=> trả lời nhiều cấp vẫn được 

(lâu nay ta thường Model A => Model B . Thật tế Model A => Model A vẫn được)

+ code vào file app/Models/Comment.php
function reply(){
    return $this->morphMany('App\Models\Comment','commentable');
}

=> comment vào comment 

+ Code menu đa cấp : 
Model : Menu 
    + id 
    + text 
    + parrent_id => mullable (lấy ra những thằng null,bởi vì null là những id gốc, không có thằng cha)
    + link 

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel6>php artisan make:model Models/Menu
Model created successfully. (tạo Menu model thành công)
+ code vào file : 
class Menu extends Model
{
    //
    public function children(){
        return $this->hasMany('App\Models\Menu');
    }

    public function parrentMenu(){
        return $this->belongsTo('App\Models\Menu','parrent_id');
    }
}

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel6>php artisan make:controller MenuController
Controller created successfully. (tạo MenuController thành công)

+ code vào file app/Http/Controllers/MenuController.php : 
public function getAllMenu(){
    $allMenu = Menu::whereNull('parrent_id')
                    ->with(['children' => function($query){
                        return $query->with('children');
                    }])
                    ->get();
}

.....

+ getAttribute (Dùng nhiều)
    + xử lí một property của model trước khi trả về (chạy qua một function trước khi trả về)
    + public function get[tên_thuộc_tính]Attribute   (chú ý phải ghi chính xác như thế này mới được)
    + ex : vào file Post.php (App\Models\Post) code 
    public function getTitleAttribute($value){  // xử lí title của một bài viết trước khi trả về
        return 'abc '.$value;
    }
    => http://localhost:8000/post/1 => xem hết quả : abc bai 1
    (trước khi đọc model(database) ra => đi qua hàm get... đã rồi mới xuất ra ở client)

    + ex : Bảng lưu các ảnh : 
        + id :
        + path : ta không được lưu kểu : http://laptrinhcuocsong.com/image/user/1.jpg
        mà chỉ lưu : image/user/1.jpg => bởi vì sau này nhỡ có chuyển server => thì vẫn chạy ok 
        (giống như trang phimmoi.net => bị repost thì chỉ cần đổi domain(miền) => là được, ráp domain vào là vẫn chạy ok, không cần sửa gì cả)
        (hoặc từ http sang https thôi cũng sửa mệt)


(video45)

copy laravel6 -> laravel7 
tạo database : tintuc45 -> nhập vào file htdocs/tintuc44.sql 

DB_CONNECTION=mysql
DB_HOST=localhost
DB_PORT=3306
DB_DATABASE=tintuc45
DB_USERNAME=root
DB_PASSWORD=


+ Collection (hay) :
    + Mảng: array, (Collection giống như array nhưng là array đặt biệt)
    + Có nhiều thao tác, nhiều hàm mà một array bình thường không có
        + ex : vào file app/Http/Controllers/PostController.php 
            + $posts = Post::latest()->paginate(10); => hiển thị 10 bài viết 1 lần trên page 
            biến $posts như những bài trước ta đã nói nó là một array chứa các phần tử là các object, mỗi object là một hàng dữ liệu ở database, array như một bảng dữ liệu. Chính xác thì đây là một Collection (đặc biệc hơn array)
            + dd($posts) sẽ hiển thị ra => tất cả các thuộc tính của nó.
            + $posts = Post::latest()->first(); => Một Eloquent query (query xuống database của một Eloquent)
            + $posts = Post::latest()->get()->first(); => Một Collection  

    + Các hàm thường dùng của Collection: vào đọc ở https://laravel.com/docs/8.x/collections, còn rất nhiều hàm kèm ví dụ dễ hiểu 
        + sort : Nếu như mà Collection chứa toàn số, hay chữ thì dùng sort => nó sẽ tự động sắp xếp 
        + sortBy :
            + Nếu như Collection chứa trong là các array hay object thì dùng sortBy
            + sắp xếp các phần tử theo một key nào đó theo chiều Tăng dần 
            + ex : $collection = collect([
                       ['name' => 'Desk', 'price' => 200],
                       ['name' => 'Chair', 'price' => 100],
                       ['name' => 'Bookcase', 'price' => 150],
                   ]);
                   $sorted = $collection->sortBy('price'); // sắp xếp theo key price (giá)
        + sortByDesc : sắp xếp theo chiều Giảm dần 
        + Split : tách 
            + ex : $collection = collect([1, 2, 3, 4, 5]);
                   $groups = $collection->split(3); // tách làm 3 nhóm 
                   $groups->all();
                   // [[1, 2], [3, 4], [5]]
        + max : số lớn nhất 
        + min : số nhỏ nhất 
        + toArray : chuyển từ Collection sang array (ít dùng)
        + unique : loại bỏ các phần tử trùng nhau 
            + ex : $collection = collect([1, 1, 2, 2, 3, 4, 2]);
                   $unique = $collection->unique();
                   $unique->values()->all();
                   // [1, 2, 3, 4]
        + every : (giống js)
            + tất cả đều
            + một cái sai là false 
            + tất cả đều đúng là true 
            + ex : collect([1, 2, 3, 4])->every(function ($value, $key) {
                       return $value > 2;
                   });
                   // false
        + fillter : hàm lọc (giống js)
        + take : 
            + Lấy ra một số phần tử
            + ex : $collection = collect([0, 1, 2, 3, 4, 5]);
                   $chunk = $collection->take(3);
                   $chunk->all();
                   // [0, 1, 2] 
            + phân biệt giữa hai hàm take 
                + take(10) : ở video42 là take() để tạo ra một câu lệnh query để đọc dữ liệu từ database
                + take() : bài này là take() mà sau khi đẫ đọc dữ liệu (query xuống database) rồi thì => lấy ra một số phần tử nào đó 
        + pluck : 
            + chỉ lấy ra một số key nhất định 
            + ex : $collection = collect([
                    ['product_id' => 'prod-100', 'name' => 'Desk'],
                    ['product_id' => 'prod-200', 'name' => 'Chair'],
                ]);
                $plucked = $collection->pluck('name');
                $plucked->all();
                // ['Desk', 'Chair']
        + pop : giống js 
        + sum : tính tổng cái gì đấy 
        + avg : tính trung bình cái gì đấy 
        + shuffle : sắp xếp ngẫu nhiên 

    Ngoài ra còn rất nhiều hàm, vào đọc ở https://laravel.com/docs/8.x/collections, còn rất nhiều hàm kèm ví dụ dễ hiểu


+ Validation : 
    + Tạo ra cái Request rồi viết các luật vào rules()
    + request không hợp lệ trả về các message 
        + nằm trong phần resources (js,lang,sass,views)
        + ex : ở file : resources/views/post/create.blade.php 
            @foreach ($errors->all() as $error)
                <div class="alert alert-danger">{{ $error }}</div>
            @endforeach 
        => trả về (hiển thị) lỗi nếu request không hợp lệ 
    + resources/lang/en : có các file chứa các lỗi 
        + resources/lang/en/validation.php là một trong những file chứa các lỗi 
            + ex : vào file resources/lang/en/validation.php => tìm đến 'required' => 'The :attribute field is required.',
            => sửa thành => 'required' => 'The :attribute field is requiredssssssss.',
            + ở file app/Http/Requests/post/CreatePostRequest.php ta có ghi các luật 
            => return [
                   'title' => 'required|max:500|min:10',   // ít nhất 10 kí tự 
                   'content' => 'required|min:5'           // ít nhất 5 kí tự 
               ];
            => vào http://localhost:8000/post/create nếu nhập sai luật => báo lỗi 
                + The title field is required.
                + The content field is required.
            => Thì sau khi mà ta sửa rồi thì => nó sẽ báo là : 
                + The title field is requiredssssssss.
                + The content field is requiredssssssss.
    + /lang/en : tức là báo lỗi là tiếng anh (mặc định của laravel là báo lỗi bằng tiếng anh)
    + /lang/vi : 
        + copy thư mục en => paste vào thư mục lang => rename lại thành : vi (tức là tiếng việt)
        + vì laravel mặc định báo lỗi bằng tiếng anh (en) => muốn báo lỗi thành tiếng việt => chỉnh lại 
            + 'locale' => 'en',  => 'locale' => 'vi',
            + 'fallback_locale' => 'en',  
                + Để mặc định là 'fallback_locale' => 'en', để nếu như khi mà dịch bảng tiếng việt (vi) 
                  nếu tìm không ra câu lỗi đó bằng tiếng việt => báo lỗi đó bằng tiếng anh
        Vừa mới sửa file config => nên chạy lại để cập nhật lại cache
        C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel7>php artisan config:cache
        Configuration cache cleared!
        Configuration cached successfully!
        => tiếp tục lấy ví dụ với câu đó vào file resources/lang/vi/validation.php: 
        lúc này sửa 'required' => 'The :attribute field is requiredssssssss.',
        thành 'required' => 'Trường :attribute là bắt buộc.',
        => vào http://localhost:8000/post/create nếu nhập sai luật => báo lỗi Trường title là bắt buộc.
        (còn title chưa đổi => sửa tiếp)

        + hoặc ta có thể vào file : app/Http/Request/post/CreatePostRequest.php 
        chú ý dòng class CreatePostRequest extends FormRequest 
            + nếu dùng sublime text, khi di chuột đến từ FormRequest => thì nó hiện ra link (lúc có lúc không) đến file => click vào link đó 
            + nếu dùng vs code thì => nhấn giữ ctrl + di chuột đến từ FormRequest => enter 
            => file FormRequest hiện ra => đọc file , thấy có những hàm nào kiểu kiểu để trống như thế,máy tạo ra mà không viết gì thì tức là dành cho mình 
            (không riêng gì file FormRequest, bất kể file gì cũng vậy, cứ thấy trống trống => dành cho mình)
        + => thấy có hàm : public function messages(){
                               return [];
                           }
             copy => paste vào file app/Http/Request/post/CreatePostRequest.php 
             code thêm : public function messages(){            // chú ý tên hàm phải chính xác như thế  này mới được 
                             return [
                                 'title.required' => 'Chỗ này bắt buộc nhập ! :attribute',             //Chỗ này bắt buộc nhập ! title
                                 'content.required' => 'Bạn xinh đẹp ơi bạn quên chưa nhập :attribute' //Bạn xinh đẹp ơi bạn quên chưa nhập content
                             ];
                         }
            => tại dòng 'title.required' thì :attribute chính là title 
            => tại dòng 'content.required' thì :attribute chính là content 
        + => sửa title, content : public function attributes(){
                                      return [
                                          'title' => 'Tiêu đề',
                                          'content' => 'Nội dung'
                                      ];
                                  }
                        => Chỗ này bắt buộc nhập ! Tiêu đề
                        => Bạn xinh đẹp ơi bạn quên chưa nhập Nội dung

    + Ta có thể thấy , Php Laravel hoạt động đúng theo kiểu xử lí từng phần . Ex một file bị lỗi hay bug gì thì những phần còn lại vẫn chạy bình thường, nó không ảnh hưởng hết toàn serve, ex chức năng post/create bị lỗi nhưng chức năng post/edit ,... không bị lỗi thì vẫn còn hoạt động được. Trái lại một số ngôn ngữ khác như Nodejs thì một phần bị lỗi => toàn khối sẽ không hoạt động . Từ đó Php dễ dàng fix bug hơn nếu có lỗi . Laravel sẽ báo cho ta lỗi ở file nào, dòng mấy.
    Php thì chạy song song,còn Nodejs thì chạy đồng lọat.

+ Rules() : Các luật trong rules()
    + Cách ghi : (dùng | hoặc viết vào mảng) nếu dùng | thì không được dùng mảng (chỉ viết theo một loại)
        + return [
              'title' => 'required|max:500|min:10',
              'content' => 'required|min:5'
          ];
        + return [
              'title' => [
              'required',
              'max:500',
              'min:10'],

              'content' => 'required|min:5'
          ];
        + ngoài ra còn một số cách khác

    + required : bắt buộc 
    + max:100 => tối đa 100 kí tự 
    + min:10 => tối thiểu 10 kí tự 
    + email => bắt buộc email phải hợp lệ 
    + integer => bắt buộc là phải số nguyên 
    + alpha => [a-z][0-9] : bắt buộc phải là những kí tự thuộc từ a-z , 0-9 
    + alpha_dash => [a-z][0-9] : bắt buộc phải là những kí tự thuộc từ a-z , 0-9 , dấu gạch dưới 
    + number => là số (int,float,...)
    + string => là chuỗi 
    + in:nam,nu  => bắt buộc giá trị nhập vào phải là nam hoặc nu 
        + in:hn,dn,hcm => ...
        + ex :'title' => 'required|max:500|in:dn,hn,hcm', => bắt buộc phải nhập vào một trong 3 từ : hn,dn,hcm
        + Chú ý : viết các luật phải cho hợp lí , không được phủ định lẫn nhau : ex : 'title' => 'required|max:500|in:dn,hn,hcm|min:10',
            + in:dn,hn,hcm => bắt buộc phải là một trong 3 từ dn,hn,hcm 
            + min:10 => ít nhất 10 kí tự 
            => nhập kiểu nào cũng không hợp lệ .
    + unique:[table],[column] : (dùng rất nhiều) không được đặt giống nhau (không được giống nhau)(nếu trong column đã tồn tại giá trị đó => không được cho vào nữa)
        + ex : 'title' => 'required|max:500|unique:posts,title', 
        => ở trong cột(trường) title của bảng posts (ở database) có các title như thế rồi thì không được đặt trùng lại nữa 
        ví dụ đã có title : 'bai 1' => nếu đặt tiếp, nhập vào là 'bai 1' => lỗi 
        + user name không được giống nhau 
        + email không được giống nhau 
        + id không được giống nhau 
        + ,...
    + array => bắt buộc nhập vào một mảng  
    + ends with  
    + url => bắt buộc phải là đường dẫn 
    + image => bắt buộc phải là một ảnh 
    + nullable  
    + confirmed : 
        + dùng trong gõ lại password,nhập lại password cho chính xác 
        + ex : file .blade.php 
                   <input type="password" name="pw">              // ...
                   <input type="password" name="pw_confirmation"> // bắt buộc phải chính xác như thế này ..._confirmation
               viết vào rules()
               'pw' => '...'
               'pw_confirmation' => 'confirmed'
    + date 
    ,...
    + Ngoài ra còn rất nhiều luật nữa => vào https://laravel.com/docs/8.x/validation#available-validation-rules (Available Validation Rules) để đọc thêm 
    + Thật ra cũng chỉ cần nhớ mấy cái hay dùng thôi, đến lúc đi làm thật thì cứ vào trang chủ của laravel mà search la có . 
    Kể cả Bootstrap hay Vuejs hay Laravel ,... gì cũng vậy, nhớ những cái chính => đến khi thiếu thì cứ search => thiếu cứ search chứ không thể một lần học hết document của nó được . Vào trang chủ của framework đó là có hướng dẫn chi tiết đầy đủ ví dụ hết.  

+ Custom rules()
    + Tự viết một hàm để check
        + ex : 'title' => ['required','max:500','in:dn,hn,hcm','unique:posts,title',
                  function($attribute,$value){
                    echo $attribute.$value;
                  }
               ],

    + php artisan make:rule [tên_file]
        + C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel7>php artisan make:rule CauVanHoa
         Rule created successfully.
         => app/Rules/CauVanHoa.php được tạo ra 

        + code vào file : app/Http/Request/post/CreatePostRequest.php : 
            use App\Rules\CauVanHoa; //App\Rules là namespace, còn CauVanHoa là tên class (nhắc lại:chú ý phải viết chính xác như này,không được viết thường tùy ý)
            public function rules(){
                return [
                      'title' => [
                        'required',
                        'max:500',
                        'unique:posts,title',
                        'min:10',
                        new CauVanHoa() // gọi trực tiếp class đó luôn, không cần tạo thêm biến 
                      ],
                      'content' => 'required|min:5'
                  ];
            }
        (Nhắt lại => bất cứ cái gì trong laravel cũng vậy => có namespace => ở file nào nếu muốn dùng class của một file khác thì cứ use [namespace]\[tên class])
        ex : use App\Rules\CauVanHoa; => lúc này ta có thể tùy ý sử dụng class trong file đó như là class đang ở trong file mình dùng
        ('title' => ['required','max:500','unique:posts,title','min:10',new CauVanHoa()],)

            + trong file app/Rules/CauVanHoa.php
                + nếu ở hàm passes() mà return true => pass 
                + nếu ở hàm passes() mà return false => gọi hàm message()
                    => in ra câu lệnh báo lỗi trong hàm message() ex : return 'The validation error message.';
                    => ta có thể sửa lại kiểu như : return 'Bạn phải viết một câu văn hóa !'
                + code tạo hàm duyệt từ văn hóa : 
                    => code vào trong public function passes($attribute, $value)
                    public function passes($attribute, $value){
                        if(strpos($value, 'dit') !== false){ // hàm strpos là kiểm tra trong chuỗi có đoạn text ('dit') đó hay không 
                            return false;   
                        }
                        return true;
                    }

                => chú ý : khi đã use App\Rules\CauVanHoa;  => dùng file CauVanHoa.php 
                    trong file đã có hàm public function message() => thì trong file app/Http/Request/post/CreatePostRequest.php không được có hàm message()

            + khi mà vào http://localhost:8000/post/create => tạo một bài viết, mà có title có chữ vô văn hóa ('dit') => return false 
            => gọi hàm message() để thông báo lỗi => Bạn phải viết một câu văn hóa !
    + B1: tạo file php artisan make:rule [tên_file]
      B2: viết check vào hàm public function passes($attribute, $value) trong file Rules vừa tạo 
      B3: use App\Rules\[tên_class]; (thường thì máy sẽ tạo cho tên class giống tên file, nhưng không quan trọng, mình chỉ quan trọng tên class)
          gọi trực tiếp class đó vào thuộc tính mà mình muốn thiết lập luật 'title' => ['required','max:500','unique:posts,title','min:10',new CauVanHoa()],
          (lúc này $value trong passes($attribute, $value) sẽ được chuyển title vào để kiểm tra)


+ Auth và Middleware (quan trọng)
    + Authentication: đăng kí/đăng nhập (Laravel đã có hệ thống đăng kí đăng nhập sẵn cho chúng ta)
        (trước đó ta đã biết laravel đã tạo sẵn những migraton cho ta: bảng users,password_resets,failed_jobs)
        + laravel/ui :  gói để tạo ra các views,js,css
            C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel7>composer require laravel/ui:^2.4
            ... => Package manifest generated successfully. (tạo gói thành công)
        + php artisan ui vue --auth (nếu dùng react thì php artisan ui react --auth)
            C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel7> php artisan ui vue --auth
            Vue scaffolding installed successfully.
            Please run "npm install && npm run dev" to compile your fresh scaffolding.
            Authentication scaffolding generated successfully.
            => Trong thư mục resources/js/ xuất hiện thư mục components có file ExampleComponent.vue (vue framework)
            (resources/js/components/ExampleComponent.vue)
            => các file resources/js/components/app.js ,resources/js/components/bootstrap.js 
            => xuất hiện thư mục resources/views/auth và thư mục resources/views/auth/passwords , trong auth và passwords chứa một loạt file .blade.php
            (auth/login.blade.php,register,verify) (passwords/confirm.blade.php,email,reset) 
            => xuất hiện file và thư mục : resources/views/layouts/app/blade.php 
            => xuất hiện file : resources/views/home.blade.php 
            => xuât hiện thư mục app/Http/Controllers/Auth/ và một loạt file controller  
            => xuất hiện file app/Http/Controllers/HomeController.php 
        Ngoài ra còn nhiều file khác ,...
        trong file web.php cũng có thêm dòng code : 
            Auth::routes(); 
            Route::get('/home', 'HomeController@index')->name('home');
            => vào http://localhost:8000/login sẽ hiện ra form đăng kí/đăng nhập
            .... còn nhiều link khác nữa 
            http://localhost:8000/register
            http://localhost:8000/password/reset
            ,...
            do Auth::routes(); => tự động tạo ra các route cho ta 
            => vào http://localhost:8000/register tạo một tài khoản 
            => vào bảng users ở database : tintuc45 => thì sẽ có thông tin ở đó 
            (nhắc lại đối với password => không lưu mật khẩu luôn mà => lưu một chuỗi từ mật khẩu gen ra (generate)(phát ra) khi mà đăng nhập mà serve check đúng chuỗi này thì mới được)
        C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel7>npm install 
        => cũng cài vào file package.json framework Vue đầy đủ 
        C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel7>npm run prod

        Giả sử vào để tạo bài viết => phải đăng nhập 
        + code vào web.php 
            Route::get('/post/create','PostController@create')->middleware('auth');
            Route::post('/post/store','PostController@store')->name('post.store');
        => muốn vào http://localhost:8000/post/create tạo bài viết => phải vào http://localhost:8000/login để đăng nhập đã 
    + Custom hệ thống đăng kí,đăng nhập 
            + Đăng kí bằng username (email)
            + Thêm field khác : số điện thoại, địa chỉ 
            + Đăng kí bằng mạng xã hội OAuth2 : (google, facebook)
        + Đăng nhập : đăng nhập bằng mạng xã hội 
        + Sử dụng Authentication trong vuejs 
    + Middleware : 
        + Giống như một hàng rào 
        + ex : trong một web của ta có rất nhiều phần giả sử A,B,C,D,E,...
        ta có thể tạo Middleware cho bất cứ thứ gì , giả sử tạo Middleware cho A,B,C ; tạo Middleware cho C,D,E
        tạo Middleware cho A,B,F ,...
            + Một Middleware có thể bao bọc nhiều thành phần 
            + Một thành phần có thể nằm trong nhiều Middleware
            ex : như trên : Route::get('/post/create','PostController@create')->middleware('auth'); 
            => tạo Middleware bao bọc create (tạo bài viết) bằng ->middleware('auth'); (bắt buộc phải đăng nhập)
            + ex : có thể bọc và viết logic bất cứ thứ gì chứ không riêng gì là đăng nhập 
        + Tạo middleware : 
            + php artisan make:middleware [tên_file]
              C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel7>php artisan make:middleware BlockIpMiddleware
              Middleware created successfully.
              => thêm file trong thư mục app/Http/Middleware/BlockIpMiddleware.php
        + Đăng kí middleware : 
            + app\Http\Kernel.php 
                + Kernel là file được gọi đầu tiên 
            + vào file app\Http\Kernel.php , tại protected $routeMiddleware = [
              thêm vào : 'blockIp' => \App\Http\Middleware\BlockIpMiddleware::class,
              // thật ra như này cũng được //'blockIp' => '\App\Http\Middleware\BlockIpMiddleware'  
              blockIp là tên của middleware mà ta tự đặt 
              App\Http\Middleware\ là namespace của file middleware đó , BlockIpMiddleware là tên class trong file đó 
        + Dùng middleware 
            + Vào web.php -> cho vào route và ta cần middleware
              ex : Route::get('/abc','xyz...')->middleware('blockIp');
            + Nếu như một route dùng nhiều middleware => thì viết theo kiểu mảng 
              ex : Route::get('/post/create','PostController@create')->middleware(['auth','blockIp']);
              => để vào được /post/create thì phải pass qua hai middleware : auth và blockIp
        + Trong file Middleware có : 
            + public function handle($request, Closure $next){
                 return $next($request);
             }
            + nếu trong handle() mà return false => không pass qua được 
            + code vào : if($_SERVER['REMOTE_ADDR'] == '127.0.0.1'){
                             return $next($request);
                         }
                         abort(403,'Access denied'); 
        + Các tham số: 
            + ở file : web.php : Route::get('/post/create','PostController@create')->middleware(['auth','blockIp:manh,20']); 
              tham số được truyền vào sau dấu ":" 
            + ở file middleware : app/Http/Middleware/BlockIpMiddleware.php
              public function handle($request, Closure $next,$name)
              sau $request, Closure $next là tên biến tương ứng với gía trị truyền vào 
              => $name = manh 
                public function handle($request, Closure $next,$name,$age){
                    echo $name.' '.$age; // manh 20
                    return $next($request);
                }

Hệ thống 2 role : admin và user (admin có quyền khác, user có quyền khác)
    + vào database/migrations/2014_10_12_000000_create_users_table.php để code thêm để tạo thêm cột (trường role) : $table->string('role')->default('user');
    C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel7>php artisan migrate:refresh
    => xóa hết để tạo lại để thêm cột 
    => vào http://localhost:8000/register để tạo tài khoản 
    => trong bảng users tất tài khoản được tạo ra điều sẽ có mặc định là role : user (vì $table->string('role')->default('user');)
    + C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel7>php artisan make:middleware RoleMiddleware
      Middleware created successfully. (tạo một file middleware thành công)
    + code vào file app\Http\Kernel.php : để đăng kí cho middleware RoleMiddleware
      'role' => \App\Http\Middleware\RoleMiddleware::class,
    + code vào file web.php 
       Route::get('/post/create','PostController@create')->middleware(['auth','role:admin']);
       => bọc /post/create bằng middleware : role với tham số truyền vào là admin 
    + code vào file : app/Http/Middleware/RoleMiddleware.php
        public function handle($request, Closure $next,$role){  // $role = admin (được truyền vào từ file web.php)
            if(auth()->user()->role == $role){  // trong bảng users thì những tài khoản có role = admin thì mới pass được 
                return $next($request);
            }
            abort(403,'access denied'); 
        }
        // vì tất cả tài khoản được tạo ra ta để mặc định là role:user => nên không pass qua được 
        // chỉ những tài khoản nào được ta vào database sửa role : user thành role : admin thì mới pass qua được rồi mới vào /post/create để tạo bài viết được 
    
    + vào http://localhost:8000/register để tạo một tài khoảng bất kì 
    + vào http://localhost:8000/login để đăng nhập 
    + vào http://localhost:8000/post/create để tạo bài viết thì không được bởi vì role của tài khoản này là user , mà muốn pass qua được thì phải là admin 
    + vào bảng users trong database : tintuc45 => đổi role của tài khoản này thành admin 
    + đăng xuất và vào http://localhost:8000/login để đăng nhập lại rồi vào vào http://localhost:8000/post/create để tạo bài viết thì được 
    + giả sử tạo thêm một tài khoản nữa => đăng nhập vào thì tất nhiên là không được (vì mặc định tài khoản được tạo là role:user)
    => trả về là 403 | access denied
    + Thiết lập kiểu này để chỉ có những tài khoản nào ta muốn là admin thì là admin còn không thì tất cả đều là user , admin sẽ có những quyền hạn mà user không có.
      abort trong function handle() thì ta có thể in ra những thông báo mà ta tự ghi cũng được ví dụ : 
      + public function handle($request, Closure $next,$role){   
            if(auth()->user()->role == $role){   
                return $next($request);
            }
            abort(403,'Bạn không có quyền truy cập ! ');  // Phải viết chính xác là lỗi 403, còn chuỗi sau thì truyền vào gì cũng được 
        }

    + Ta cũng có thể truyền nhiều tham số vào middleware : 
        + Cách 1 : viết tiếp : file web.php : Route::get('/post/create','PostController@create')->middleware(['auth','role:admin,user']);
        + Cách 2 : viết rời  : Route::get('/post/create','PostController@create')->middleware(['auth','role:admin','role:user']);
    + Ta cũng có thể lấy toàn bộ giá trị được truyền vào bằng : ... (kiến thức cũ, ... : là lượt qua tất cả) một cách nhanh nhất 
        + file app/Http/Middleware/RoleMiddleware.php
        + public function handle($request, Closure $next, ...$roles){ // lấy tất cả giá trị truyền vào => lưu vào biến $roles 
            dd($roles);  // là một mảng chứa những giá trị được truyền vào 
            foreach ($roles as $role){
                if(auth()->user()->role == $role){
                    return $next($request);
                }
            }
            abort(403,'Bạn không có quyền truy cập ! ');
        }

        ex : truyền vào nhiều biến nữa Route::get('/post/create','PostController@create')->middleware(['auth','role:admin,user,useraccept,uservip,accounter']);


(video46)

Tạo mới Database : auth 
Tạo mới project : laravelAuth
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel>composer create-project --prefer-dist laravel/laravel:^7.0 laravelAuth
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>composer require laravel/ui:^2.4
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>php artisan ui vue --auth
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>npm install
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>npm run prod 

    + Custom hệ thông đăng kí, đăng nhập 
        + Đăng kí bằng username (email)
        + Thêm field khác : số điện thoại, địa chỉ 
        + Đăng kí bằng mạng xã hội (google, facebook)
    + Đăng nhập : đăng nhập bằng mạng xã hội 
    + Sử dụng Authentication trong vuejs 

+ code vào file database/migrations/2014_10_12_000000_create_users_table.php để sửa bảng 
    $table->string('phone');
    $table->string('address');

.env 
DB_CONNECTION=mysql
DB_HOST=localhost
DB_PORT=3306
DB_DATABASE=auth
DB_USERNAME=root
DB_PASSWORD=

Vừa mới sửa file config (.env) nên cập nhật lại cache 
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>php artisan config:cache
Configuration cache cleared!

Tạo bảng 
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>php artisan migrate
Migration table created successfully.

Sửa lại đăng nhập bằng username : 
+ app/Http/Controllers/Auth/RegisterController.php  
    protected $redirectTo = RouteServiceProvider::HOME; : sau khi tạo tài khoản xong thì tự động nhảy đến trang home
    http://localhost:8000/home  

Sửa lại những thông tin cần đăng kí theo ý mình : 
    class RegisterController extends Controller
    {
        use RegistersUsers;   : đang dùng trait RegistersUsers (kiểu class con extends class cha và dùng trait)
        (đọc lại extends class, interface, trait)
    
    protected function validator(array $data){                   // Hàm ghi các luật khi tạo một tài khoản 
        return Validator::make($data, [
            'name' => ['required', 'string', 'max:255'],
            'username' => ['required', 'alpha', 'string', 'max:30', 'unique:users'],
            'phone' => ['required', 'max:15'],
            'address' => ['required'],
            'password' => ['required', 'string', 'min:8', 'confirmed'],
        ]);
    }

    protected function create(array $data)                        // tạo tài khoản khi pass qua được validator()
    {
        return User::create([
            'name' => $data['name'],
            'username' => $data['username'],
            'phone' => $data['phone'],
            'address' => $data['address'],
            'password' => Hash::make($data['password']),
        ]);
    }

+ Đăng kí bằng username (email)
+ Thêm field khác : số điện thoại, địa chỉ 

+ resources/views/auth/register.blade.php sửa lại phần hiển thị khi đăng kí ở client 
                        <div class="form-group row"> + Sửa email thành username
                            <label for="username" class="col-md-4 col-form-label text-md-right">{{ __('Username') }}</label>

                            <div class="col-md-6">
                                <input id="username" type="text" class="form-control @error('username') is-invalid @enderror" name="username" value="{{ old('username') }}" required autocomplete="username">

                                @error('username')
                                    <span class="invalid-feedback" role="alert">
                                        <strong>{{ $message }}</strong>
                                    </span>
                                @enderror
                            </div>
                        </div>

                        <div class="form-group row"> + Copy ra rồi thay username thành phone (thêm input phone)
                            <label for="phone" class="col-md-4 col-form-label text-md-right">{{ __('Phone') }}</label>

                            <div class="col-md-6">
                                <input id="phone" type="text" class="form-control @error('phone') is-invalid @enderror" name="phone" value="{{ old('phone') }}" required autocomplete="phone">

                                @error('phone')
                                    <span class="invalid-feedback" role="alert">
                                        <strong>{{ $message }}</strong>
                                    </span>
                                @enderror
                            </div>
                        </div>

                        <div class="form-group row"> + Copy ra rồi thay username thành address (thêm input address)
                            <label for="address" class="col-md-4 col-form-label text-md-right">{{ __('Address') }}</label>

                            <div class="col-md-6">
                                <input id="address" type="text" class="form-control @error('address') is-invalid @enderror" name="address" value="{{ old('address') }}" required autocomplete="address">

                                @error('address')
                                    <span class="invalid-feedback" role="alert">
                                        <strong>{{ $message }}</strong>
                                    </span>
                                @enderror
                            </div>
                        </div>

__('E-Mail Address') : __() : là hàm kiểm tra trong ngôn ngữ có E-Mail Address hay không, nếu không thì tự động dịch ra 

Cứ khi nào mà thấy lỗi này : 
Illuminate\Database\QueryException
SQLSTATE[HY000]: General error: 1364 Field 'username' doesn't have a default value (SQL: insert into `users` (`name`, `password`, `updated_at`, `created_at`) values (Nguyễn Văn Mạnh, $2y$10$J0M6CcyJrKid4FT3n.8mcu1IlxGuEXZJnhFpq4Ru2a1c7ioqH60eK, 2021-09-16 01:36:43, 2021-09-16 01:36:43))
http://localhost:8000/register
Hoặc là : lỗi ở migration thiếu ->defaultable(),... mấy hàm quy định kiểu của cột trường (trong bảng)
Hoặc là : lỗi ở model 

+ app/User.php 
=> code thêm : 
    protected $fillable = [
        'name', 'username','phone','address','password',
    ];
   => fix xong (thành công)


+ resources/views/auth/login.blade.php sửa lại phần hiển thị khi đăng nhập ở client
                        <div class="form-group row"> => Sửa email thành username
                            <label for="username" class="col-md-4 col-form-label text-md-right">{{ __('Username') }}</label>

                            <div class="col-md-6">
                                <input id="username" type="text" class="form-control @error('username') is-invalid @enderror" name="username" value="{{ old('username') }}" required autocomplete="username" autofocus>

                                @error('username')
                                    <span class="invalid-feedback" role="alert">
                                        <strong>{{ $message }}</strong>
                                    </span>
                                @enderror
                            </div>
                        </div>

+ app/Http/Controllers/Auth/LoginController.php  
    + use Illuminate\Foundation\Auth\AuthenticatesUsers; : nhấn ctrl + click vào AuthenticatesUsers để mở file AuthenticatesUsers.php (bằng vscode)
    (hiện ra của sổ nhỏ với đường dẫn file ở trên => nhìn vào đó để biết đường dẫn của file => nếu muốn mở bằng sublime text => theo đường dẫn đó mà mở, nếu mà muốn mở rộng cửa sổ như đang hiển thị một file => click vào đường dẫn đó.)
    laravel > laravelAuth > vendor > laravel > ui > auth-backend > AuthenticatesUsers.php > {}AuthenticatesUsers
    (thường những file kiểu như AuthenticatesUsers.php sẽ nằm trong thư mục vendor)

+ Trong file AuthenticatesUsers.php có 
/**
     * Get the login username to be used by the controller.
     *
     * @return string
     */
    public function username()
    {
        return 'email';
    }

=> những hàm kiểu này => laravel cố ý viết ra như thế này để ta overide(ghi đè) 
Nhắt lại kiến thức php: 
+ overide : 
        + ghi đè
        + overide một hàm ghi trong trait 
        + Không thể overide constructor , destructor 
        + Gọi contructor cha : parent::__construct()

+ copy đoạn đó rồi paste vào cuối cùng trong class LoginController extends Controller file app/Http/Controllers/Auth/LoginController.php  
 /**
     * Get the login username to be used by the controller.
     *
     * @return string
     */
    public function username()
    {
        return 'username';   // sau khi paste vào rồi thì sửa lại thành : return 'username';
    }
}

Đặt vấn đề : tại sao không sửa thẳng vào file AuthenticatesUsers.php mà lại phải ghi đè vào file LoginController.php rồi với sửa lại 
=> bơi vì , file AuthenticatesUsers.php nằm trong thư mục vendor , mà thư mục vendor như đã nói từ trước, nó không quan trọng, khi mà ta cài composer install thì mọi thứ sẽ bị mất (vì thư mục vendor sẽ được tạo ra lại dựa trên file composer.json & composer.lock)

laravel > laravelAuth > vendor > laravel > ui > auth-backend > AuthenticatesUsers.php
    /**
     * Get the needed authorization credentials from the request.
     *
     * @param  \Illuminate\Http\Request  $request
     * @return array
     */
protected function credentials(Request $request)    // thông tin xác thật, định nghĩa chúng ta đăng nhập bằng cái gì, truyền vào biến $request 
{  
    return $request->only($this->username(), 'password');// như đã học,only là hàm chỉ lấy ra những thông tin từ $request mà ta cần : $this->username() và password
}

+ Thật ra thay vì overide(ghi đè) đoạn code phía trên thì ta overide đoạn code này cũng được 

/**
     * Get the needed authorization credentials from the request.
     *
     * @param  \Illuminate\Http\Request  $request
     * @return array
     */
    protected function credentials(Request $request)
    {
        return $request->only($this->username(), 'password'); 
    }

sau đó sửa thành 

/**
     * Get the needed authorization credentials from the request.
     *
     * @param  \Illuminate\Http\Request  $request
     * @return array
     */
    protected function credentials(Request $request)
    {
        return $request->only('username','password');   /// lấy ra username, password để xác thực 
    }

laravel > laravelAuth > vendor > laravel > ui > auth-backend > AuthenticatesUsers.php 

/**
     * The user has been authenticated.                
     *
     * @param  \Illuminate\Http\Request  $request
     * @param  mixed  $user
     * @return mixed
     */
    protected function authenticated(Request $request, $user)       // sau khi đã đăng nhập thì làm cái gì đấy 
    {
        // như đã nói những hàm trống kiểu này laravel có tình tạo ra rồi để trống như này để ta viết code vào 
    } 



OAuth2 : 
+ Đăng kí bằng mạng xã hội (google, facebook)

package.json 
webpack.mix.js 

Đặt vấn đề : 
update web:
Khi vào web lần đầu => tải các file js, css => cache 
Sửa code js =>nếu người dùng => không f5 => vẫn dùng cache cũ 
=> khi nào update web thì người dùng cũng phải được update mới 
trong file webpack.mix.js có 
mix.js('resources/js/app.js', 'public/js')
    .sass('resources/sass/app.scss', 'public/css');

=> sửa thành : 
mix.js('resources/js/app.js', 'public/js').version();
mix.sass('resources/sass/app.scss', 'public/css').version();

vào resources/views/layouts/app.blade.php sửa 
    <!-- Scripts -->
    <script src="{{ asset('js/app.js') }}" defer></script>

    <!-- Fonts -->
    <link rel="dns-prefetch" href="//fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css?family=Nunito" rel="stylesheet">

    <!-- Styles -->
    <link href="{{ asset('css/app.css') }}" rel="stylesheet">

thành 
    <!-- Scripts -->
    <script src="{{ mix('js/app.js') }}" defer></script>

    <!-- Fonts -->
    <link rel="dns-prefetch" href="//fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css?family=Nunito" rel="stylesheet">

    <!-- Styles -->
    <link href="{{ mix('css/app.css') }}" rel="stylesheet">

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>npm run prod
=> (đặc biệt sau khi mà sửa file webpack.mix.js với câu lệnh này có một thông báo đẩy laravel gửi về cho mình là đã mix : Laravel Mix Build successful)
=> lúc này người dùng không nhấn f5 vẫn tải mới lại 
(Một project nào cũng nên làm những thứ này,cũng nên chỉnh chỉnh lại mấy cái này)
(1:01:56 - 1:03:56) xem dễ hiểu hơn giải thích 

Trên là đăng nhập bằng Laravel : 
Ta cũng có Đăng nhập bằng Vuejs : search Laravel Authentication Vuejs 

+ Đăng kí/Đăng nhập : đăng kí/đăng nhập bằng mạng xã hội : Laravel Socialite

ta đang dùng laravel version 7 => vào laravel sersion 7 để lấy lệnh Laravel Socialite
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>composer require laravel/socialite

Socialite chỉ là những cái chung chung thôi 
Socialite Providers : Là những cái cụ thể 
click vào Socialite Providers => https://socialiteproviders.com/ => Get Started → 
Đăng nhập bằng một loạt, đủ thứ : Social / Platform, Apple, Auth0, Dailymotion, Deviantart, Dribbble, Facebook, Flattr, Flickr, Foursquare, Gitea, GitHub, GitLab, Google, Imgur, Instagram, Instagram Basic, Kakao, Keycloak, LaravelPassport, Line, Medium, Meetup, Microsoft, Microsoft Azure, Naver, OAuthgen, Odnoklassniki, Okta, Pinterest, Pixnet, Pushbullet, QQ, Reddit, Snapchat, StackExchange, Steem, SURFconext, Telegram, TikTok, Tumblr, Twitter, Vimeo, VK, WeChat Service Account, WeChat Web, Weibo, Weixin, Weixin Web, WordPress, Yahoo, Yammer, Yandex, YouTube, Zalo, Gaming, Battlenet, Discord, Eveonline, ProjectV, Smashcast, Steam, StreamElements, Streamlabs, Twitch, Education / Career, Acclaim, Coursera, Dataporten, AppNet, Goodreads, HeadHunter, MoiKrug, SciStarter, StockTwits, Xing, Productivity / Business, Asana, Atlassian, Aweber, Bitly, Bitbucket, Box, Buffer, CampaignMonitor, Cheddar, ConstantContact, DigitalOcean, Disqus, Dropbox, Envato, Etsy, Eventbrite, EyeEm, GettyImages, Gitee, Harvest, Heroku, HubSpot, Human API, Intercom, LinkedIn, MailChimp, Mailru, MakerLog, Mattermost, MercadoLibre, Netlify, Notion, OSChina, OVH, Pipedrive, Podio, Procore, ProductHunt, QuickBooks, Readability, Sage, SalesForce, SharePoint, Shopify, SuperOffice, Teamleader, Teamweek, Todoist, Trello, Unsplash, Vercel, VersionOne, WHMCS, Zendesk, Zoho, Zoom, Government / University, ClaveUnica, FranceConnect, IFSP, UCL, Payments, Binance, Coinbase, Gumroad, MediaCube, Mollie, Monzo, Patreon, Paymill, PayPal, PayPalSandbox, Redbooth, Stripe, Venmo, Xero, Music, Deezer, Discogs, Mixcloud, SoundCloud, Spotify, Misc, Admitad, AngelList, ArcGIS, Douban, Fablabs, Fitbit, Flexkids, GarminConnect, PeeringDB, RunKeeper, Saml2, Strava, Trakt, TVShowTime, Uber, Untappd, Withings, Deprecated 

Muốn cài cái nào thì click vào cái đó rồi làm theo document hướng dẫn thôi : 
(Cái gì cũng vậy cứ đọc document rồi làm theo thôi)
=> Thử cài đăng nhập bằng google => click vào google => composer require socialiteproviders/google
=> C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>composer require socialiteproviders/google

thêm đoạn code sau vào config/services.php
'google' => [    
  'client_id' => env('GOOGLE_CLIENT_ID'),  
  'client_secret' => env('GOOGLE_CLIENT_SECRET'),  
  'redirect' => env('GOOGLE_REDIRECT_URI')    // thật ra đây là lấy từ file .env ( env() )
],

sau đó ta có thể thêm vào cuối file .env 
GOOGLE_CLIENT_ID= 
GOOGLE_CLIENT_SECRET= 
GOOGLE_REDIRECT_URI= 

thêm đoạn code sau vào protected $listen = [ trong file : app/Providers/EventServiceProvider.php 
protected $listen = [
    \SocialiteProviders\Manager\SocialiteWasCalled::class => [
        // ... other providers
        'SocialiteProviders\\Google\\GoogleExtendSocialite@handle',
    ],
];

ta được : 
protected $listen = [
    Registered::class => [
        SendEmailVerificationNotification::class,
    ],
    \SocialiteProviders\Manager\SocialiteWasCalled::class => [
    // ... other providers
    'SocialiteProviders\\Google\\GoogleExtendSocialite@handle',
    ],
];

// sau này có thêm facebook hay githup gì thì cứ thêm thêm vào thôi     

vào https://developers.google.com/
vào search : google developer console
(nói thêm https://console.cloud.google.com/projectselector2/apis/dashboard?hl=en&pli=1&supportedpurview=project, muốn dùng tiếng anh tài trang này thì để hl=en)
(còn muốn dùng tiếng việt thì hl=vi : https://console.cloud.google.com/projectselector2/apis/dashboard?hl=vi&pli=1&supportedpurview=project)

Tại cửa sổ chính => Dashboard => create project => tại project name: dangnhapgoogle => create 
=> Credentials (hình chìa khóa) => + CREATE CREDENTIALS => OAuth client ID => CONFIGURE CONSENT SCREEN => External (danh cho nhiều người truy cập website)
(Internal : chỉ dành cho một tổ chức dùng domain (miền) đó thôi) 
=> CREATE 
=> App name : Dang nhap Fullstack 5 
=> User support email * : nguyenvanmanh2001it1@gmail.com
=> Developer contact information Email addresses * : nguyenvanmanh2001it1@gmail.com
(Lưu ý cái nào không nhắt tới thì bỏ qua)
=> save and continue
=> tại bước 2 (Scopes) la muốn lấy thông tin gì từ user (kiểu như giới tính,.. chẳng hạn)
=> nếu có thì bấm vào => Add or remove scopes (mình không lấy => không click)
=> save and continue 
=> save and continue => Xong 
=> back to dashboard 
(=> Credentials (hình chìa khóa) => API key => close bỏ bước này)
=> Credentials (hình chìa khóa) => + CREATE CREDENTIALS => OAuth client ID => tại ô (Application type *) ta có thể chọn một trong các loại 
Web application, Android, Chrome app, iOS, TVs and Limited Input devices, Desktop app, Universal Windows Platform (UWP)
=> ta chọn Web application => tại Name : Nhập Web-fullstack-5 => CREATE
Your client ID : 779842371071-gn56d5d8o7l8blerqn3nb75v3vnhsbqf.apps.googleusercontent.com
Your Client Secret : YSVd1Sm_tIFsmsf5lp1YISs_
=> OK 

+ .env 
paste Your client ID vào GOOGLE_CLIENT_ID=
paste Your Client Secret vào GOOGLE_CLIENT_SECRET=
còn GOOGLE_REDIRECT_URI thì ghi URI vào
ta được 
GOOGLE_CLIENT_ID=779842371071-gn56d5d8o7l8blerqn3nb75v3vnhsbqf.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=YSVd1Sm_tIFsmsf5lp1YISs_
GOOGLE_REDIRECT_URI=http://localhost:8000/social-login/google // sau khi đăng nhập bằng Google xong thì nhảy về trang này 

Cập nhật lại cache 
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>php artisan config:cache
Configuration cache cleared!
Configuration cached successfully!

Vào => Credentials (hình chìa khóa) tại OAuth 2.0 Client IDs click vào Web-fullstack-5 
(tạo link đăng nhập)
tại Authorized redirect URIs => + ADD URI => Nhập : http://localhost:8000/social-login/google (GOOGLE_REDIRECT_URI) => save

Tạo SocialLoginController.php controller để xử lí đăng nhập 
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>php artisan make:controller Auth/SocialLoginController
Controller created successfully.

+ code vào file app/Http/Controllers/Auth/SocialLoginController.php : 
use Laravel\Socialite\Facades\Socialite;
class SocialLoginController extends Controller{
    function redirectToGoogle(){
        return Socialite::driver('google')->redirect(); // copy trên document (cứ làm theo document thôi)
    }
}

+ code vào file web.php để thêm route 

Route::get('/login/google',function(){ // nếu viết function ở đây thì đỡ phải tạo hàm bên file app/Http/Controllers/Auth/SocialLoginController.php
    return Socialite::driver('google')->redirect();
})

còn không thì ở đây chỉ cần tạo route rồi viết hàm bên file kia sau đó gọi hàm 
Route::get('/login/google','Auth\SocialLoginController@redirectToGoogle');

Vào : http://localhost:8000/login/google => enter => https://accounts.google.com/o/oauth2/auth/..... => hiện ra bảng với những tài khoảng google trên máy .
Server sẽ hỏi Chọn tài khoản để tiếp tục tới Dang nhap Fullstack 5 
(vào /login/google => gọi hàm redirectToGoogle() của file Auth\SocialLoginController.php rồi thực hiện hàm đó)

=> sau khi click chọn một tài khoản nào đó => hoàn tất quá trình đăng nhập => nhảy đến link (GOOGLE_REDIRECT_URI) như đã nói ở trên 
=> đến http://localhost:8000/social-login/google

+ code vào file web.php : Route::get('/social-login/google','Auth\SocialLoginController@processLoginGoogle');

+ code vào file app/Http/Controllers/Auth/SocialLoginController.php : 
    public function processLoginGoogle(){
         $googleUser = Socialite::driver('google')->user();
         dd($googleUser); // in ra thông tin biến $googleUser
    }


=> Vào : http://localhost:8000/social-login/google => hiện ra bảng với những tài khoảng google trên máy .
(khi vào /social-login/google thì gọi hàm processLoginGoogle của file Auth\SocialLoginController.php)
Server sẽ hỏi Chọn tài khoản để tiếp tục tới Dang nhap Fullstack 5 
=> chọn bất kì một tài khoản tùy ý => vào bên trong thấy hiển thị ra thông tin biến : $googleUser (dd($googleUser);)

Biến $googleUser sẽ có các thông tin sau : (khi mà in ra được thông tin biến $googleUser => tức là đã tồn tại biến $googleUser => tức là đã cho phép)
SocialiteProviders\Manager\OAuth2\User {#309 ▼
  +accessTokenResponseBody: array:5 [▶]
  +token: "ya29.a0ARrdaM-xKeV5PcY0W6KdLyDOmSrEd3hLnYhpoP2jFUdoTn6eKHhZq6SaJIN2Qyr-Unn7bvD9I5AQMhI-4zoykMepTiJ38L9l5nzTZwRBG4v8MkzMOl88mXLXryBzNc-RZu7imizWp3HmZJo99nXGprAAE ▶"
  +refreshToken: null
  +expiresIn: 3599
  +id: "109722727162244891904"
  +nickname: "Mạnh Nguyễn Văn"
  +name: "Mạnh Nguyễn Văn"
  +email: "nguyenvanmanh2001it1@gmail.com"
  +avatar: "https://lh3.googleusercontent.com/a-/AOh14GgUpfc5-iXpVMiIHVO8p_HCj896iJdaLR0Yo6l7=s96-c"
  +user: array:8 [▶]
}

(click vào các mũi tên => xem thông tin đầy đủ hơn)
(đã paste ở ghichu 2 nếu xem thì kéo xuống ghichu 2)

Tất cả thông tin trên đều là những thông tin thật hết : 
ví dụ : +avatar: "https://lh3.googleusercontent.com/a-/AOh14GgUpfc5-iXpVMiIHVO8p_HCj896iJdaLR0Yo6l7=s96-c"
=> paste vào google https://lh3.googleusercontent.com/a-/AOh14GgUpfc5-iXpVMiIHVO8p_HCj896iJdaLR0Yo6l7=s96-c 
=> sẽ hiện ra ảnh đại diện của tài khoản google của mình 

=> Điều này càng khẳng định rằng, nếu ta đăng nhập tài khoảng của mình vào một nơi nào đó => hoàn toàn hộ đã có một hoặc nhiều thông tin của ta 

(Tóm tắt Route::get('/login/google','Auth\SocialLoginController@redirectToGoogle');
=> vào http://localhost:8000/login/google => gọi và thực hiện hàm redirectToGoogle() của file Auth\SocialLoginController.php rồi làm cái gì đấy
sau khi đăng nhập thành công bằng Google : GOOGLE_REDIRECT_URI=http://localhost:8000/social-login/google 
=> chuyển đến link http://localhost:8000/social-login/google 
=> Route::get('/social-login/google','Auth\SocialLoginController@processLoginGoogle');)
khi đến link http://localhost:8000/social-login/google => gọi hàm processLoginGoogle() của file Auth\SocialLoginController.php 


+ code vào file app/Http/Controllers/Auth/SocialLoginController.php :
    public function processLoginGoogle(){
        $googleUser = Socialite::driver('google')->user(); 
        dd($googleUser); // như đã nói ở trên nếu in ra được biến user thì tức là đã cho phép 
        // dùng if để kiểm tra 
        if($googleUser){  // kiểm tra $googleUser có tồn tại hay chưa (đã được cho phép hay chưa) nếu rồi ($googleUser có tồn tại)(truthy)
        // thì thực hiện những câu lệnh trong if 
            // => Đăng nhập trên hệ thống của mình 
            // tài khoản google của user mới lần đầu tiên đăng nhập trên hệ thống (tức là chưa có trong bảng database : users) => đăng ký cho nó  
            // nếu tài khoản google đã từng đăng nhập trên hệ thống (đã có data ở bảng user) => đăng nhập  
            // trong thông tin của user đăng nhập vào như đã in ra phía trên dd($googleUser); biến $googleUser sẽ có chứa google_id 
            // để biết nó có trên hệ thống hay chưa => tìm bằng google_id, => tạo thêm cột google_id để lưu id của tài khoản google mà người dùng đăng nhập 
            // nếu check mà id đó có trong bảng database rồi thì là đã có trên hệ thống còn nếu không thì không có trên hệ thống 

        }
        else{
            // ngược lại nếu $googleUser chưa tồn tại(không cho phép hoạt gì đấy) => thì thực hiện câu lệnh trong else, quay trở về trang chủ hoạt làm gì đấy ,...
        }
    }

+ code thêm vào file database/migrations/2014_10_12_000000_create_users_table.php để thêm cột google_id vào bảng users 
            $table->string('google_id')->nullable();

+ xóa tạo lại 
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>php artisan migrate:refresh

Đăng nhập bằng google 

+ code vào file app/Http/Controllers/Auth/SocialLoginController.php : 

use App\User;   // => dùng model User.php (dùng bảng database users)
public function processLoginGoogle(){
    $googleUser = Socialite::driver('google')->user();
    if(!$googleUser){ // ban đầu luôn nếu khác $googleUser => tức là falsy => return => kết thúc hàm  
        return ;
    }
    // dd($googleUser);
    // còn nếu tiếp tục được => tức là không return => tức là $googleUser đã tồn tại (tức là đã cho phép) => thực hiện tiếp  
    // khi mà đã cho phép rồi => đã có biến $googleUser => lấy id của biến 
    $systemUser = User::where('google_id',$googleUser->id)->first(); // gọi xuống bảng users sau đó lấy ra giá trị của trường google_id
    //lưu giá kết quả đầu tiên của việc tìm kiếm $googleUser->id (id của biến đó trong model User (trong database users)) 
    // nếu có => đăng nhập luôn 
    if(!$systemUser){ // nếu không => $systemUser không lưu được gì cả => $systemUser = falsy => !$systemUser = truthy => thực hiện câu lệnh trong if 
    // câu lệnh trong if => thực hiện thêm dữ liệu,thông của user mới vào bảng database users 
        $systemUser = User::create([
            'name' => $googleUser->name,
            'username' => 'gg_'.$googleUser->id,
            'email' => $googleUser->email,
        ]);
    }
    // đến cuối hàm, đấy đây chắc chắn ta đã có biến $systemUser vì (nếu tìm kiếm trong data có thì là có, mà tìm kiếm trong data không có thì câu lệnh if cũng thực hiện tạo biến $systemUser)
}

+ code thêm vào file database/migrations/2014_10_12_000000_create_users_table.php : 
ta được 
Schema::create('users', function (Blueprint $table) {
    $table->id();
    $table->string('name');
    $table->string('username')->unique();
    $table->string('phone')->nullable();
    $table->string('address')->nullable();
    $table->string('password')->nullable();
    $table->string('google_id')->nullable();
    $table->rememberToken();
    $table->timestamps();
});
// có nhiều trang web, sau khi bấm đăng nhập bằng google => bắt điền thông tin 

+ xóa tạo lại 
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>php artisan migrate:refresh

+ code vào file app/Http/Controllers/Auth/SocialLoginController.php :
use Auth;

// $systemUser->Auth::loginUsingId($systemUser->id);
Auth::login($systemUser);

return redirect('/home'); // sau khi đăng nhập xong hết thì về trang /home 

+ code vào file web.php 
Route::get('/login/google','Auth\SocialLoginController@redirectToGoogle')->name('google.redirect');

+ code vào file resources/views/auth/login.blade.php
<div>
    <a href="{{route('google.redirect')}}">Đăng nhập bằng Google</a>
</div>

=> vào http://localhost:8000/login => sẽ có 'Đăng nhập bằng Google' => click vào đó => chuyển đến trang hiển thị tất cả tài khoản google để chọn 

+ code thêm vào file app/Http/Controllers/Auth/SocialLoginController.php :
'google_id' => $googleUser->id

vào http://localhost:8000/login => chọn 'Đăng nhập bằng Google' => chọn một tài khoản => thành công, đăng nhập vào được bằng tài khoảng google 
(tài khoản nào cũng vào được, tài khoản thật, đăng nhập thật)
=> vào database => bảng user lưu tất cả thông tin của tất cả những user đăng nhập vào,vào xem sẽ có thông tin của những tài khoản google mà ta đã đăng nhập vào 


+ Bảng database users vẫn chưa có dữ liệu về : google_id
+ code vào file app/User.php
protected $fillable = [  // nhắt lại : biến $fillable là biến để liệt kê ra những thứ mà mình muốn lưu
    'name', 'username','phone','address','password','google_id',
];

=> Xóa hết tất cả dữ liệu đã đăng nhập ở database
vào đăng nhập lại => lúc này có những tài khoản google này sẽ có thểm dữ liệu về google_id  
(Chú ý : sau khi thêm 'google_id' cho protected $fillable = [ 'name', 'username','phone','address','password','google_id',]; thì các user mà đăng nhập bằng google trước đó, lần sau đăng nhập lại sẽ bị lỗi => ta phải làm sao đó, hoặc là thêm id của tài khoản đó vào google_id hoặc là xóa hết database rồi lúc đó user đăng nhập lại bằng google => sẽ tự động thêm dữ liệu id vào google_id => lúc đó mới đăng nhập được)



+ Đăng nhập bằng Facebook (tương tự)
https://socialiteproviders.com/Facebook/

+ code vào file : database/migrations/2014_10_12_000000_create_users_table.php để tạo thêm cột facebook_id  
$table->string('facebook_id')->nullable();

xóa và tạo lại toàn bộ 
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>php artisan migrate:refresh

+ code vào file app\User.php (model User)
protected $fillable = [
    'name', 'username','phone','address','password','google_id','facebook_id' // lấy thêm dữ liệu : facebook_id
];

+ code vào web.php 
Route::get('/login/facebook','Auth\SocialLoginController@redirectToFacebook')->name('facebook.redirect');
Route::get('/social-login/facebook','Auth\SocialLoginController@processLoginFacebook');

+ Cài Providers của Facebook 
Cài gói socialiteproviders/facebook 
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>composer require socialiteproviders/facebook

+ code vào file config/services.php

'facebook' => [    
  'client_id' => env('FACEBOOK_CLIENT_ID'),  
  'client_secret' => env('FACEBOOK_CLIENT_SECRET'),  
  'redirect' => env('FACEBOOK_REDIRECT_URI') 
],

+ code vào file .env 
FACEBOOK_CLIENT_ID= 
FACEBOOK_CLIENT_SECRET= 
FACEBOOK_REDIRECT_URI= 


+ code vào file app/Providers/EventServiceProvider.php 
    protected $listen = [
        Registered::class => [
            SendEmailVerificationNotification::class,
        ],
        \SocialiteProviders\Manager\SocialiteWasCalled::class => [
        // ... other providers
        'SocialiteProviders\\Google\\GoogleExtendSocialite@handle',   // google 
        'SocialiteProviders\\Facebook\\FacebookExtendSocialite@handle', // facebook
        ],
    ];

+ vẫn như lúc nãy => tìm Facebook Developer (https://developers.facebook.com/)
(nếu chưa đăng nhập thì đăng nhập Đăng nhập)
=> click Tạo ứng dụng 
=> hiện ra Ứng dụng của bạn cần có sản phẩm, quyền và tính năng nào? : Kinh doanh, Workplace, Người tiêu dùng, Trò chơi tức thì, Chơi game (Kết nối một game ngoài nền tảng với phương thức Đăng nhập bằng Facebook), Không có
(xem chi tiết ở ghi chu2) 
=> Đăng nhập bằng facebook => chọn Chơi game
=> Tên hiển thị của ứng dụng : Dang nhap fullstack 5
Bạn có tài khoản Trình quản lý kinh doanh không? => click chọn : Chưa chọn Tài khoản Trình quản lý kinh doanh nào
=> Tạo ứng dụng => (nếu có yêu cầu nhập mật khẩu facebook thì nhập)
=> click vào Đăng nhập bằng Facebook để chơi game (Thiết lập) => Bắt đầu nhanh(bên thanh trái) => Web => 
=> URL trang web : http://localhost:8000/ => Tiếp tục => Tiếp => Tiếp => Tiếp => Quay lại 
=> Cài đặt => Thông tin cơ bản => 
ID Ứng dụng : 238901438243111 
Khóa bí mật của ứng dụng: 65b85bdb2937ec8b142970630b689dab (bấm Hiển thị => nhập mật khẩu để hiển thị)

=> copy => paste vào .env 
FACEBOOK_CLIENT_ID=238901438243111  
FACEBOOK_CLIENT_SECRET=65b85bdb2937ec8b142970630b689dab
FACEBOOK_REDIRECT_URI=http://localhost:8000/social-login/facebook (thêm URI) (giống như google)

+ code vào file : app/Http/Controllers/Auth/SocialLoginController.php (tương tự google không khác gì cả)
    function redirectToFacebook(){
        return Socialite::driver('facebook')->redirect();
    }

    public function processLoginFacebook(){
        $facebookUser = Socialite::driver('facebook')->user();
        dd($facebookUser);
    }

=> vào http://localhost:8000/login/facebook => chuyển đến facebook và hiện ra : 
    Đăng nhập bằng Facebook
    Dang nhap fullstack 5 sẽ nhận được: tên người chơi, avatar và địa chỉ email của bạn.
    Văn Mạnh
    Chỉnh sửa chi tiết về người chơi
    Trên Facebook, bạn bè và những người chơi khác có thể xem hoạt động chơi game của bạn.
    Chỉnh sửa quyền này
    Tiếp tục dưới tên Văn Mạnh
    Chuyển tài khoản ,...
=> Tiếp tục dưới tên Văn Mạnh => chuyển đến trang http://localhost:8000/social-login/facebook/....
+ dd($facebookUser); // hiện ra toàn bộ thông tin người dùng (giống như google vậy)

+ code vào file : app/Http/Controllers/Auth/SocialLoginController.php (tương tự google không khác gì cả)
    function redirectToFacebook(){
        return Socialite::driver('facebook')->redirect();
    }

    public function processLoginFacebook(){
        $facebookUser = Socialite::driver('facebook')->user();
        dd($facebookUser);
        
        if(!$facebookUser){
            return ;
        }
        $systemUser = User::where('facebook_id',$facebookUser->id)->first(); 

        if(!$systemUser){
            $systemUser = User::create([
                'name' => $facebookUser->name,
                'username' => 'gg_'.$facebookUser->id,
                'email' => $facebookUser->email ?? null, // bởi vì đôi lúc user đăng nhập bằng số điện thoại 
                'facebook_id' => $facebookUser->id
            ]);
        }

        Auth::login($systemUser);

        return redirect('/home');
    }


+ code vào file resources/views/auth/login.blade.php
    <a href="{{route('facebook.redirect')}}">Đăng nhập bằng Facebook</a>

+ => vào http://localhost:8000/login => chọn 'Đăng nhập bằng Facebook'
+ => lúc này vào bảng database users => có dữ liệu trong đó 

+ google thì có google_id (facebook_id = null) (gỉa sử là Vô Thiên buongtaynhenhang99@gmail.com)
+ facebook thì có facebook_id  (google_id = null) (Nguyễn Văn Mạnh nguyenvanmanh2001it1@gmail.com)

+ Nếu lấy google_id của Vô Thiên (đăng nhập bằng google) cho vào google_id của (Nguyễn Văn Mạnh)(đăng nhập bằng facebook)
=> Nguyễn Văn Mạnh vừa có cả faceboook_id của fb Nguyễn Văn Mạnh vừa có cả google_id của goolge Vô Thiên 
=> Xóa data của tài khoản google của Vô Thiên đi 
=> vào login đăng nhập lại => chọn đăng nhập bằng google => chọn tài khoản Vô Thiên 
=> Lúc này tên tài khoản hiện ra là : Nguyễn Văn Mạnh 
tức là tài tên tài khoản Facebook (nguyenvanmanh2001it1@gmail.com)

+ Nhiều trang web khi đã đăng nhập bằng facebookk => trong tài khoản có cái kết nối google 
(Trong tài khoản có kết nối với mạng xã hội để đăng nhập nhanh)
(Thực ra chỉ là tại tài khoản đó => kết nối với fb hay gg hay ,... thì ta cũng làm tương tự trên => lấy id của nó rồi cho vào database của account hiện tại)
ex : vào register => tạo tài khoản (tài khoản của hệ thống) => xong vào tài khoản sẽ có kết nối với mạng xã hội (fb,gg,...)
=> khi click vào đó => thì giống như ta đăng nhập bằng gg hay bằng fb thôi => thực hiện lấy id của gg hay id của fb ,... sau đó cho vào database của tài khoản đó rồi update lại để cập nhật thêm goole_id hay facebook_id ,... 

+ Kết nối hệ thống : 
ex : kết nối facebook 
function connectFacebook(){
    $facebookUser = Socialite::driver('facebook')->user();
    // dd($facebookUser); // biến nào cũng nên thử xuất ra thế này để xem thông tin của nó gồm những gì để thao tác với nó 
    if(!$facebookUser){
        return ;
    }
    $systemUser = auth()->user(); 
    $systemUser->facebookUser_id = $facebookUser->id; // tương tự , biến của hệ thống trỏ đến facebook_id trong database là lưu giá trị của biến facebook trỏ đến cái id của nó 
    $systemUser->save(); 
}

(video47)

--------------------------------------------------------------
laravelAuth
Database : auth 
Giữa video 46 và video 47 có một buổi học mà anh Nguyện quên quay video lại nên giờ đoạn đầu của video 47 này anh Nguyện nói lại .
tạm gọi buổi quên quay là video 46a 
Ở video 46 có phần 
+ Custom hệ thống đăng kí,đăng nhập 
            + Đăng kí bằng username (email)
            + Thêm field khác : số điện thoại, địa chỉ 
            + Đăng kí bằng mạng xã hội (google, facebook)
        + Đăng nhập : đăng nhập bằng mạng xã hội 
        + Sử dụng Authentication trong vuejs 

Đã giải quyết được 
+ Custom hệ thống đăng kí,đăng nhập 
            + Đăng kí bằng username (email)
            + Thêm field khác : số điện thoại, địa chỉ 
            + Đăng kí bằng mạng xã hội (google, facebook)
        + Đăng nhập : đăng nhập bằng mạng xã hội  
(Đăng nhập bằng framework laravel)
video 46a : 
Sử dụng Authentication trong vuejs
    + Laravel => route => truy cập => refresh 
        => load ra 1 view => import component vào < tên_component/>
    + Vue => route => single page 
        + Sử dụng vuejs chung với code laravel 
        + Sử dụng vue riêng biệt 
            + vue create [tên_ gói]
    => cho hết về 1 cái 

+ Queue: hàng đợi 

+ Tác vụ : đợi hơi nhiều thời gian xử lý 
    + chạy luôn => giống như không có queue => dev => quay rất lâu 
    + dispatch 1 job => lưu các thông tin đi cùng job 

=> Tóm lại là buổi 46a có hai cái 
+ Sử dụng Authentication trong vuejs (chủ yếu sửa lại cái form đăng nhập bằng vuejs)
+ Queue:
Đối với + Sử dụng Authentication trong vuejs nó cũng không quan trọng lắm và sau này làm dự án có thể sẽ gặp lại, nói lại sau.
=> Đoạn đầu này nội dung chủ yếu là thế, xem video sẽ dễ hiểu hơn, chỉ có một số câu lệnh CMD, hay một số lưu ý thì ghi lại thôi

Sử dụng Authentication trong vuejs
    + Laravel => route => truy cập => refresh 
        => load ra 1 view => import component vào < tên_component/>
    + Vue => route => single page 
        + Sử dụng vuejs chung với code laravel 
        + Sử dụng vue riêng biệt 
            + vue create [tên_ gói]
    => cho hết về 1 cái 

TH1 : truy cập bằng : localhost/login 
    => trả về web 
TH2 : Đăng nhập laravel bằng ajax => post bằng axios (ajax) => tự động nhận biết => trả về json (ở phía backend không cần xử lí gì cả)
    + Laravel => route => truy cập => refresh 
        => load ra 1 view => import component vào < tên_component/>
=> Sau này làm dự án thực tế sẽ nhắt lại => không ảnh hưởng.

--------------------------------------------------------------
laravelAuth
Database : auth 

Queue => hàng đợi => tuần tự 
Cần xử lý nhanh 

ex : một ông hàng xóm => sang nhờ đóng 1 cái ghế => có hai cách xảy ra 
    - Đóng ghế luôn -> đưa cho ông hàng xóm mang về 
        - Ông hàng xóm phải chờ 
    - Được rồi, bác cứ về đi, đóng xong em sẽ mang sang cho bác => ĐÂY chính là Queue
        - Đi về luôn -> không cần đợi


ex : Gửi email chào mừng khi đăng ký tài khoản 
    - Bấm nút đăng ký => xử lý gửi mail luôn 
        + người dùng sẽ phải đợi => gửi mail xong => bảo là đăng ký thành công 
        + Quay quay rất lâu 
        + Nghĩa là : sau khi người dùng bấm đăng ký => lưu thông tin vào database => server tiến hành thực hiện thật để có cái mail gửi về cho người dùng 
        => server xử lí thật ở backend => đợi lâu => quay quay => gửi mail xong => báo là thành công 
    - Queue : xử lí  bằng queue thì 
        + đăng ký người dùng 
        + Thêm 1 job gửi mail vào hàng đợi => queue 
        + Trả về thông báo đăng kí thành công 
        + Không quay quay => không đợi 
        + Nghĩa là : sau khi người dùng bấm đăng ký => server chưa xử lý liền công việc gửi mail đó cho người dùng => xếp nó vào những công việc cần làm 
        => có thể là 5 phút sau, 10 phút sau,... (Thêm 1 job gửi mail vào hàng đợi => queue), Tạm thời cứ trả về ở client cho người dùng là thông báo thành công 
        bởi vì sau khi người dùng bấm đăng kí => server chỉ làm những việc : + lưu thông tin người dùng vào serve + thêm 1 job vào hàng đợi + trả về một thông báo bằng css hoặc gì đó ở frontend => nhanh không quay quay => người dùng không đợi => 5, 10 phút sau gì đó thì gửi mail về cũng được 

        + Queue không phải là làm cho server của chúng ta thực hiện nhanh hơn thật ra nó vẫn chậm chỉ là delay lại công việc đó rồi để lúc sau làm, còn hiện tại trả về một cai gì đó cho người dùng => nên user tưởng là nhanh thôi, chứ thật ra công việc đó vẫn chưa được làm, lúc sau mới làm .
ex : chương trình khuyến mãi => hàng ngàn người vào form đăng ký đấy => không cần xử lí đơn hàng cho người này, người kia liền => mà cứ lưu lại những hoạt động những thao tác của người dùng đó đã => rồi sau đó thực hiện lần lượt sau => chứ không thực hiện liền 
=> Những tác vụ nặng,tốn thời gian, nhưng mà không yêu cầu tức thì => cho vào queue 

+ Tạo queue : 
    + php artisan make:job [Tên_Job]
        ex : C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>php artisan make:job SendWelcomeMail
             Job created successfully.
    => xuất hiện thư mục Jobs trong thư mục app, xuất hiện file app/Jobs/SendWelcomeMail.php
+ Trong file app/Jobs/SendWelcomeMail.php 
    + ta chỉ quan tâm đến hàm handle() thôi 
        public function handle(){
            // Viết code xử lí tác vụ nặng 
            // Viết code gửi mail 
            echo 'Đang gửi mail';
            sleep(10); // xử lí 10 giây 
        }
        + chú ý : sleep(10); là 10 giây => đơn vị giây chứ không giống một số cái đơn vị mili giây 
        + setTimeout(f,time) => chạy 1 lần sau 1 khoảng thời gian (đơn vị mili giây)

+ Vào file app/Http/Controllers/Auth/RegisterController.php code (trải nghiệm cảm giác đợi lâu)
        protected function create(array $data){
            // viết code gửi mail ở đây 
            sleep(10); // trước khi tạo tài khỏang thì đợi 10 giấy 
            return User::create([
                'name' => $data['name'],
                'username' => $data['username'],
                'phone' => $data['phone'],
                'address' => $data['address'],
                'password' => Hash::make($data['password']),
            ]);
        }
        => vào http://localhost:8000/register => đăng kí sau khi bấm đăng kí => quay 10 giây nó mới vào home (http://localhost:8000/home)(tức là đã đăng kí thành công)
        => đấy là giả sử nếu làm gì đó thì tốn 10 giây 
        => lấy code đó viết vào hàm handle của file app/Jobs/SendWelcomeMail.php
+ vào file config/queue.php 
    queue có các Drivers: "sync", "database", "beanstalkd", "sqs", "redis", "null"
        + sqs là của amazon => tức là ta có thể lưu queue của ta lên amazon 
        + redis : là một database ở trên ram => ram tăng một chút nhưng tốc độ xử lí nhanh 
          lưu vào queue là lưu thẳng lên ram luôn => xử lí tuần tự 
        + sync : chạy luôn (giống như bingh thường)(cũng quay quay)(ít dùng)

+ vào .env 
BROADCAST_DRIVER=log
CACHE_DRIVER=file
QUEUE_CONNECTION=database (sửa sync thành database)
SESSION_DRIVER=file
SESSION_LIFETIME=120

code vào file .env => cập nhật lại 
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>php artisan config:cache

+ php artisan queue:table
    C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>php artisan queue:table
    Migration created successfully!
    => tạo ra bảng jobs : 2021_09_17_103236_create_jobs_table.php trong database 
    database/2021_09_17_103236_create_jobs_table.php

migrate để tạo bảng jobs trong database 
+ C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>php artisan migrate 
=> vào database : auth => có thể bảng jobs 

+ Bảng jobs gồm các cột thông tin sau : 
    + queue : tên của queue đó mặc định là default
    + payload : toàn bộ dữ liệu của queue 
    + attempts : số lần thử lại 
    + reserved_at : queue được gọi khi nào 
    + available_at : queue hết hạn khi nào (sau bao lâu thì không thực hiện queue đó nữa)
    + created_at : queue được tạo ra khi nào 

+ vào file app/Http/Controllers/Auth/RegisterController.php code 
    use App\Jobs\SendWelcomeMail; // muốn dùng file nào thì cứ use file đó vào use [namespace]\[tên class];
    protected function create(array $data){
        // viết code gửi mail ở đây 
        // sleep(10);
        SendWelcomeMail::dispatch(); 

        return User::create([
            'name' => $data['name'],
            'username' => $data['username'],
            'phone' => $data['phone'],
            'address' => $data['address'],
            'password' => Hash::make($data['password']),
        ]);
    }
    + SendWelcomeMail là tên của file mà ta đã tạo (app/Jobs/SendWelcomeMail.php)
      C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>php artisan make:job SendWelcomeMail
+ => vào http://localhost:8000/register để đăng kí thì => bấm đăng kí thì vào luôn (không load quay quay gì nữa)
=> vào bảng jobs trong database thì có : dữ liệu của những queue 
ex : 
    + id : 1 
    + queue : default
    + payload : {"uuid":"1b806db8-1283-4136-baa6-aea32576130c","displayName":"App\\Jobs\\SendWelcomeMail","job":"Illuminate\\Queue\\CallQueuedHandler@call","maxTries":null,"maxExceptions":null,"delay":null,"timeout":null,"timeoutAt":null,"data":{"commandName":"App\\Jobs\\SendWelcomeMail","command":"O:24:\"App\\Jobs\\SendWelcomeMail\":8:{s:3:\"job\";N;s:10:\"connection\";N;s:5:\"queue\";N;s:15:\"chainConnection\";N;s:10:\"chainQueue\";N;s:5:\"delay\";N;s:10:\"middleware\";a:0:{}s:7:\"chained\";a:0:{}}"}}
    payload : lưu dưới dạng serialize ; serialize(biến) => chuỗi
    + attempts : 0
    + reserved_at : null 
    + available_at : 1631882964
    + created_at : 1631882964

+ Đó là mới lưu vào thôi => để queue làm việc thì cần nhập lệnh 
    + php artisan queue:work 
    + ex : C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>php artisan queue:work

    C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>php artisan queue:work
    [2021-09-17 12:57:45][1] Processing: App\Jobs\SendWelcomeMail
    Đang gửi mail[2021-09-17 12:57:45][1] Processed:  App\Jobs\SendWelcomeMail

        + Đang gửi mail : đó chính là câu lệnh mà ta viết ở hàm : public function handle(){ // file app/Jobs/SendWelcomeMail.php
                                                                      // Viết code xử lí tác vụ nặng 
                                                                      // Viết code gửi mail 
                                                                      echo 'Đang gửi mail';
                                                                      sleep(10); // xử lí 10 giây 
                                                                  }
=> vào lại bảng jobs trong database thì dòng queue đó mất đi => tức là đã thực hiện xong rồi 

+ Tại cửa sổ CMD => nó vẫn hiện giao diện như thế nó không dừng hay kết thúc để hiện ra câu lệnh 
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>
mà nó vẫn cứ để thế ... để chờ xem nếu có job nào thì tiếp tục thực hiện jobs đó 
=> vào http://localhost:8000/register để đăng kí => ngay sau khi đăng kí => thì cũng giống nhu thường lệ => có queue rồi thì không load gì nữa mà vào luôn trang home => đồng thời tại cửa sổ CMD => xuất hiện thêm : 
    C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>php artisan queue:work
    [2021-09-17 12:57:45][1] Processing: App\Jobs\SendWelcomeMail
    Đang gửi mail[2021-09-17 12:57:45][1] Processed:  App\Jobs\SendWelcomeMail                  
    [2021-09-17 13:04:50][2] Processing: App\Jobs\SendWelcomeMail               // xuất hiện thêm     
    Đang gửi mail[2021-09-17 13:04:50][2] Processed:  App\Jobs\SendWelcomeMail  // xuất hiện thêm   

=> cứ có job nào thì thực hiện tiếp tục job đó, thực hiện tuần tự 1,2,3,... 
Chỉ khi ta ctrl + C thì mới dừng work còn không thì câu lệnh : php artisan queue:work vẫn còn hiệu lực và server vẫn cứ thực hiện các job khi được thêm vào 

Nếu có chạy câu lệnh này thì ta nên mở : 
+ 1 của sổ Windows Power Shell để run serve : php artisan serve 
+ 1 cửa sổ Windows Power Shell để chạy : php artisan queue:work
+ 1 cửa sổ CMD để code 
hoặc có thể mở 3 cửa sổ CMD hoặc 3 cửa sổ Windows Power Shell , vào Type here to search rồi nhập CMD hay Windows Power Shell rồi nhấn enter là được 
=> cứ có cái nào mà chạy để vậy thì mở thêm Windows Power Shell




+ tại file app/Jobs/SendWelcomeMail.php
class SendWelcomeMail implements ShouldQueue
{
    use Dispatchable, InteractsWithQueue, Queueable, SerializesModels; (nhắc lại kiến thức cũ : sau khi implements thì đây là use các trait)

serialize(biến)=> chuỗi
unserialize(chuỗi)=> biến

+ Gửi mail cho user : 
    + code vào file app/Http/Controllers/Auth/RegisterController.php 
        protected function create(array $data)
        {
            SendWelcomeMail::dispatch($data['name']);  (1) // truyền vào $data['name'] 
    + code vào file app/Jobs/SendWelcomeMail.php
        class SendWelcomeMail implements ShouldQueue
        {
            ... 
            protected $name = '';                      (3)
            public function __construct($name)         (2)
            {
                //
                $this->name = $name;                   (4)
            }

            ....
    + Nhắc lại Như kiến thức đã học và như đã nói ở trên , trong laravel hay vuejs dùng rất nhiều use namespace import 
    + Một file nào đó use một file nào đó thì có thể dùng class được use trong file đó, khi mà dùng class đó thì xem như toàn bộ code của class đó đang nằm trong file use vậy hay nói cách khác, có thể làm bất cứ thứ gì đối với class đó trên file này.
    + ex : file app/Http/Controllers/Auth/RegisterController.php muốn dùng class SendWelcomeMail của file app/Jobs/SendWelcomeMail.php
    => use App\Jobs\SendWelcomeMail; với App\Jobs là namespace của file app/Jobs/SendWelcomeMail.php và SendWelcomeMail là tên class muốn dùng 
    + namespace, use, stactic class (::) trong laravel dùng cực kì nhiều. 
    (ex : namespace App\Models; class Menu extends Model; use App\Models\Menu; $menu = Menu::where())
    + Tóm lại namespace,use,stactic classđể dùng class trong laravel dùng rất nhiều .

    + Sau khi use => dùng như là class SendWelcomeMail đang ở trên file app/Http/Controllers/Auth/RegisterController.php vậy 
    (1) là truyền giá trị $data['name'] vào class SendWelcomeMail,
       SendWelcomeMail:: là static class (nếu muốn xem lại thì xem ở php.html nói rất rõ)  
    (2) như đã biết khi truyền tham số vào một method() (hàm)(function) thì truyền vào hàm __construct của class đó 
    biến $name (2) =  $data['name'] , nhưng mà biến này chỉ được hoạt động trong hàm __construct
    (3) tạo một biến ở ngoài 
    (4) gọi biến ở ngoài bằng this => rồi gán giá trị vào cho biến đó 
        (nếu (3) là protected $ten = ''; thì (4) là $this->ten = $name;)
    Lúc này biến name (4) với giá trị $data['name'] có thệ hoạt động trên toàn class 

+ code vào file app/Jobs/SendWelcomeMail.php
    public function handle(){
            echo 'Đang gửi mail cho'.$this->name;
            // sleep(20); // xử lí 10 giây 
        }

+ Chú ý : Ctrl + C : để tắt work 
=> rồi sau đó => php artisan queue:work lại (cứ có chỉnh sửa gì ở file app/Jobs/SendWelcomeMail.php thì nên tắt rồi work lại)
+ vào lại : http://localhost:8000/register => tạo tài khoản => bấm đăng ký 
=> tại cửa sổ CMD xuất hiện : 
    C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>php artisan queue:work
    [2021-09-17 13:57:40][7] Processing: App\Jobs\SendWelcomeMail
    Đang gửi mail choNguyễn Văn Mạnh[2021-09-17 13:57:40][3] Processed:  App\Jobs\SendWelcomeMail

+ Đặt vấn đề : 
+ ex : bây giờ tắt đi : ctrl + c => để job lưu ở database khoang thực hiện đã 
vào lại : http://localhost:8000/register => tạo tài khoản => bấm đăng ký 
bảng jobs ở database lưu 
    + id : 9
    + queue : default
    + payload : {"uuid":"b3c01983-b049-4b6f-a00c-eeb857de05b1","displayName":"App\\Jobs\\SendWelcomeMail","job":"Illuminate\\Queue\\CallQueuedHandler@call","maxTries":null,"maxExceptions":null,"delay":null,"timeout":null,"timeoutAt":null,"data":{"commandName":"App\\Jobs\\SendWelcomeMail","command":"O:24:\"App\\Jobs\\SendWelcomeMail\":9:{s:4:\"name\";s:13:\"NguyenVanManh\";s:3:\"job\";N;s:10:\"connection\";N;s:5:\"queue\";N;s:15:\"chainConnection\";N;s:10:\"chainQueue\";N;s:5:\"delay\";N;s:10:\"middleware\";a:0:{}s:7:\"chained\";a:0:{}}"}}
    + attempts : 0
    + reserved_at : null 
    + available_at : 1631887636
    + created_at : 1631887636

=> payload như đã nói : là lưu tất cả thông tin của queue đó , trong payload trên có đoạn s:13:\"NguyenVanManh\" (lưu tên)
Trong lúc serve chưa làm việc (chưa thực hiện câu lệnh gửi mail) 
Nếu như bây giờ đăng nhập vào sửa username thành BuiVanNguyen thì thông tin của queue đó ở dưới database vẫn không ảnh hưởng tức là payload vẫn lưu 'NguyenVanManh'
=> tức là ban đầu nó được lưu như thế nào => thì dưới database cũng như thế 
=> đến khi thực hiện gửi mail => vẫn là ...Đang gửi mail choNguyenVanManh... chứ không phải là ...Đang gửi mail choBuiVanNguyen... (mặc dù đã đổi tên rồi)
+ Chỉ mang tính chất thời điểm 

=> ta sẽ đọc từ id
    public function __construct($id){
        $this->userId = $id;
    }
    public function handle(){
        $user = User::findOrFail($this->userId);
        echo 'Đang gửi mail cho '.$user->name;
    }

(còn không thì lấy thông tin ở bảng user cập nhật vào bảng jobs rồi gửi mail, nhưng như thế thì mất thời gian và phức tạp hơn vì cần phải tách chuỗi các thứ ,...để làm sao đó => đổi NguyenVanManh trong payload thành BuiVanNguyen)


+ code vào file : app/Http/Controllers/Auth/RegisterController.php  
    $user = User::create([
        'name' => $data['name'],
        'username' => $data['username'],
        'phone' => $data['phone'],
        'address' => $data['address'],
        'password' => Hash::make($data['password']),
    ]);  // tạo ra user đã 
    SendWelcomeMail::dispatch($user);  // rồi dispatch user đó vào rồi muốn làm gì thì làm 

    return $user;

ex : + Gửi mail khi mà một người dùng xóa bài viết 
$user = User::with('books')->find(10);
$user = auth()->user();
SendDeletePostJob::dispatch($user);
// SendDeletePostJob
$user->books 
(gọi là job hay queue gì cũng được, miễn hiểu là được)


+ Delay : 
    + Sau bao nhiêu phút thì mới xử lí : delay() 
        + ex : SendWelcomeMail::dispatch($user)->delay(now()->addMinutes(5)); // sau 5 phút thì mới xử lí 
+ onQueue() : đặt tên queue
    + ex : SendWelcomeMail::dispatch($user)->onQueue('SendWelcomeMail'); // đặt tên cho Queue đó
    (ctrl + c => để xem job trong database)
    => vào http://localhost:8000/register => tạo tài khoản => bấm đăng ký
    => vào bảng jobs trong database : 
        + id : 10
        + queue : SendWelcomeMail  (tên của queue ta vừa mới đặt)
        + payload : ....
        + attempts : 0
        + reserved_at : null 
        + available_at : 1631893565
        + created_at : 1631893565

+ Chạy riêng một job theo tên queue 
    + php artisan queue:work --queue=[tên_queue]
    + ex : C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>php artisan queue:work --queue=SendWelcomeMail
    [2021-09-17 15:50:57][10] Processing: App\Jobs\SendWelcomeMail
    Đang gửi mail cho{"id":18,"name":"Nguy\u1ec5n V\u0103n M\u1ea1nh","username":"nguyenwegaaweg","phone":"01236000333","address":"Ph\u00fa \u0110a-Ph\u00fa Vang-TT Hu\u1ebf","google_id":null,"facebook_id":null,"created_at":"2021-09-17T15:46:05.000000Z","updated_at":"2021-09-17T15:46:05.000000Z"}[2021-09-17 15:50:57][10] Processed:  App\Jobs\SendWelcomeMail

+ Các queue nếu chạy bị lỗi => sẽ được thêm vào bảng database/2019_08_19_000000_create_failed_jobs_table.php (bảng failed_jobs trong database)
+ Chạy lại queue bị lỗi trong bảng failed_jobs
    + php artisan queue:work --queue=[tên_queue] --tries=[số_lần_thử_lại]
          + ex : php artisan queue:work --queue=SendWelcomeMail --tries=5
          + Đối với số lần thử lại --tries, ta cũng có thể vào file app/Jobs/SendWelcomeMail.php => đặt biến tại đó => protected $tries = 5;

+ Chỉ định nơi lưu vào queue 
    + Ta có trong file .env : QUEUE_CONNECTION=database , mặc định các queue được tạo ra sẽ lưu trong database 
    + onConnection('nơi lưu');
        + ex : SendWelcomeMail::dispatch($user)->onQueue('SendWelcomeMail')->onConnection('redis'); //chỉ định riêng Queue này lưu lên redis
        (redis ứng dụng trong ví dụ lúc nãy là web giảm giá hàng ngàn user truy cập => lưu thao tác của user vào đã rồi xử lí sau)
    + Những nơi lưu : có ghi trong file config/queue.php : 
        + Drivers: "sync", "database", "beanstalkd", "sqs", "redis", "null" 
+ Xem tất cả các queue bị lỗi bằng CMD : (thật ra ta thường xem trong database bằng dbms)
    + php artisan queue:failed  
+ Chuyển queue từ bảng failed_jobs (bị lỗi) quay trở lại bảng jobs 
    + php artisan queue:retry [id] : chuyển một queue có id đó từ bảng failed_jobs về bảng jobs (id của queue đó) 
    + php artisan queue:retry all  : chuyển hết tất cả từ bảng failed_jobs về bảng jobs
        + ex : php artisan queue:retry 3 
        + ex : php artisan queue:retry all 
+ Xóa queue trong bảng failed_jobs
    + php artisan queue:forget [id] : xóa một queue có id đó 
    + php artisan queue:flush       : xóa hết tất cả queue trong bảng failed_jobs

Một số trường hợp xảy ra : 
    + php artisan queue:work --once : mỗi lần chỉ xử lí một queue rồi thôi (ít dùng)

+ dispatchSync()
    + SendWelcomeMail::dispatchSync($user)->onQueue('SendWelcomeMail')->onConnection('redis');
        + tự tạo ra một project riêng để xử lí cái này 

Những software engineer pro sẽ dùng Queue 

Schedule và command 
Command : 
    + Lâu nay ta hay vào CMD dùng : C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth> ....
      thì phần phía sau này chính là command (C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>)
    + Tạo một file command : php artisan make:command [tên command]
        + ex : C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>php artisan make:command ClearCacheCommand
               Console command created successfully. 
               => Trong thư mục app/Console/ sẽ xuất hiện thư mục  trong thư mục Commands sẽ xuất hiện file ClearCacheCommand.php 

+ code vào file app/Console/Commands/ClearCacheCommand.php : 

    class ClearCacheCommand extends Command{
        protected $signature = 'system:clear-cache';   (1)

        protected $description = 'Clear all cache of system'; // description là mô tả 
        public function __construct(){
            parent::__construct();
        }
        public function handle(){   (2)
            // viết code 
            echo 'Đang clear cache';  
            // return 0;
            return 'Success'; // bắt buộc phải có return, return gì cũng được 
        }
    }

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>php artisan system:clear-cache ($signature ở (1))
=> CMD trả về : Đang clear cache  (Thực hiện câu lệnh ở (2))

+ code vào file app/Console/Commands/ClearCacheCommand.php : 
    use Illuminate\Support\Facades\Artisan;
    public function handle(){
        // viết code 
        echo 'Đang clear cache';
        // return 0;
        Artisan::call('cache:clear');
        Artisan::call('config:cache');
        return 'Success'; // bắt buộc phải có return, return gì cũng được 
    }


Schedule :
vào https://laravel.com/docs/8.x/scheduling để xem các hàm (phần Schedule Frequency Options) và nhiều cái khác
    + Schedule : là những tác vụ được xử lý vào một thời điểm 
        + ex : cữ 3h sáng là tổng hợp dữ liệu để làm báo cáo user 
    + Trong thư mục app/Console có file Kernel.php 
        + Chú ý : app/Console/Kernel.php khác với app/Http/Kernel.php
            + app/Console/Kernel.php chuyên xử lí console 
            + app/Http/Kernel.php chuyên xử lí http 

    +   (các hàm của Schedule)
        + hourly()             : mỗi tiếng một lần 
        + hourlyAt(17)         : mỗi tiếng một lần, và gọi vào phút thứ 17 (7h17,8h17,9h17,...)
        + everyTwoHours()      : hai tiếng gọi một lần 
        + daily()              : gọi hàng ngày 
        + dailyAt('13:00')     : mỗi ngày vào lúc 13h 
        + weekly()             : hàng tuần 
        + weeklyOn(1, '8:00')  : vào lúc 8h ngày 1 (thứ hai) (ngày 1 ở đây chính là kiểu, số 0 là chủ nhật,số 1 là thứ hai,... )
        + quarterly()          : mỗi quý gọi một lần 
        + cron('* * * * *')    : 
            + ex : cron('0 2 * * *') : phút thứ 0 - giờ thứ 2 - tất cả các ngày - tất cả các tháng - tất cả các năm 
            + ex : cron('* * * * *') : mỗi phút một lần 
            search : crontab guru 
            + ex $schedule->command('foo')
                          ->weekdays() 
                          ->hourly()
                          ->timezone('America/Chicago')
                          ->between('8:00', '17:00');
                        => Chạy hàng giờ từ 8 giờ sáng đến 5 giờ chiều các ngày trong tuần ...
            + ex : ...
        + ... 

Schedule kết hợp với Command 

    + code vào file app/Console/Kernel.php : 
        + $schedule->command('system:clear-cache')->hourly();  
        (system:clear-cache là từ protected $signature = 'system:clear-cache'; trong file app/Console/Commands/ClearCacheCommand.php)
    => Schedule kết hợp với command 

    + Lúc mà cài laravel: đặt 1 crontab mỗi phút một lần (bắt buộc)
        + * * * * * cd /path-to-your-project && php artisan schedule:run >> /dev/null 2>&1
        + application heart beat (nhịp đập của ứng dụng)
            => mỗi phút chạy một lần 
            => ví dụ 
                protected function schedule(Schedule $schedule){
                    $schedule->command('system:clear-cache')->hourly();  
                }
                trường hợp này là ->hourly() là 60 lần (1h = 60')
            => mỗi phút chạy hàm schedule một lần cứ như thế đếm đủ 60 lần thì chạy:  $schedule->command('system:clear-cache')->hourly(); 
            
            + C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>echo "abc" > a.txt
            => trong laravelAuth có thêm file a.txt với nội dung là "abc" 
            + C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>echo "xyz" > a.txt
            => thay xóa hết nội dung trong file a.txt rồi thêm vào "xyz"
            + C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>echo "Manhpro" >> a.txt
            => Thêm tiếp nội dung vào file a.txt ("xyz" "Manhpro")
        + php artisan schedule:run : mỗi lần chạy câu lệnh này thì schedule chạy một lần 
            + vào file app/Console/Kernel.php code 
            protected function schedule(Schedule $schedule){
                $schedule->command('system:clear-cache')->everyMinutes(); // chạy mỗi phút một lần  
            }
            => C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>php artisan schedule:run 
            => chạy schedule => chạy $schedule->command('system:clear-cache')->everyMinutes();
            => trả về Running scheduled command: "C:\xampp\php\php.exe" "artisan" system:clear-cache > "NUL" 2>&1

            + schedule->command('system:clear-cache')->everyFiveMinutes();
            => php artisan schedule:run 5 lần trong 5 phút => thì mới chạy schedule->command('system:clear-cache')->everyFiveMinutes();
        + ex : báo cáo ngày 
            + C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>php artisan make:job DailyReportJob
              Job created successfully.
            + code vào file app/Console/Kernel.php
              use App\Jobs\DailyReportJob;
              $schedule->job(new DailyReportJob)->daily(); // chạy App\Jobs\DailyReportJob; mỗi ngày một lần 
            => kết hợp cả queue, command và schedule
            (đọc thêm ở : https://laravel.com/docs/8.x/scheduling#scheduling-queued-jobs)
        
        + ex : $schedule->command('system:clear-cache')->everyMinutes(); (1)
        Trường hợp mà câu lệnh xử lí của ta hơn 1 phút => chưa xử lí xong hết => ->everyMinutes(); => (1) đã chạy rồi 
        => cứ tiếp tục như thế (1) chạy tiếp khi chưa xử lí xong ,...
        => $schedule->command('system:clear-cache')->withoutOverlapping(); hoặc 
           $schedule->command('system:clear-cache')->everyFiveMinutes()->withoutOverlapping(); giải quyết vấn đề đó 

(video48)
copy laravelAuth sang laravel10 
copy database : auth47 sang database : auth48

.env 
DB_CONNECTION=mysql
DB_HOST=localhost
DB_PORT=3306
DB_DATABASE=auth48
DB_USERNAME=root
DB_PASSWORD=



+ code ứng dụng tin tức để có cái thực hành với cache 
    + Trang chủ: hiện 10 bài viết mới nhất 

(những cái gì có rồi, biết rồi giờ code lại thì không nói lại nữa)
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel10>php artisan make:model Models/Article -m
Model created successfully.
Created Migration: 2021_09_17_202607_create_articles_table 

+ app/Models/Article.php
    class Article extends Model{
        protected $fillable = ['title','content'];
    }

+ database/migrations/2021_09_17_202607_create_articles_table.php
    public function up(){
        Schema::create('articles', function (Blueprint $table) {
            $table->id();
            $table->string('title');
            $table->string('content');
            $table->timestamps();
        });
    }

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel10>php artisan migrate
Migrating: 2021_09_17_202607_create_articles_table
Migrated:  2021_09_17_202607_create_articles_table (0.23 seconds)

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel10>php artisan make:seeder ArticlesTableSeeder
Seeder created successfully.

+ database/seeds/DatabaseSeeder.php
    public function run(){
        $this->call(ArticlesTableSeeder::class); //như đã biết ArticlesTableSeeder là tên class trong file ArticlesTableSeeder.php 
    }

tạo dữ liệu kiểu mẫu 
+ database/seeds/ArticlesTableSeeder.php
    use App\Models\Article;
    public function run(){
        for($i=0;$i<100;$i++){
            Article::create([
                'title' => 'bai viet '.$i,
                'content' => 'noi dung '.$i
            ]);
        }
    }

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel10>php artisan db:seed
Seeding: ArticlesTableSeeder
Seeded:  ArticlesTableSeeder (0.2 seconds)
Database seeding completed successfully.

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel10>php artisan make:controller LandingPageController
Controller created successfully.

+ app/Http/Controllers/LandingPageController.php 
    use App\Models\Article;
    class LandingPageController extends Controller{
        public function index(Request $request){
        //  $articles = Article::latest()->paginate(10); //latest() sắp xếp theo thời gian 
            $articles = Article::paginate(10);
            return view('landing')->with('articles',$articles);
        }
    }

+ routes/web.php 
    Route::get('/','LandingPageController@index');

+ resources/views/landing.blade.php
    <!DOCTYPE html>
    <html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>Trang chủ</title>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"  crossorigin="anonymous">
    </head>
    <body>
    <div>
    @foreach($articles as $article)
        <div>
            <h2>{{$article->title}}</h2>
            <div>{{$article->content}}</div>
        </div>
    @endforeach
    </div>
    </body>
    </html>

+ Cache : Lưu tạm => đọc từ database quá nhiều 
   + Dễ 
   + Quyết định: cái gì cache, cái gì không 
       + Cache ở đâu mới 
   + config/cache.php : 
       + 'default' => env('CACHE_DRIVER', 'file'), // mặc định cache sẽ được lưu ở trong file  
       +  Supported: "apc", "array", "database", "file","memcached", "redis", "dynamodb" // những nơi lưu cache 
       (thì cũng giống queue thôi, queue có QUEUE_CONNECTION=, có file config/queue.php , có Drivers: "sync", "database", "beanstalkd", "sqs", "redis", "null")
    + .env : 
            BROADCAST_DRIVER=log
            CACHE_DRIVER=file  // mặc định lưu ở file 
            QUEUE_CONNECTION=database
            SESSION_DRIVER=file
            SESSION_LIFETIME=120

https://laravel.com/docs/8.x/cache
+ Cache driver: Chỉ định cache được lưu ở đâu  
    + cache()->remember('tên cache', $số_giây, function () {
          return ...;
      });
      ex : 
      cache()->remember('users', $seconds, function () {
          return DB::table('users')->get();
      });
      + Lần chạy đầu tiên => chạy function => lấy dữ liệu => lưu vào cache 
      + Lần chạy 2 trở đi => kiểm tra ở trong cache có chưa?
          + có rồi => lấy từ cache (không chạy function)
          + chưa có => chạy function  
      + Khi hết hạn => lại chạy function 

+ Tin tuc : 
    + Trang chủ : hiện 10 bài viết mới nhất 
    + Bảng có rất nhiều bài viết 
    (thường trang chủ sẽ được truy cập nhiều nhất)

+ code file app/Http/Controllers/LandingPageController.php 
    + use Illuminate\Support\Facades\Cache;
      public function index(Request $request){
          $articles = Cache::remember('homeArticles',60,function(){ // 60 giây 
              return Article::limit(10)->get();
          });
          return view('landing')->with('articles',$articles);
      }
    + => vào database thay đổi một cái gì đó ví dụ 'bai viet 0' thành 'bai viet vip pro' chẳng hạn 
    => vào request lại thì vẫn như thế, không thay đổi 
    => bởi vì lúc này serve không đọc dữ liệu từ database nữa mà đọc từ cache 
    => hết 60 giây => request lại thì lại đọc từ database => xuất hiện 'bai viet vip pro'  
    => Ứng dụng Nhanh, trường hợp trên là cache cho articles

+ Vẫn là phải trả lời những câu hỏi : Cache 
    => Cache cái gì,Cache ở đâu,Cache bao lâu Đó mới là vấn đề quan trọng còn code thì dễ rồi 
    + Cache cái gì : 
        + Cache những dữ liệu được đọc nhiều 
        + Cache ở những trang được truy cập nhiều 
        + Có những thành phần được tự động cache 
            + config 
            + view : blade template 
        + Những chỗ thường cache : 
            + Trang chủ 
            + Cache những trang được truy cập nhiều 
                + Cache những bài viết được nhiều người xem nhất 
            + Những dữ liệu được sử dụng nhiều nơi 
                + Bảng settings 
        + Thiết kế db : 
            + Menu : bài viết hot của tháng (thiết kế thêm bảng hot_articles_month, những bài viết vừa nằm ở bảng articles vừa nằm ở bảng hot_articles_month)
            => chấp nhận dư thừa dữ liệu => không cần cache => nhưng đổi lại => nhanh (bởi vì lâu hay nhanh là do việc tìm ở database nhiều hay ít dữ liệu)
            (mà ta đã lấy ra những bài hot nhất, hot thì chỉ có vài bài => user tìm kiếm => nhan, có ít bài nên cả chục triệu người truy cập cũng không sao)
        + Tùy thuộc vào ứng dụng của ta 
    + Cache ở đâu : 
        + file : dễ cài đặt (thường dùng)
        + redis : 
            + Ghi dữ liệu nhiều
                + Lượt xem 
                ex : Cứ mỗi lần có 1 lượt truy cập vào bài viết sẽ có hai cách để lưu lại
                    + update vào bảng article (view_count) : Nhưng sẽ thao tác nhiều lần, vì cứ 1 view => 1 lần update 
                    + cache trên ram : Nhưng hạn chế là nếu mất điện => tắt serve => dữ liệu trên ram mất hết 
                      hoặc nếu reset serve thì dữ liệu trên ram cũng mất hết  
                => redis sẽ có cả hai cái => Cache lên redis => thì thoảng lưu xuống database (Ứng dụng Schedule)
                => ex : Đặt Schedule cứ sau mỗi 1 tiếng sẽ update dữ liệu từ redis xuống database 
    + Cache bao lâu : 
        + Tùy, cần có kinh nghiệm làm dự án thực tế mà rút ra được cache trong bao lâu 
        + Cache theo sự kiện : 
            + ex : Khi ai đó mà đăng bài mới => xóa cache đi => lưu cache lại  

+ Trigger cache bằng gì : 
    + ex : Trường hợp cache 60 giây ở trên, => thằng nào mà đen => truy cập trúng lúc phải cache => chậm 
    (server vừa cache sau 60 xong => thì thằng đó truy cập => chậm vì sau 60 giây nữa mới cache lại những cái từ database lên lại, tức là nếu có thay đổi gì đó từ database thì thằng đó phải 60s nữa mới có xem được những cái mới thay đổi đó từ database) Chưa kể cache bằng controller thì khả năng có thể sai sót 
    + Tạo cache bằng controller 
        + Có người sẽ bị chậm 
        + Khả năng lỗi 
        + Chưa kể ex : cache 30s nhiều user vào => làm gì đó => chưa đủ 30s => tắt trình duyệt => không cache được dữ liệu từ thao tác của user đó   
    + Trên đấy là lấy ví dụ, còn thường thì ít khi hoặc không Cache bằng controller 
    + Thường dùng Schedule kết hợp với queue => queue để thêm vào hàng đợi => user không cần phải đợi còn, Schedule thì cache theo lịch, sau một khoảng thời gian thì hệ thống tự cache
    + Theo sự kiện => bấm nút đăng bài thì cache  
        => Code vào file command thay vì code vào controller(cache bằng controller) 
        Cache bằng Schedule queue command : 
            + tạo file command 
                C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel10>php artisan make:command CreateHomePageCache
            Console command created successfully.
            + code file app/Console/Commands/CreateHomePageCache.php 
                use Illuminate\Support\Facades\Cache;
                use App\Models\Article;
                class CreateHomePageCache extends Command{
                    protected $signature = 'home:cache';               (1)
                    protected $description = 'Command description';
                    public function __construct(){
                        parent::__construct();
                    }
                    public function handle(){
                        Cache::rememberForever('homeArticles',function(){ //rememberForever() là hàm lưu giữ mãi mãi 
                            return Article::limit(10)->get();
                        });
                        return 0;
                    }
                }
            + code vào file app/Console/Kernel.php
                $schedule->command('home:cache')->hourly(); // chạy mỗi tiếng một lần (home:cache bắt nguồn từ (1))
            + code vào file app/Http/Controllers/LandingPageController.php 
                $articles = Cache::get('homeArticles');
            C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel10>php artisan home:cache
            => cữ mỗi tiếng một lần mới lưu cache xuống database 
    + Hoặc bấm nút đăng bài => đưa vào queue => cache 


+ code file app/Console/Commands/CreateHomePageCache.php 

+ Lưu xuống database : lock 
    + Lưu : 
        + Khóa dòng đó lại => không cho ai sửa 
        + Thực hiện sửa 
        + Mở lại 

ex : 
Mượn sách : 
     + đọc dữ liệu bảng books => còn sách hay không 
     + còn : lưu thông tin mượn (tên tuổi)
     + update vào bảng books => hết sách 
     => Đặt vấn đề là chỉ còn 1 cuốn sách => 2 hai người truy cập vào => đọc dữ liệu ra vẫn đang còn sách (vì chỉ mới đọc thôi nên vẫn còn) => kết quả là hai người đều mượn trong khi chỉ còn một cuốn 

InnoDB và myIsam (hiểu thêm)
+ InnoDB : khi lock : lock cả bản luôn => lock cả các bảng liên quan => những nhược điểm là chậm  
+ myIsam : lock dòng dữ liệu , không liên quan đến bảng => nhanh hơn => toàn vẹn dữ liệu thì chưa chắc được 

+ file config/cache.php có : 
    'file' => [
        'driver' => 'file',
        'path' => storage_path('framework/cache/data'),
    ],
    'dynamodb' => [ // dịch vụ bên ngoài, cái này của amazon 
        'driver' => 'dynamodb',
        'key' => env('AWS_ACCESS_KEY_ID'),
        'secret' => env('AWS_SECRET_ACCESS_KEY'),
        'region' => env('AWS_DEFAULT_REGION', 'us-east-1'),
        'table' => env('DYNAMODB_CACHE_TABLE', 'cache'),
        'endpoint' => env('DYNAMODB_ENDPOINT'),
    ],
    => ta có thể cache lên dịch vụ bên ngoài này (https://aws.amazon.com/vi/dynamodb/ sẽ cung cấp các giá trị trên để ta lưu cache vào đó)
    (kiểu kiểu giống như fb developer hay gg developer bữa trước thể)

storage/framework/cache/data/f1/0d (chỉ đọc)
cùng một lúc cache có thể lưu đến nhiều nơi 

Các hàm thao tác với Cache 
    + store() : chỉ đến một driver nhất định 
        + ex : $value = Cache::store('file')->get('foo'); // chỉ đến driver file 
    + get() : lấy 
        + ex : $value = Cache::get('key'); // lấy ở driver mặc định (nếu mặc định là database thì lấy ở database)
        + ex : $value = Cache::get('key', 'redis'); // lấy ở driver redis được chỉ định 
    + get('key', function (){...}) : như đã nói ở trên 
        + ex : $value = Cache::get('key', function () {
                   return DB::table(...)->get();
               });
        + Lần chạy đầu tiên => chạy function => lấy dữ liệu => lưu vào cache 
        + Lần chạy 2 trở đi => kiểm tra ở trong cache có chưa?
            + có rồi => lấy từ cache (không chạy function)
            + chưa có => chạy function  
        + Khi hết hạn => lại chạy function 
    + increment() : tăng 
        + Cache::increment('key'); : tăng lên một đơn vị 
            + ex : Cache::store('redis')->increment('total_views'); : tăng lên một đơn vị với key là total_views, rồi ghi lên redis 
        + Cache::increment('key', $amount); : tăng lên $amount đơn vị với key đó 
    + decrement() : gỉam (tương tự)
        + Cache::decrement('key');
        + Cache::decrement('key', $amount);
    + remember() : như đã nói ở trên 
    + rememberForever() : lưu mãi mãi (như đã nói ở trên)
    + pull() : lấy ra rồi xóa 
        + ex : $value = Cache::pull('key');
    + put() : giống update
        + ex : Cache::put('key', 'value', $seconds = 10);
        + ex : Cache::put('key', 'value', now()->addMinutes(10)); // lưu trong vòng bao lâu,(từ bây giờ đến 10 phút sau)
    + add() : sẽ lưu nếu chưa có 
        + ex : Cache::add('key', 'value', $seconds);
    + forever() : lưu một giá trị mãi mãi 
        + ex : Cache::forever('key', 'value');
    + forget() : xóa đi 
        + ex : Cache::forget('key');
        + ex : Cache::put('key', 'value', 0);  // xóa bằng hàm put() bằng cách thêm số 0 ở phía sau 
        + ex : Cache::put('key', 'value', -5); // xóa bằng hàm put() bằng cách thêm số âm ở phía sau 
    + flush() : xóa tất cả
        + ex : Cache::flush();
    + Thay vì dùng Cache::get('key'); thì ta có thể dùng Cache('key');
    Vào https://laravel.com/docs/8.x/cache => để đọc thêm một số hàm thao tác với cache 



buổi trước đã học : 
+ Authentication : xác thực 
    + Một ông đăng nhập hay chưa 
    + role nào ? admin hay user 

giờ tìm hiểu về : 
+ Authorization : phân quyền 
    + Một người có thể làm gì với đối tượng 
        + Người A có thể xóa bài viết hay không ?
        + User có thể xóa bài viết của người đó 
        + Sếp phân cho anh A => được rửa chén 
    + Cho một người nào đấy với quyền nào đấy

+ Quyền của anh A với bài viết B là gì ? 
+ Quyền của chị C với sản phẩm D là gì ? 
=> đó chính là chuyện của Authorization (phức tạp hơn Authentication một chút)

Trong laravel để tạo ra Authorization => gọi policy : 
app/Models/Article.php
làm cái này 
- Admin thì có quyền xóa tất cả bài viết 
- User có thể xóa bài viết của mình 

+ code vào database/migrations/2014_10_12_000000_create_users_table.php
 $table->string('role')->default('user');

+ C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel10>php artisan migrate:refresh

+ tạo file : database/seeds/UsersTableSeeder.php (để tạo dữ liệu mẫu cho admin và user)(khỏi tạo ở register của client thôi,chứ không có gì hết)
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel10>php artisan make:seeder UsersTableSeeder
Seeder created successfully
+ code vào file database/seeds/UsersTableSeeder.php
    use Illuminate\Support\Facades\Hash;
    use App\User;
    public function run(){
        User::create([
            'name' => 'admin Van Manh pro',
            'username' => 'admin',
            'role' => 'admin',
            'password' => Hash::make('123123123')
        ]);

        User::create([
            'name' => 'user binh thuong',
            'username' => 'user1',
            'role' => 'user',
            'password' => Hash::make('123123123')
        ]);
    }

+ code vào file : database/seeds/DatabaseSeeder.php
$this->call(UsersTableSeeder::class);

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel10>php artisan db:seed
Seeding: ArticlesTableSeeder
Seeded:  ArticlesTableSeeder (0.21 seconds)
Seeding: UsersTableSeeder
Seeded:  UsersTableSeeder (0.15 seconds)
Database seeding completed successfully.
(tạo dữ liệu mẫu thành công)

=> vào database table : articles : thì có 100 bài viết mẫu được tạo 
=> vào database table : users : thì có 2 tài khoản được tạo mẫu (một admin, một user)

+ code vào file : app/Models/Article.php
    protected $fillable = ['title','content','user_id'];
    public function user(){
        return $this->belongsTo('App\User');
    }

+ code vào file : app/User.php
    public function articles(){
        return $this->hasMany('App\Models\Article');
    }
+ code vào file : database/seeds/ArticlesTableSeeder.php
    public function run(){
        for($i=0;$i<100;$i++){
            Article::create([
                'title' => 'bai viet '.$i,
                'content' => 'noi dung '.$i,
                'user_id' => 1                  // cho 'user_id' => 1 để tất cả đều thuộc quyên của admin hết 
            ]);                                 // vì admin có id : 1 , user có id : 2 
        }
    }

+ C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel10>php artisan migrate:refresh
+ C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel10>php artisan db:seed

+ C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel10>php artisan make:controller ArticleController --resource
Controller created successfully.

+ code vào file routes/web.php 
Route::resource('/article','ArticleController'); // như đã biết => gọi đến index() trong file ArticleController.php 
    http://localhost:8000/article => vào hàm index() 
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel10>php artisan route:list

| POST      | article                | article.store     | App\Http\Controllers\ArticleController@store    | web       |http://localhost:8000/article
| GET|HEAD  | article                | article.index     | App\Http\Controllers\ArticleController@index    | web       |http://localhost:8000/article
| GET|HEAD  | article/create         | article.create    | App\Http\Controllers\ArticleController@create   | web       |http://localhost:8000/article/create
| PUT|PATCH | article/{article}      | article.update    | App\Http\Controllers\ArticleController@update   | web       |http://localhost:8000/article/1
| GET|HEAD  | article/{article}      | article.show      | App\Http\Controllers\ArticleController@show     | web       |http://localhost:8000/article/1
| DELETE    | article/{article}      | article.destroy   | App\Http\Controllers\ArticleController@destroy  | web       |http://localhost:8000/article/1
| GET|HEAD  | article/{article}/edit | article.edit      | App\Http\Controllers\ArticleController@edit     | web       |http://localhost:8000/article/1/edit
| GET|HEAD  | home                   | home              | App\Http\Controllers\HomeController@index       | web       |

    public function index(){
        return 'Danh sách bài viết';
    }
    http://localhost:8000/article => vào hàm index() 

    public function create(){
        return 'Thêm bài viết';
    }
    http://localhost:8000/article/create => vào hàm create() // Thêm bài viết 

    public function store(Request $request){
        return 'Lưu bài viết';
    }
    http://localhost:8000/article  // Lưu bài viết 

    public function show($id){
        return 'Hiển thị chi tiết bài viết ';
    }
    http://localhost:8000/article/1   // hiển thị chi tiết bài viết 1

    public function edit($id){
        return 'Sửa bài viết ';
    }
    http://localhost:8000/article/1/edit => vào hàm edit()  // sửa bài viết 1

    public function update(Request $request, $id){
        return 'Cập nhật bài viết ';
    }
    http://localhost:8000/article/1 // Cập nhật bài viết 1 

    public function destroy($id){
        return 'Xóa bài viết';
    }
    http://localhost:8000/article/1 // Xóa bài viết 1 

    + Nếu không chỉnh sửa gì => http://localhost:8000/article sẽ gọi đến và thực hiện cả index() và store() nhưng chỉ hiển thị hàm index()
    + Nếu không chỉnh sửa gì => http://localhost:8000/article/1 sẽ gọi đến và thực hiện cả update() show() destroy() nhưng chỉ hiển thị hàm show()
    + http://localhost:8000/article/create : Tạo bài viết 
    + http://localhost:8000/article/1/edit : Chỉnh sửa bài viết 

xử lí cái
- Admin thì có quyền xóa tất cả bài viết 
- User có thể xóa bài viết của mình 


admin : admin|123123123
user  : user1|123123123
đăng nhập vào rồi vào http://localhost:8000/article/1/edit => cả user và admin đều vào sửa bài viết được 
=> tạo ra một luật mà chỉ có user mới vào sửa được bài viết 

Các bước thao tác với Policy : 
    + Là một class định nghĩa quyền 
    + Tạo policy : php artisan make:policy [Tên_model]Policy --model=[một hoạt nhiều Thư mục chứa model đó nếu có]/[Tên_model]
    + Gắn policy với một model 
    + Đăng ký policy: authserviceprovider (vào file app/Providers/AuthServiceProvider.php) 
        + Đăng ký bằng tay 
        + Đăng ký tự động

Tạo policy : 
    + php artisan make:policy [Tên_model]Policy --model=[một hoạt nhiều Thư mục chứa model đó nếu có]/[Tên_model]   (chú ý phải đặt tên chính xác như thế này)
        (ex : C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel10>php artisan make:policy ArticlePolicy --model=Article)
        (ex : C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel10>php artisan make:policy ArticlePolicy --model=Models/Article)
        + ex : C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel10>php artisan make:policy ArticlePolicy --model=Models/Article
               Policy created successfully.
    => tạo ra file : app/Policies/ArticlePolicy.php.php => một lần nữa ta thấy laravel rất thông minh trong việc tự nhận biết để đặt tên 
    (nếu C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel10>php artisan make:policy ArticlePolicy thì file được tạo ra đơn giản)
    (nhưng nếu php artisan make:policy ArticlePolicy --model=Models/Article => tạo ra một loạt hàm trong file đó)
    (giống như kiểu file controller có --resource và file không có --resource vậy)

    + php artisan make:policy ArticlePolicy --model=Models/Article => ArticlePolicy.php sẽ được gắn với model Article.php, ngoài tạo ta các hàm có sẵn thì còn truyền vào biến rất là chính xác (Article $article)

+ Các hàm trong file policies 
    + viewAny     : Xem user này có được xem tất cả bài viết hay không 
    + view        : Xem user này có được xem bài viết cụ thể hay không 
    + create      : Xem user này có được tạo bài viết hay không 
    + update      : Xem user này có được cập nhật bài viết hay không 
    + delete      : Xem user này có được xóa bài viết hay không 
    + restore     : Xem user này có được khôi phục bài viết hay không 
    + forceDelete : Xem user này có được buộc xóa hay không  
    => nếu như trong hàm mà return true; => pass => người đăng nhập có quyền đó (ngược lại false thì không có quyền)     

    Policy Method        Controller Method         
    viewAny       :      index         
    view          :      show      
    create        :      create      
    create        :      store       
    update        :      edit        
    update        :      update      
    delete        :      destroy     

    => Với mỗi hàm trong file Policies nếu pass qua được sẽ vào được hàm tương ứng trong file Controller


+ code vào file app/Policies/ArticlePolicy.php.php
    + Chỉ đơn giản là : 
        public function update(User $user, Article $article){
            if($user->role == 'admin'){  // nếu người đăng nhập là admin thì là có quyền 
                return true;
            }
            if($article->user_id == $user->id){ // kiểm tra mà nếu user_id của bài viết đó và id của người đang đăng nhập giống nhau 
            // user_id của bài viết là id của user đăng bài viết đó 
            // tức là cùng một người, bài viết này của user này => có quyền 
                return true;
            }
            return false; // còn nếu không thì return false; không có quyền ;
        }
    + Các hàm khác cũng làm tương tự vậy, rất là đơn giản và dễ hiểu 
        + ex : public function delete(User $user, Article $article){
                   if($user->role == 'admin' || $article->user_id == $user->id){  
                       return true; // có quyền xóa 
                   }
                   return false; // không có quyền xóa 
               }  
    + Ngoài code đơn giản đó ra còn có thể code nhiều code logic theo ý mình, để tạo ra các luật nếu pass thì cấp quyền 

+ => sau khi code luật ở file app/Policies/ArticlePolicy.php => user vào file Controller 
    use App\Models\Article;
    public function __construct(){
        $this->authorizeResource(Article::class, 'article');
    }

 => ex : update() đi với edit => muốn áp dụng luật cho edit() trong file controller => truyền vào  
        public function edit(Article $article){
            return 'Sửa bài viết ';
        }
=> ex : delete() đi với destroy() => muốn áp dụng luật cho destroy() trong file controller => truyền vào
        public function destroy(Article $article){
            return 'Xóa bài viết';
        }

+ Đăng ký policy: authserviceprovider (vào file app/Providers/AuthServiceProvider.php) (đăng ký bằng tay)
    + protected $policies = [
          'App\Models\Article' => 'App\Policies\ArticlePolicy',
      ];

    + hoặc 
      use App\Models\Article;
      use App\Policies\ArticlePolicy;
      protected $policies = [
          Article::class => ArticlePolicy::class,
      ];


=> Vào http://localhost:8000/login để đăng nhập : user1|123123123
=> vào http://localhost:8000/article/1/edit (chỉnh sửa bài viết có id = 1)(để vào được edit của Controller => pass qua được update() của Policy)
=> vì ta đang đăng nhập : user1 (có id = 2) mà bài viết có user_id = 1 (ban đầu tạo dữ liệu mẫu => tất cả bài viết ta đều cho user_id = 1)
=> false => ($article->user_id != $user->id) không pass qua được => không có quyền  
=> Trả về : 403 | This action is unauthorized.

bây giờ vào bài viết có id = 1 sửa user_id thành 2 => vào : http://localhost:8000/article/1/edit (sửa bài viết có id = 1)
=> lúc này pass qua => hiển thị ra : Sửa bài viết 1 (vì user1 có id = 2 , ta sửa bài viết có id = 1, user_id = 1 thành user_id =2)
=> id của user1 = user_id = 2 => pass 

Tóm lại dùng Policy phải hết sức cẩn thận, code dễ nhưng phải cẩn thận 
Các bước thao tác với Policy : 
    + Là một class định nghĩa quyền 
    + Tạo policy : php artisan make:policy [Tên_model]Policy --model=[một hoạt nhiều Thư mục chứa model đó nếu có]/[Tên_model]
        + C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel10>php artisan make:policy ArticlePolicy --model=Models/Article
      
        Policy Method        Controller Method         
        viewAny       :      index         
        view          :      show      
        create        :      create      
        create        :      store       
        update        :      edit        
        update        :      update      
        delete        :      destroy  
        => Với mỗi hàm trong file Policies nếu pass qua được sẽ vào được hàm tương ứng trong file Controller 
            + code vào hàm public function update(User $user, Article $article)
            + code vào hàm public function delete(User $user, Article $article)
        => Từ đó muốn định nghĩa quyền cho hàm nào của file Controller => thì viết luật vào hàm tương ứng của file Policy
    + Code các quy tắc(luật) vào hàm trong file Policy
    + Gắn policy với một model (code vào file Model)
        use App\Models\Article;
        public function __construct(){
            $this->authorizeResource(Article::class, 'article');
        }
    + Truyền biến vào hàm trong file Controller tương ứng với hàm trong file Policy đã viết luật 
        public function edit(Article $article)     (update - edit)
        public function destroy(Article $article)  (delete - destroy)
    + Đăng ký policy: authserviceprovider (vào file app/Providers/AuthServiceProvider.php) 
        + Đăng ký bằng tay 
            + protected $policies = [
              'App\Models\Article' => 'App\Policies\ArticlePolicy',
              ];
            + hoặc 
              use App\Models\Article;
              use App\Policies\ArticlePolicy;
              protected $policies = [
                  Article::class => ArticlePolicy::class,
              ];
        + Đăng ký tự động 

đôi lúc nếu có quyền truy cập rồi mà vào http://localhost:8000/article/1/edit chưa được 
=> thì nên vào http://localhost:8000/article/1 => enter => 
=> rồi tiếp tục http://localhost:8000/article/1/edit => thì được 


(video49)

copy laravel10 sang laravel11 
copy database : auth48 sang database : auth49

.env 
DB_CONNECTION=mysql
DB_HOST=localhost
DB_PORT=3306
DB_DATABASE=auth49
DB_USERNAME=root
DB_PASSWORD=

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel11>php artisan config:cache

tiếp tục với Authorization, Policy
Tóm lại dùng Policy phải hết sức cẩn thận, code dễ nhưng phải cẩn thận 
Các bước thao tác với Policy : 
    + Là một class định nghĩa quyền 
    + Tạo policy : php artisan make:policy [Tên_model]Policy --model=[một hoạt nhiều Thư mục chứa model đó nếu có]/[Tên_model]
        + C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel10>php artisan make:policy ArticlePolicy --model=Models/Article
        Map : Policy tương ứng với Controller

        Policy Method        Controller Method         
        viewAny       :      index         
        view          :      show      
        create        :      create      
        create        :      store       
        update        :      edit        
        update        :      update      
        delete        :      destroy  
        restore       :      restore (soft delete)
        forceDelete   :      destroy (hard delete) (xóa vật lí, biến mất luôn)
        => Với mỗi hàm trong file Policies nếu pass qua được sẽ vào được hàm tương ứng trong file Controller 
            + code vào hàm public function update(User $user, Article $article)
            + code vào hàm public function delete(User $user, Article $article)
        => Từ đó muốn định nghĩa quyền cho hàm nào của file Controller => thì viết luật vào hàm tương ứng của file Policy
    + Code các quy tắc(luật) vào hàm trong file Policy
    + Gắn policy với một model (code vào file Model)
        use App\Models\Article;
        public function __construct(){
            $this->authorizeResource(Article::class, 'article'); (1)
        }
    + Truyền biến vào hàm trong file Controller tương ứng với hàm trong file Policy đã viết luật 
        public function edit(Article $article)     (update - edit)
        public function destroy(Article $article)  (delete - destroy)
    + Đăng ký policy: authserviceprovider (vào file app/Providers/AuthServiceProvider.php) 
        + Đăng ký bằng tay 
            + protected $policies = [
              'App\Models\Article' => 'App\Policies\ArticlePolicy',
              ];
            + hoặc 
              use App\Models\Article;
              use App\Policies\ArticlePolicy;
              protected $policies = [
                  Article::class => ArticlePolicy::class,
              ];
        + Đăng ký tự động 

(php artisan list : liệt kê ra các lệnh)
bình thường nếu chưa có policy thì : php artisan route:list sẽ in ra các route đối với các hàm tương ứng 
Nhưng nếu có policy vào thì khi C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel11>php artisan route:list
còn in ra thêm những hàm nào có thể vào những hàm nào không và các hàm Policy Method tương ứng với các hàm Controller Method 
ex : một số route sau ,.. 

                       (2)                                                                                                can...do something 
| POST      | article                | article.store     | App\Http\Controllers\ArticleController@store  | web   |can:create,App\Models\Article   |
| GET|HEAD  | article                | article.index     | App\Http\Controllers\ArticleController@index  | web   |can:viewAny,App\Models\Article  |
| DELETE    | article/{article}      | article.destroy   | App\Http\Controllers\ArticleController@destro | web   |can:delete,article              |
| GET|HEAD  | article/{article}/edit | article.edit      | App\Http\Controllers\ArticleController@edit   | web   |can:update,article              |
(can : có thể)

Chú ý : (1) là sau khi use App\Models\Article; => ghi vào (Article::class, 'article') , server sẽ nhận biết 'article' để lấy giá trị ở {article} (2)
=> giá trị {article} trong url ở (2) được truyền vào (1) => để đến kiểm tra xem (2) có được quyền truy cập không 
tóm tắt là : (Article::class, 'article') (1) => để chỉ đến phải kiểm tra url nào của model Article  => nhận biết được (2) => lấy giá trị {article} tại (2) => truyền lại vào (1) => policy, hàm $this->authorizeResource() kiểm tra xem (2) đó có quyền hay không, ( {article} là id của bài viết )


+ Một số lưu ý khi dùng Policy : 
Policy không phải giống như model hay controller hay Jobs,... hay gì khác, đôi lúc đúng nó vẫn không chạy theo ý mình, nên có một số lưu ý sau để chạy tốt hơn : 
    + đôi lúc nếu có quyền truy cập rồi mà vào http://localhost:8000/article/1/edit chưa được 
      => thì nên vào http://localhost:8000/article/1 => enter => 
      => rồi tiếp tục http://localhost:8000/article/1/edit => thì được 
    + Luôn luôn phải sửa dụng implicit binding 
        + Chính là bước Truyền biến vào hàm trong file Controller tương ứng với hàm trong file Policy đã viết luật 
        + ex : public function edit(Article $article)     (update - edit)
               public function destroy(Article $article)  (delete - destroy)
    + Đúng ra để tự động nhận : thì Nếu mà để model trong thư mục App\Models => đặt Policy ở trong thư mục Models\Policies 
      tức là Thư mục Policies chứa các policy thì phải nằm ngang hàng với các model 
      => ex : model Article nằm trong thư mục Models, thì thư mục Policies phải nằm trong thư mục Models để được ngang hàng với các model 
      (Bởi vì như những lần tạo model,nếu không tạo thêm thư mục Models để chứa các model cho gọn thì các model sẽ nằm trong thư mục app, và thư mục Policies cũng nằm trong thư mục app => ngang hàng nhau, nhưng nếu ta tạo thêm thư mục Models để chứa các model cho gọn thì đúng ra cũng phải di chuyển thư mục Policies vào thư mục Models để thư mục Policies cũng phải được ngang hàng với các model) thì nếu như này nó sẽ tự động nhận 
      Còn không thì cứ làm như trên đăng ký bằng tay cho nhanh, cho dễ hiểu 

    + Tự đặt quyền khác : tức là ngoài những hàm trong file Policy (viewAny, view, create, create, update, update, delete, restore, forceDelete)
      thì có thể tự viết ra hàm khác để đặt quyền khác 
        + code vào file app/Policies/ArticlePolicy.php
          public function blockArticle(User $user,Article $article){ // khóa bài viết  (3)
              return false; (4)
          }
        + tương ứng ta cũng phải Map qua hàm tương ứng bên file controller app/Http/Controllers/ArticleController.php
          public function block(Request $request, Article $article){ (1)
              $this->authorize('blockArticle',$article); // blockArticle là tên hàm tương ứng bên file policy (2)
          }
          // implicit binding (1) để có được biến $article => truyền vào hàm authorize (2) => Article $article (3) sẽ nhận $article ở (2)
        + code vào file web.php để thêm route cho hàm block trong file controller : Route::get('/article/block/{article}','ArticleController@block');
          => vào http://localhost:8000/article/block/1 => 403 | This action is unauthorized.  (4) => không có quyền truy cập 
          nếu sửa (4) => return true; => vào được http://localhost:8000/article/block/1
    + Thực ra Authorization cũng chính là đang tạo ra những Middleware
        => như đã nói ở trên : php artisan route:list => hiện ra các thông tin về | Domain | Method URI | Name | Action | Middleware
    
    Cách 1 của Authorization: authorize cho cả một file controller resource (như đã làm ở trên)
    Cách 2 của Authorization: authorize cho một hàm cụ thể (tương tự với thao tác tự đặt quyền khác như đã nói ở trên)
    + Có thể authorize cho riêng từng cái : ở trên là ta đang authorize cho cả một file controller resource (cách 1)
      + Gắn policy với một model (code vào file Model)
          use App\Models\Article;
          public function __construct(){
              $this->authorizeResource(Article::class, 'article'); (1)
          }
    Cách 3 của Authorization: authorize trực tiếp lên route luôn bởi vì nó là middleware
      + Còn nếu file controller không có --resource => ta có thể authorize riêng từng cài bằng tay 
        bỏ đi đoạn code :  use App\Models\Article;
                           public function __construct(){
                               $this->authorizeResource(Article::class, 'article'); (1)
                           }
        sau đó vào file web.php code : ex : Route::get('/...','...')->middleware(['auth','can:update,delete']); (1)
        can ở (1) : giống như can trong bảng php artisan route:list như đã nói ở trên (có thể làm được gì, cho phép làm được gì)
    Nhưng mà tốt hơn hết nên dùng cách 1, còn nếu muốn tự đặt quyền khác nữa thì dùng cách 1 kết hợp với cách 2 => đơn giản, dễ hiểu.
      Tìm hiểu thêm : Index method removed in authorizeResource ? #772, viewAny - index 
      Và một trong những cách khắc phục là : 
          vào file app/Http/Controllers/ArticleController.php code thêm (1) và (2) vào 
              class ArticleController extends Controller{
                public function __construct(){
                    $this->authorizeResource(Article::class, 'article',['except' => ['index']]); (1)
                }
                public function index(){
                    $this->authorize('viewAny' ,Article::class); (2)
                    return 'Danh sách bài viết';
                }
          vào file web.php code thêm : 
                Route::resource('/article','ArticleController')->except('index');
                Route::get('/article','ArticleController@index');
          nếu hàm public function viewAny(User $user){
                      return true; 
                  }
          => vào http://localhost:8000/article được (tức là có quyền truy cập hàm index())
          còn ngược lại return fale => không vào được http://localhost:8000/article được => không có quyền truy cập index()
      => đó là một trong những cách fix để có thể tạo luật giữa viewAny và index , nếu pass qua được viewAny thì vào được index, còn không thì không vào được index
      ngoài ra còn nhiều cách fix khác.

      tương tự giống như : public function create(User $user){ trong file policy 
                         
                           }
      những cái nào mà ban đầu trong hàm được truyền vào (User $user, Article $article) thì tức là hoạt động bình thường.không cần chỉnh gì cả.
      Còn cái nào mà chỉ có (User $user) giống create(),viewAny() => thì ta phải code thêm để 'fix' nó 
      ta có : Policy Method        Controller Method         
              viewAny       :      index         
              create        :      create   
      => giống như viewAny => fix index ở controller , create => fix create ở controller 
              public function __construct(){
                    $this->authorizeResource(Article::class, 'article',['except' => ['index','create']]); 
              }
              public function create(){
                  $this->authorize('create' ,Article::class);
                  return 'Thêm bài viết';
              }
              Route::resource('/article','ArticleController')->except(['index','create']);
              Route::get('/article','ArticleController@index');
              Route::get('/article','ArticleController@create');
      mà trong policy thì cũng chỉ có hai hàm viewAny,create là cần fix còn lại đều hoạt động bình thường hết .


tạo một project mới để làm 
Làm bảng kiểm soát,phân quyền : 
admin/Tên nhân viên    Xóa bài    Khóa User    Duyệt bài    Đổi pass
admin(sếp)               ok           ok          ok           ok 
nv Nguyễn Văn A          ok           no          ok           ok 

tạo project : qlct (quản lí công ty)
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel>composer create-project --prefer-dist laravel/laravel:^7.0 qlct
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\qlct>
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\qlct> php artisan serve
(C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel11>cd../qlct)(ta có thể cd gộp cả cd.. và cd qlct)
tạo Database : qlct 

.env 
DB_CONNECTION=mysql
DB_HOST=localhost 
DB_PORT=3306
DB_DATABASE=qlct
DB_USERNAME=root
DB_PASSWORD=

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\qlct>composer require laravel/ui:^2.4
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\qlct> php artisan ui vue --auth
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\qlct>npm install
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\qlct>npm run prod

(tạo bảng những bảng có sẵn của laravel : users,password_resets,failed_jobs)
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\qlct>php artisan migrate

+ code vào file 2014_10_12_000000_create_users_table.php
$table->string('role')->default('user'); // tất cả khoản được đăng kí mặc định là user 
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\qlct>php artisan migrate:refresh

vào http://localhost:8000/register
đăng kí : nguyenvan123@gmail.com|vanmanh123 , sửa role : user thành role : admin 

tạo middleware để bọc lại 
  C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\qlct>php artisan make:middleware RoleMiddleware
  Middleware created successfully.
  file app/Http/Middleware/RoleMiddleware.php được tạo ra 
  code vào file app/Http/Middleware/RoleMiddleware.php
  public function handle($request, Closure $next,$role){ (3) // $role được truyền vào giá trị từ web.php 
      if(auth()->user() && auth()->user()->role == $role){ (4)
          return $next($request);
      }
      abort(404,'Trang không tìm thấy');
  }

Đăng kí middleware RoleMiddleware vào file app/Http/Kernel.php 
  'role' => \App\Http\Middleware\RoleMiddleware::class, (2) //nhắt lại : App\Http\Middleware là namespace, RoleMiddleware là tên class của file RoleMiddleware.php 
   // => namespace và tên class dùng cực kì nhiều , mẹo (để ghi nhanh file đó thuộc thư mục nào => thì đa phần nó cũng giống tên class)
   // hầu hết trong laravel thì namespace giống như địa chỉ của file đó 

routes/web.php 
  Route::get('/admin', 'AdminController@index')->name('admin')->middleware('role:admin');  (1)
  nhắt lại, role ở (1) chính là từ (2), admin (1) là giá trị truyền đi(sau dấu : là một hoặc nhiều giá trị truyền đi)
  tại (3) , ngay sau Closure $next, là những biến để lấy giá trị truyền tới hay truyền vào hàm => $role = admin 
  (4) so sánh với $role, nếu mà = $role tức là = admin => return $next($request); => có quyền truy cập 

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\qlct>php artisan make:controller AdminController
Controller created successfully.
tạo file App\Http\Controllers\AdminController.php 
    public function index(){
        return view('home');
    }

(1) => đến http://localhost:8000/admin => gọi hàm index() trong file AdminController.php, hàm index() return view('home'); 
=> hiển thị nội dung file views : home.blade.php, nếu là admin thì hiển thị ra, còn không phải admin => 404 | Not Found

Đăng nhập vào => vào http://localhost:8000/admin => vào được trang home 
vào bảng users trong database sửa tài khoản nguyenvan123@gmail.com|vanmanh123 , sửa role : admin thành role : user
=> không vào được nữa => hiển thị 404 | Not Found

tạo thêm bảng 
permissions
    - id 
    - name 

user_permision 
    - id
    - permission_id 
    - user_id 

(bảng user quan hệ nhiều nhiều với bảng permissions)

tạo model để tạo luôn migration cho khỏe 
  C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\qlct>php artisan make:model Models/Permission -m
  Model created successfully. (tạo model thành công)
  Created Migration: 2021_09_19_091429_create_permissions_table (tạo file migration thành công)

+ code vào file app/Models/Permission.php
    class Permission extends Model{
        protected $fillable = ['name'];
    }
+ code vào file database/migrations/2021_09_19_091429_create_permissions_table.php
  $table->string('name');

+ tạo ra bảng chung : user_permission 
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\qlct>php artisan make:migration  create_user_permission_table
Created Migration: 2021_09_19_092226_create_user_permission_table (tạo file migration thành công)

+ code vào file : 2021_09_19_092226_create_user_permission_table.php 
    $table->integer('user_id');
    $table->integer('permission_id');

tạo mối quan hệ nhiều nhiều 
+ code vào file app/User.php (bảng users)
    public function permission(){
        return $this->belongsToMany('App\Models\Permission');
    }
+ code vào file : app/Models/Permission.php (bảng permissions)
    public function users(){
      return $this->belongsToMany('App\User');
    }

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\qlct>php artisan migrate
Migrated:  2021_09_19_091429_create_permissions_table (0.14 seconds)
Migrated:  2021_09_19_092226_create_user_permission_table (0.07 seconds)
(tạo bảng thành công)

tạo seeder (dữ liệu mẫu)
    1 - create - post 
    2 - block - user 
...

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\qlct>php artisan make:policy UserPolicy --model=User
Policy created successfully.

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\qlct>php artisan make:policy ArticlePolicy --model=Article
Policy created successfully.

giả sử tạo quyền tạo bài viết : 
+ code vào file : app/Policies/ArticlePolicy.php

    public function create(User $user){
        $permission = $user->permissions()->where('name','create_article')->first();
        if($permission){
            return true;
        }
        return false;
    }

...

- Làm Menu đa cấp : 

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\qlct>php artisan make:model Models/Menu -m
Model created successfully. (tạo file model thành công)
Created Migration: 2021_09_19_094533_create_menus_table (tạo file migration thành công)

+ code vào file : 2021_09_19_094533_create_menus_table.php 
    $table->string('text');
    $table->string('link');
    $table->integer('parent_id')->nullable(); // để xác định menu cha nưa nó 

+ code vào file app/Models/Menu.php
    public function parent(){
      return $this->belongsTo('App\Models\Menu'); // quan hệ một nhiều với chính nó 
    }
    public function children(){ 
      return $this->hasMany('App\Models\Menu'); // quan hệ một nhiều với chính nó 
    }

Menu gốc là những cái không có parent_id (không có thằng cha)

+ code vào file : app/Http/Controllers/AdminController.php
  use App\Models\Menu;
  class AdminController extends Controller{
      public function index(){
        $menu = Menu::whereNull('parent_id') //lấy ra những thằng mà không có parent_id 
                      ->get();
        dd($menu);
        return view('home');
      }
  }

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\qlct>php artisan migrate
Migrating: 2021_09_19_094533_create_menus_table
Migrated:  2021_09_19_094533_create_menus_table (0.18 seconds)

Đăng nhập xong vào => http://localhost:8000/admin
(dd($menu);) thì ta được 
Illuminate\Database\Eloquent\Collection {#1021 ▼
  #items: array:2 [▼
    0 => App\Models\Menu {#615 ▶}
    1 => App\Models\Menu {#983 ▶}
  ]
}

+ code thêm vào file app/Models/Menu.php
    public function parent(){
      return $this->belongsTo('App\Models\Menu', 'parent_id'); // quan hệ một nhiều với chính nó 
    }

    public function children(){ (1)
      return $this->hasMany('App\Models\Menu', 'parent_id'); // quan hệ một nhiều với chính nó 
    }

+ code thêm vào file app/Http/Controllers/AdminController.php
    $menus = Menu::whereNull('parent_id')
             ->with('children') (2) 
              ->get();

(2) xuất phát từ (1)


+ code thêm vào file app/Http/Controllers/AdminController.php
    use App\Models\Menu; (1)
    public function index(){
        $menus = Menu::whereNull('parent_id') (2)
             ->with('children') (3)
              ->get();
         // dd($menus);
        echo '<ul>';
        foreach ($menus as $menu){ (4)
            echo '<li>'.$menu->text.'</li>';
            echo '<br>';
            echo '<ul>';
            foreach ($menu->children as $childMenu){
              echo $childMenu->text;
              echo '<br>';
            }
            echo '</ul>';
        }
        echo '</ul>';

      return view('home');
    }

tạo dữ liệu 
id            text          link          parent_id
1            Lap trinh       abc           null 
2            Cuoc song       mnd           null
3              Php          hjev            1
4              Css          sine            1
5              Javascript   ahwe            1
6             Nau an         abddhf         2

Nhắt lại : (1) sau khi đã use thì dùng class Menu như là class của file AdminController.php
mà model Menu như là bảng database menus 
tiếp đến tạo biến $menu (2) => biến $menus là bảng gồm những hàng dữ liệu không có parent_id(collection array, mỗi phần tử là một hàng dữ liệu,(mỗi phần tử là một object))(thằng cha to nhất)(tiêu đề to nhất)
1            Lap trinh       abc           null 
2            Cuoc song       mnd           null
(3) => use class Menu rồi => tạo biến => rồi dùng hàm children của class đó  
(4) => biến $menus sau khi lặp ra, $menu là mỗi phần tử => là mỗi dòng dữ liệu cụ thể của bảng 
là các dòng  
+ 1            Lap trinh       abc           null 
+ 2            Cuoc song       mnd           null
$menu->children là thực hiện hàm ->children (trả về những tiêu đề con của tiêu đề đó)(những tiêu đề mà có parent_id = id của tiêu đề đó) là mỗi biến $childMenu
$menu là + 1            Lap trinh       abc           null 
thì có các tiêu đề con là các $childMenu
3              Php          hjev            1
4              Css          sine            1
5              Javascript   ahwe            1

$menu là + 2            Cuoc song       mnd           null
thì có các tiêu đề con là các $childMenu
6             Nau an         abddhf         2
và $childMenu->text; là in ra tên tiêu đề đó 

Lap trinh
    PHP
    Css
    javascript

Cuoc Song
    Nau an

=> đó mới là menu 2 cấp 

tiếp tục làm để có menu đa cấp 
tạo thêm dữ liệu ta được 
id            text          link          parent_id
1            Lap trinh       abc           null 
2            Cuoc song       mnd           null
3              Php          hjev            1
4              Css          sine            1
5              Javascript   ahwe            1
6             Nau an         abddhf         2
7             Php co ban     jjdjds         3
8             Php nang cao   jjjfeksw       3
(link điền đại kiểu tượng trưng thôi)
=> Thì : 3              Php          hjev            1
sẽ có hai thằng con là 
7             Php co ban     jjdjds         3
8             Php nang cao   jjjfeksw       3
vì 7,8 có parent_id = id của 3
=> menu cấp 3 

+ code thêm vào file app/Models/Menu.php 
    public function children(){
        return $this->hasMany('App\Models\Menu', 'parent_id')
              ->with('children'); // quan hệ một nhiều với chính nó  // thật ra dòng này bị thừa, không có cũng được, đễ như cũ cũng được 
    }

+ code vào file app/Http/Controllers/AdminController.php
    public function index(){
        $menus = Menu::whereNull('parent_id')
             ->with('children') 
              ->get();
        // dd($menus);
        echo '<ul>';
        foreach ($menus as $menu){
            echo '<li>'.$menu->text.'</li>';
            echo '<br>';
            echo '<ul>';
            foreach ($menu->children as $childMenu){
                echo $childMenu->text;
                echo '<br>';
                echo '<ul>';
                foreach ($childMenu->children as $chaudMenu){ // thằng cháu, là những thằng ex : Php co ban, Php nang cao
                    echo $chaudMenu->text;
                    echo '<br>';
                }
                echo '</ul>';
            }
            echo '</ul>';
        }
        echo '</ul>';

      return view('home');
    }

Lap trinh
    PHP
        Php co ban 
        Php nang cao 
    Css
    javascript

Cuoc Song
    Nau an

=> xong cấp 3 

=> dùng while để tối ưu code, không dùng nhiều foreach 

  public function showMenu($menus){  
      echo '<ul>';
      foreach ($menus as $menu){   (4)  
          echo '<li>'.$menu->text.'</li>';
          echo '<br>';
          if($menu->children){   (5)         
            $this->showMenu($menu->children); (6)
          }
          echo '</ul>';
      }
  }

  public function index(){
      $menus = Menu::whereNull('parent_id') (1)
             ->with('children') (2)
              ->get();

      $this->showMenu($menus); (3)

      return view('home');
  }



Route::get('/admin', 'AdminController@index')->name('admin')->middleware('role:admin');
=> khi mà vào http://localhost:8000/admin => chạy hàm index() của AdminController.php 
=> (1) khai báo và gọi hàm 
(2) ->with('children') 
(3) : gọi hàm showMenu() và truyền biến $menus vào, như đã nói ở trên $menus là một bảng gồm những hàng dữ liệu mà không có parent_id tức là những tiêu đề lớn nhất.
(4) : hàm sẽ thực hiện lặp qua hết các phần tử trong conllection $menus mỗi phần tử được lặp qua là $menu,xuất ra text của từng phần tử đó 
(5) : cho vào if : $menu->children, $menu gọi hàm children,nếu như mà $menu còn chứa những phần tử con => $menu->children có phần tử => tồn tại 
=> $menu->children là truthy => if(truthy) => đúng đồng thời cũng biết trong $menu còn chứa các phần tử con => thực hiện câu lệnh trong if
(6) : gọi lại hàm showMenu đông thời truyền biến vào 
(5),(6) là đệ quy . cứ như thế phần tử nào có phần tử con thì tiếp tục thực hiện hàm,... cho đến khi không còn phần tử nào chứa phần tử con 
tức là đến tiêu đề bé nhất thì dừng.

+ Bây giờ giả sử 
thêm các dữ liệu vào bảng ta được 
id            text                        link          parent_id
1            Lap trinh                    abc             null 
2            Cuoc song                    mnd             null
3              Php                        hjev             1
4              Css                        sine             1
5              Javascript                 ahwe             1
6             Nau an                      abddhf           2
7             Php co ban                  jjdjds           3
8             Php nang cao                jjjfeksw         3
9             Php co ban level 1          sdvnks           7
10            Php co ban level 2          knks             7
11            es6                         cknksa           5

=> 9,10 là con của 7
=> 11 là con của 5 
ta được 

Lap trinh
    PHP
        Php co ban 
            php co ban level1
            php co ban level 2
        Php nang cao 
    Css
    javascript
        es6
Cuoc Song
    Nau an

Ta thấy phần trên cực kì hay và quan trọng, bởi vì chỉ cần vài dòng code backend, và một bảng database thì ta đã có thể làm menu đa cấp một cách nhanh gọn. 
Nếu làm bằng css,js thuần thì đến cấp 3,4 thôi là thấy nhiều code rồi. 
=> Từ đây càng thấy sức mạnh của backend. Học càng tốt backend vận dùng nhiều vào thực tế càng tốt.
Phần làm menu đa cấp hay, vì sau này có thể sẽ dùng nhiều.

(video50)

Xong Lravel  
Xong Back-End 

Chuuyển qua học Docker và những kiến thức Laravel nâng cao khác , kết hợp Laravel + Vuejs.
Docker và những kiến thức tổng hợp : Html Css Bootstrap Js Jquery Vuejs Php Lavel mySQL api và những kiến thức khác.











ghichu1






---------------------------------------------------------------------

//(video39)
routes/web.php 
app/http/controller/UserController.php
routes/api.php 
resources/views/welcome.blade.php
resources/views/xinchao.blade.php
app/http/controller/ArticleController.php
app/http/controller/Admin/ManageUser.php 
app/User.php
app/Book.php
app/Models/Person.php 

ví dụ về mvc 
Mô hình mvc: model - view - controller 
giả sử ta có game chiến đấu giữa các con vật 
- Ứng dụng: chia thành 3 phần : 
    + model: class, thực thể trong ứng dụng 
        + các class conVoi,class conCasau,... được tạo ra 
    + controller: thành phần xử lí 
        + làm nhiệm vụ xử lí logic 
        + new conVoi , new conCasau 
        + conVoi.danh(caSau),...
    + view: thành phần hiển thị (giống bên vuejs là <template></templace>)
        + hiển thị hai con đó đánh nhau 


giả sử có website tin tức 
+ model : articles 
+ controller: hiển thị các bài viết 
    + new article 
+ Hiển thị bài viết : view => html


Resource: (là một nguồn tài nguyên mà có những thao tác này)
Bài viết:
+ /article/list => get list: lấy danh sách bài viết 
+ /article/detail => get: đọc bài viết 
+ /article/edit => edit:sửa bài viết 
+ /article/update => update: cập nhật bài viết 
+ /article/delete => delete: xóa bài viết


Dùng Windows Power Shell để khởi động project 
Dùng CMD để thực thi lệnh trên đó 

/*
Bài này ta đã học được kiến thức về 
Mô tả khái quát các phần: 
- routes 
    + file web.php : chứa các route cho web (chứa các đường dẫn cho web)(chứa các đường dẫn cho các file controller,cho các file .blade.php)
        + Đối với các file .php trong controller: 
            + không có --resource :
                + Router::get() 
                    ex : Route::get('/login','UserController@login');
            + có --resource :
                + Router::resource()
                    ex : Route::resource('/article','ArticleController');
        + Đối với các file .blade.php trong views:
            + Router::get() rồi return view
                ex : Route::get('/', function () {
                         return view('welcome');
                     });
            +  Router::view() , Router trực tiếp đến view 
                ex : Route::view('/welcome','welcome');
        + Có thể tạo nhiều đường dẫn cho một file 
            + Route::view('/welcome','welcome'); // http://localhost:8000/welcome
              Route::view('/abc','welcome');     // http://localhost:8000/abc
              => đều gọi đến file welcome.blade.php
            + Route::resource('/article','ArticleController'); // http://localhost:8000/article
              Route::resource('/baiviet','ArticleController'); // http://localhost:8000/baiviet
              => đều gọi đến file ArticleController.php
            => Đấy là tìm hiểu thêm như vậy ,còn thực tế nếu không vì mục đích gì thì cũng không nên cho một file có nhiều đường dẫn 
            + Vậy đặt trường hợp một đường dẫn chạy nhiều file thì sao => 
            ex : Route::get('/welcome','UserController@login'); 
                 Route::get('/', function () {
                     return view('welcome');
                 });
                 Route::view('/welcome','welcome');
                 Route::resource('/welcome','ArticleController');
            => Nó sẽ chạy theo thứ tự ưu tiên 
                 Route::resource (file controller.php có resource trước) đến 
                 Route::view (file .blade.php trong thư mục view) đến (Route trực tiếp đến view)
                 Route::get() (file controller.php không có resource) đến 
                 Route::get() return view (file .balde.php trong thư mục view) get rồi mới return view 
            => Và đây cũng là tìm hiểu thêm thôi , chú có bao giờ cho nhiều file cùng một đường dẫn để làm gì đâu 

            => Cứ đặt mỗi đừng dẫn cho mỗi file cho nó đơn giản 

            nó sẽ chạy file controller .php 
    + file api.php : tương tự  
- resources 
    - views : 
        + chứa các file .blade.php  (cơ bản dễ thấy nhất là chứa code hiển thị client html)
        + được tạo bằng tay 
- app
    - http 
        - controller : 
            + chứa các file : controller.php 
            + thường được tạo bằng cách dùng CMD:  
                + C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel1>php artisan make:controller UserController  (không resource)
                + C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel1>php artisan make:controller ArticleController --resource (có resource)
                + C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel1>php artisan make:controller Admin/ManageUser (thêm vào thư mục Admin)
                => tương ứng tạo ra các file UserController.php ArticleController.php Admin/ManageUser.php
            + đặt điểm khác biệt giữa có --resource và không có --resource
                + không có --resource : 
                    + Không có các hàm có sẵn 
                    + Máy chỉ tạo ra chủ yếu là khung của file 
                    + Khi viết các hàm vào thì muốn thực hiện phải gọi rõ ràng ra ở file web.php 
                + có --resource : 
                    + Có các hàm có sẵn theo quy chuẩn : index,create,store, show, edit, update, destroy.
                    + Máy tạo tự động tạo ra các hàm index,create,store, show, edit, update, destroy cho chúng ta.
                    + Không cần ghi rõ đường dẫn rõ ràng chi tiết ở file web.php , khi mà gõ link ở url là tự động load và gọi đến các hàm đó 

Bây giờ đến sự liên kết giữa các phần:
(ex : 1)
- app
    - http 
        - controller : 
                Giả sử ta có một file được tạo ra bằng CMD UserController.php (không có --resource) 
                cơ bản có nội dung chính sau :  public function login(){
                                                    return 'Đây là trang login';
                                                }
- resources 
    - views : 
- routes 
    + file web.php :  
                Route::get('/login','UserController@login');
                => khi ta vào http://localhost:8000/login thì sẽ có ''Đây là trang login' , cơ bản là nó sẽ trả về những thứ gì có trong hàm 
                login , nằm trong file UserController.php 
                (Về file@hàm phải ghi cho đúng , tức là trong thư mục controller có file UserController.php , trong file đó có chứa hàm login thì phải ghi cho đúng , còn về phần đường dẫn có thể ghi theo ý ta,Route::get('/abc','UserController@login'); cũng được => thì truy cập đến http://localhost:8000/abc để thấy nội dung của hàm login)
                (Các file khác cũng tương tự , các file khác nằm trong thư mục views cũng tương tự)
                (Nhưng thường thì nên đặt đường dẫn giống với tên các hàm cho dễ hiểu và dễ nhớ)


    + file api.php :  
(ex : 2)
- controller : 
                Giả sử ta có một file được tạo ra bằng CMD ArticleController.php (có --resource) 
                => máy sẽ tự động tạo ra một loạt các hàm index,create,store, show, edit, update, destroy.
                giả sử trong các hàm ta sẽ return ra thứ gì đó : 
                                                                 public function index(){
                                                                         return 'Index Danh sách bài viết.';
                                                                     }
                                                                 public function create(){
                                                                         return 'Thêm bài viết';
                                                                     }
                                                                 public function store(Request $request){
                                                                         return 'store';
                                                                     }
                                                                 public function show($id){
                                                                         return 'show';
                                                                     }
                                                                 public function edit($id){
                                                                         return 'Chỉnh sửa bài viết .';
                                                                     }
                                                                 public function update(Request $request, $id){
                                                                         return 'Cập nhật bài viết .';
                                                                     }
                                                                 public function destroy($id){
                                                                         return 'Destroy';
                                                                     }
- resources 
    - views : 
- routes 
    + file web.php :  
                Route::resource('/article','ArticleController'); 
                => Chỉ cần ghi như thế này là đủ 
                => http://localhost:8000/article        => tự động gọi hàm index  => hiển thị ra 'Index Danh sách bài viết.'
                => http://localhost:8000/article/create => tự động gọi hàm create => hiển thị ra 'Thêm bài viết'
                => http://localhost:8000/article/... => tự động gọi hàm ...
    + file api.php :  
(ex : 3)
- app
    - http 
        - controller : 
- resources 
    - views : 
        + tạo bằng tay file : xinchao.blade.php 
        + có nội dung cơ bản sau : 
                                   <!DOCTYPE html>
                                   <html lang="en">
                                   <head>
                                       <title>Xin chao</title>
                                       <meta charset="utf-8">
                                       <meta name="viewport" content="width=device-width, initial-scale=1">
                                       <meta http-equiv="X-UA-Compatible" content="ie=edge">
                                   </head>
                                   <body>
                                       <h1>Xin chào</h1>
                                   </body>
                                   </html>
- routes 
    + file web.php :  
        Route::view('/xinchao','xinchao'); 
        => http://localhost:8000/xinchao
        => Hiển thị ra nội dung file xinchao.blade.php :hiện 'Xin chào' ở màn hình 
        (Như đã nói ở trên đối với file phải ghi cho đúng , còn lại url ta tự đặt tùy ý)
        (Nếu là Route::view('/xyz','xinchao'); => thì vào http://localhost:8000/xyz để thấy nội dung file xinchao.blade.php)

        Hoặc là Route::view trực tiếp,hoặc là Route::get rồi return view như ở dưới cũng được
    + file api.php :  

(Lúc đầu tiên khi mà cài đặt xong vào http://localhost:8000/ => hiện ra giao diện laravel => đó chính là đang gọi đến file welcome.blade.php trong views : 
web.php : 
    Route::get('/', function () {
       return view('welcome');
    });
)


- Còn về phần model như đã nói ở trên ta chỉ mới dừng ngang cách tạo ra các file model 
Qua những giải thích chi tiết phía trên => hiểu rõ hơn về mô hình mvc 
Mô hình mvc: model - view - controller 
- Ứng dụng: chia thành 3 phần : 
    + model: class, thực thể trong ứng dụng 
        + conVat,conVoi,... 
        + Articles,category,user 
    + controller: thành phần xử lí 
        + làm nhiệm vụ xử lí logic 
        + gọi các model lên => tương tác với nhau
    + view: thành phần hiển thị (giống bên vuejs là <template></templace>)
     
- Truy cập web : (trình tự khi một người truy cập web)
    + router : 
    + controller => model 
    + view 
Khi user bắt đầu truy cập vào web => (truy cập đến các url có trong file web.php) 
(- routes sẽ gọi đến các file views blade.php , các file controller .php và các hàm trong file đó , tương ứng với các đường dẫn đó 
=> các controller xử lí => gọi đến các model => xử lí => hiển thị lại với user) 
*/


//(video40)

.env 
config/app.php 
routes/web.php
resources/views/xinchao.blade.php 
config/game.php 
app/Http/Controller/UserController.php 
app/Http/Requests/LoginRequest.php 
app/Http/Controller/ArticleController.php
(resources/views/welcome.blade.php chỉ mở đọc)
views/article.blade.php
views/master.blade.php
views/inheritanceTemplate.blade.php
views/parts/div.blade.php
app/database/migrations (mở đọc)
database : tintuc3 
migrations/2021_09_06_160627_create_articles_table.php

- config: Configuration (Cấu hình)
    - .env    (file .env trong thư mục laravel2 (thư mục project))
    - /config (thư mục laravel/config)
    - Hàm env()
        - Lấy biến môi trường theo thứ tự 
            + vào file app.php trong thư mục config có các hàm env()
            ex : 'name' => env('APP_NAME', 'Laravel'), : sẽ có hai tham số được truyền vào : 'APP_NAME','Laravel'
            nếu như không tìm ra tên biến APP_NAME thì nó sẽ lấy giá trị mặc định là : 'Laravel'
            (nếu tìm thấy tên biến thì sẽ lấy giá trị đó)
            (vào file .env sẽ có APP_NAME=Laravel, giả sử APP_NAME=shop , nếu không tìm thấy APP_NAME=shop thông qua câu lệnh
            'name' => env('APP_NAME', 'Laravel'), thì nó sẽ lấy giá trị mặc định là 'Laravel')
        + Lấy biến của server (Vào CMD export APP_NAME=Laravel)
            + Vào file .env có APP_NAME=Laravel , thì ví dụ khi vào CMD export APP_NAME=Manh , thì biến này nó sẽ gắn với máy tính luôn,nếu lên mạng thì là máy chủ,(biến này nằm ở trong máy luôn),tức là khi ta quản lí một web nào đó,thì export APP_NAME=Manh,(tên APP), sẽ thay đổi,không còn APP_NAME=Laravel nữa mà là APP_NAME=Manh.Còn APP_ENV=local (APP_ENV : là môi trường hiện tại), khi mà chạy thì server sẽ xem xét xem đang chạy ở môi trường nào , ví dụ ban đầu khi mà cài đặt server thì cho APP_ENV=production (chế độ chạy thật) thì laravel sẽ dựa theo server để chạy ,APP_ENV=production (chế độ chạy thật) thì nó sẽ không hiện một lỗi nào ra người dùng cả , còn ví dụ : đặt môi trường là testing (đang test) thì nó sẽ hiển thị lỗi.
        + Lấy từ file .env 
            Thật ra khi mà làm thật thì vào thẳng file .env để chỉnh luôn cho khỏe. 
            Có sẵn tất cả, vào đó điều chỉnh phù hợp là được.
            Hoặc ví dụ vào file config/queue.php có 'default' => env('QUEUE_CONNECTION', 'sync'),
            vào file .env thêm QUEUE_CONNECTION=database chẳng hạn , thì khi server đọc thì nó sẽ ưu tiên lấy từ .env là QUEUE_CONNECTION=database , còn nếu không có thì nó mới lấy giá trị QUEUE_CONNECTION=sync
        + Lấy từ file trong thư mục config (app.php,queue.php,...)


Khi đi làm :
+ Nhiệm vụ mình là code tính năng Thêm bài viết chẳng hạn : 
    + Code thêm bài viết 
    + migration của bảng articles 
=> phải nộp cả hai cái 

//(video41)


(Tìm hiểu thêm,không dùng cách này : Trường hợp nếu như mà sau khi tạo xong rồi ta có sửa hay thêm một cột nào đó vào (code thêm một cột vào migration)
thì phải làm sao đó php artisan migrate:rollback để xóa file đó rồi php artisan migrate để chạy lại => lúc này cột mới xuất hiện tại bảng trong database tintuc3 ex thêm cột(trường) username vào articles thì code $table->string('username'); vào file 
=> php artisan migrate:rollback đến lúc nào xóa bảng articles , rồi chạy php artisan migrate để tạo lại bảng => lúc này sẽ có cột đó .
Điều đặt ra là giả sử bảng articles ta tạo đầu tiên hoặc lần nào đó , sau đó ta tạo thêm một loạt bảng nữa ,giả sử dùng 10 câu lệnh 
php artisan migrate (một câu lệnh này có thể tạo một lần nhiều bảng) => thì phải php artisan migrate:rollback 10 lần để mới đến được lần tạo bảng articles để xóa nó.
=> tốn thời gian . => php artisan migrate:refresh , chỉ là tìm hiểu thêm, không dùng cách này)


+ Refresh : 
    + php artisan migrate:refresh
    + xóa toàn bộ database => migrate lại 
    => khi chạy Refresh thì cần phải đặt biệt lưu ý 
    (php artisan migrate:refresh giống như php artisan migrate:rollback lại toàn bộ (xóa hết) rồi php artisan migrate tạo lại hết)
    (chỉ là tìm hiểu thêm, không dùng cách này để cập nhật cột thêm cột vào các file => xóa tất cả => chạy lại tất cả một lần => nhiều file sẽ đồng loạt được cập nhật cột(trường))
    (Ban đầu trong laravel3 ở thư mục migrations chưa có gì => muốn tạo lại một số bảng như laravel2 => copy file của bảng đó vào thư mục migrations của laravle3 rồi chạy php artisan migrate:refresh là được)
    + Khi mà update serve sẽ thường dùng : php artisan migrate:refresh

=> Cập nhật cột phải dùng : add_[tên cột]_to_[tên bảng]_table : Thêm một cột vào bảng 


+ Những lỗi này đều bắt nguồn từ các câu lệnh chạy hàng loạt như 
            + php artisan migrate:reset (xóa hết)
            + php artisan migrate:refresh (xóa hết => tải lại hết)
            + php artisan db:seed (chạy toàn bộ database) 
        + Giả sử như trên ta không muốn chạy php artisan db:seed --class=ArticlesTableSeeder
        mà ta thêm Vào file : database/seeds/DatabaseSeeder.php code thêm : $this->call(ArticlesTableSeeder::class);
        rồi php artisan db:seed => dữ liệu ở file ArticlesTableSeeder.php thì được thêm mới , nhưng dữ liệu trước đó của file 
        UsersTableSeeder.php lại được thêm vào database vì chạy php artisan db:seed là chạy hết
        => Cách khắc phục : 
            + Xóa hết database đã thêm vào trước đó ở bảng articles
            + Hoặc bỏ đi dòng $this->call(UsersTableSeeder::class); (không chạy file UsersTableSeeder.php khi chạy file DatabaseSeeder.php) 
        + Một số lỗi khác như : ghi tên cột không đúng : trong articles có cột votes nhưng lại ghi 'vote'=>$faker->name,
                                thiếu dấu,... 'email'=>$faker->name           (giữa hai dòng không có dấu ',') 
                                              'votes'=>$faker->name,
        + Tất cả lỗi trên đều có thể tạo ra lỗi "671" : 
        at C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3\vendor\laravel\framework\src\Illuminate\Database\Connection.php:671
          667|         // If an exception occurs when attempting to run a query, we'll format the error
          668|         // message to include the bindings with SQL, which will make this exception a
          669|         // lot more helpful to the developer instead of just the database's errors.
          670|         catch (Exception $e) {
        > 671|             throw new QueryException(
          672|                 $query, $this->prepareBindings($bindings), $e
          673|             );
          674|         }
          675|

        => Cách fix là cứ chú tâm và những gì mình đã code và fix nó 
        + Máy cũng sẽ thông báo cho ta biết lỗi là gì ở file nào dòng nào (xem dưới ghi chú , ghi chú 2)

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3>php artisan db:seed
Seeding: UsersTableSeeder
Seeded:  UsersTableSeeder (0.28 seconds)
Seeding: ArticlesTableSeeder

   Illuminate\Database\QueryException

  SQLSTATE[HY000]: General error: 1364 Field 'votes' doesn't have a default value (SQL: insert into `articles` (`title`, `content`, `author`) values (Alice., Voluptatibus porro sit voluptas placeat. Placeat sint id tenetur sit. Corporis consequatur eveniet deserunt quo tenetur doloribus. Quibusdam dolorem velit illo laboriosam veniam omnis deleniti., Mr. Liam Pfeffer))

  at C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3\vendor\laravel\framework\src\Illuminate\Database\Connection.php:671
    667|         // If an exception occurs when attempting to run a query, we'll format the error
    668|         // message to include the bindings with SQL, which will make this exception a
    669|         // lot more helpful to the developer instead of just the database's errors.
    670|         catch (Exception $e) {
  > 671|             throw new QueryException(
    672|                 $query, $this->prepareBindings($bindings), $e
    673|             );
    674|         }
    675|

  1   C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3\vendor\laravel\framework\src\Illuminate\Database\Connection.php:464
      PDOException::("SQLSTATE[HY000]: General error: 1364 Field 'votes' doesn't have a default value")
  => lỗi sai cột votes nhưng ghi vote (1)

  2   C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3\vendor\laravel\framework\src\Illuminate\Database\Connection.php:464
      PDOStatement::execute()

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3>composer dump-autoload
Generating optimized autoload files
> Illuminate\Foundation\ComposerScripts::postAutoloadDump
> @php artisan package:discover --ansi
Discovered Package: facade/ignition
Discovered Package: fideloper/proxy
Discovered Package: fruitcake/laravel-cors
Discovered Package: laravel/tinker
Discovered Package: nesbot/carbon
Discovered Package: nunomaduro/collision
Package manifest generated successfully.
Generated optimized autoload files containing 4528 classes

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3>php artisan db:seed
Seeding: UsersTableSeeder

   Illuminate\Database\QueryException

  SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry 'nguyenvanmanh@gmail.com' for key 'users_email_unique' (SQL: insert into `users` (`name`, `email`, `password`, `updated_at`, `created_at`) values (Manh, nguyenvanmanh@gmail.com, $2y$10$aluL2mvumDkU5jsd5vp1Cup4OyH3lZtqj1BR405NG5EivohRBZSg2, 2021-09-09 03:39:29, 2021-09-09 03:39:29))

  at C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3\vendor\laravel\framework\src\Illuminate\Database\Connection.php:671
    667|         // If an exception occurs when attempting to run a query, we'll format the error
    668|         // message to include the bindings with SQL, which will make this exception a
    669|         // lot more helpful to the developer instead of just the database's errors.
    670|         catch (Exception $e) {
  > 671|             throw new QueryException(
    672|                 $query, $this->prepareBindings($bindings), $e
    673|             );
    674|         }
    675|

  1   C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3\vendor\laravel\framework\src\Illuminate\Database\Connection.php:464
      PDOException::("SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry 'nguyenvanmanh@gmail.com' for key 'users_email_unique'")
      => lỗi đã có dữ liệu ở bảng users nhưng do chạy tất cả nên lại thêm dữ liệu này vào lại (2)

  2   C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3\vendor\laravel\framework\src\Illuminate\Database\Connection.php:464
      PDOStatement::execute()

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3>php artisan db:seed
Seeding: UsersTableSeeder

   Illuminate\Database\QueryException

  SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry 'nguyenvanmanh@gmail.com' for key 'users_email_unique' (SQL: insert into `users` (`name`, `email`, `password`, `updated_at`, `created_at`) values (Manh, nguyenvanmanh@gmail.com, $2y$10$cUTSkBDOnBUBkBKRVSlYteO4rXJ1Rwgz4NaHi9zVsm5hymS3DtqYK, 2021-09-09 03:44:40, 2021-09-09 03:44:40))

  at C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3\vendor\laravel\framework\src\Illuminate\Database\Connection.php:671
    667|         // If an exception occurs when attempting to run a query, we'll format the error
    668|         // message to include the bindings with SQL, which will make this exception a
    669|         // lot more helpful to the developer instead of just the database's errors.
    670|         catch (Exception $e) {
  > 671|             throw new QueryException(
    672|                 $query, $this->prepareBindings($bindings), $e
    673|             );
    674|         }
    675|

  1   C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3\vendor\laravel\framework\src\Illuminate\Database\Connection.php:464
      PDOException::("SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry 'nguyenvanmanh@gmail.com' for key 'users_email_unique'")
      => lỗi đã có dữ liệu ở bảng users nhưng do chạy tất cả nên lại thêm dữ liệu này vào lại (2)


  2   C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3\vendor\laravel\framework\src\Illuminate\Database\Connection.php:464
      PDOStatement::execute()

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3>php artisan db:seed
Seeding: UsersTableSeeder
Seeded:  UsersTableSeeder (0.19 seconds)
Seeding: ArticlesTableSeeder

   Illuminate\Database\QueryException

  SQLSTATE[42S22]: Column not found: 1054 Unknown column 'vote' in 'field list' (SQL: insert into `articles` (`title`, `content`, `author`, `email`, `vote`) values (They are., Neque consequuntur sed voluptatum eaque possimus aliquam dolores non. Deserunt doloribus nam delectus. Voluptatum totam aut nihil dicta quia omnis sint aperiam., Mrs. Sharon Huel, Kimberly Lowe, Mr. Tavares Tromp DDS))

  at C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3\vendor\laravel\framework\src\Illuminate\Database\Connection.php:671
    667|         // If an exception occurs when attempting to run a query, we'll format the error
    668|         // message to include the bindings with SQL, which will make this exception a
    669|         // lot more helpful to the developer instead of just the database's errors.
    670|         catch (Exception $e) {
  > 671|             throw new QueryException(
    672|                 $query, $this->prepareBindings($bindings), $e
    673|             );
    674|         }
    675|

  • A column was not found: You might have forgotten to run your migrations. You can run your migrations using `php artisan migrate`.
    https://laravel.com/docs/master/migrations#running-migrations

  1   C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3\vendor\laravel\framework\src\Illuminate\Database\Connection.php:458
      PDOException::("SQLSTATE[42S22]: Column not found: 1054 Unknown column 'vote' in 'field list'")
  => lỗi sai cột votes nhưng ghi vote (1)

  2   C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3\vendor\laravel\framework\src\Illuminate\Database\Connection.php:458
      PDO::prepare("insert into `articles` (`title`, `content`, `author`, `email`, `vote`) values (?, ?, ?, ?, ?)")

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3>php artisan db:seed
Seeding: UsersTableSeeder
Seeded:  UsersTableSeeder (0.24 seconds)
Seeding: ArticlesTableSeeder

   InvalidArgumentException

  Unknown formatter "names"

  at C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3\vendor\fzaninotto\faker\src\Faker\Generator.php:248
    244|
    245|                 return $this->formatters[$formatter];
    246|             }
    247|         }
  > 248|         throw new \InvalidArgumentException(sprintf('Unknown formatter "%s"', $formatter));
    249|     }
    250|
    251|     /**
    252|      * Replaces tokens ('{{ tokenName }}') with the result from the token method call

  1   C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3\vendor\fzaninotto\faker\src\Faker\Generator.php:228
      Faker\Generator::getFormatter("names")
      => ghi sai 
  2   C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3\vendor\fzaninotto\faker\src\Faker\Generator.php:274
      Faker\Generator::format("names")

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3>php artisan db:seed
Seeding: UsersTableSeeder
Seeded:  UsersTableSeeder (0.22 seconds)
Seeding: ArticlesTableSeeder

   Illuminate\Database\QueryException

  SQLSTATE[HY000]: General error: 1364 Field 'username' doesn't have a default value (SQL: insert into `articles` (`title`, `content`, `author`, `email`, `votes`) values (Queen's., At nam et molestias officiis. Voluptas corrupti qui odio fuga autem quaerat labore. Consequatur delectus id provident., Mrs. Valentine Ebert, Cydney Marquardt, Nathaniel Dietrich))

  at C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3\vendor\laravel\framework\src\Illuminate\Database\Connection.php:671
    667|         // If an exception occurs when attempting to run a query, we'll format the error
    668|         // message to include the bindings with SQL, which will make this exception a
    669|         // lot more helpful to the developer instead of just the database's errors.
    670|         catch (Exception $e) {
  > 671|             throw new QueryException(
    672|                 $query, $this->prepareBindings($bindings), $e
    673|             );
    674|         }
    675|

  1   C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3\vendor\laravel\framework\src\Illuminate\Database\Connection.php:464
      PDOException::("SQLSTATE[HY000]: General error: 1364 Field 'username' doesn't have a default value")
=> username cũng phải được thêm gía trị (3)
  2   C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3\vendor\laravel\framework\src\Illuminate\Database\Connection.php:464
      PDOStatement::execute()

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3>php artisan db:seed
Seeding: UsersTableSeeder
Seeded:  UsersTableSeeder (0.23 seconds)

   ParseError

  syntax error, unexpected ''username'' (T_CONSTANT_ENCAPSED_STRING), expecting ']'

  at C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3\database\seeds\ArticlesTableSeeder.php:24
    20|                         'content'=>$faker->text,
    21|                         'author'=>$faker->name,
    22|                         'email'=>$faker->name,
    23|                         'votes'=>$faker->name          => lỗi thiếu dấu ","
  > 24|                         'username'=>$faker->name
    25|                 ]);
    26|         }
    27|     }
    28| }

  1   C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3\vendor\composer\ClassLoader.php:346
      Composer\Autoload\includeFile("C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3\vendor\composer/../../database/seeds/ArticlesTableSeeder.php")

  2   [internal]:0
      Composer\Autoload\ClassLoader::loadClass("ArticlesTableSeeder")

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3>php artisan db:seed
Seeding: UsersTableSeeder

   Illuminate\Database\QueryException

  SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry 'nguyenvanmanh@gmail.com' for key 'users_email_unique' (SQL: insert into `users` (`name`, `email`, `password`, `updated_at`, `created_at`) values (Manh, nguyenvanmanh@gmail.com, $2y$10$IUad5W8IpuIrdsk4uut9qez/.8dWkrxegCvny/d5y1rjlGmqR36Gi, 2021-09-09 03:53:14, 2021-09-09 03:53:14))

  at C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3\vendor\laravel\framework\src\Illuminate\Database\Connection.php:671
    667|         // If an exception occurs when attempting to run a query, we'll format the error
    668|         // message to include the bindings with SQL, which will make this exception a
    669|         // lot more helpful to the developer instead of just the database's errors.
    670|         catch (Exception $e) {
  > 671|             throw new QueryException(
    672|                 $query, $this->prepareBindings($bindings), $e
    673|             );
    674|         }
    675|

  1   C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3\vendor\laravel\framework\src\Illuminate\Database\Connection.php:464
      PDOException::("SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry 'nguyenvanmanh@gmail.com' for key 'users_email_unique'")
=> lỗi thêm trùng dữ liệu vào bảng user (5)
  2   C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3\vendor\laravel\framework\src\Illuminate\Database\Connection.php:464
      PDOStatement::execute()

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3>php artisan db:seed
Seeding: UsersTableSeeder
Seeded:  UsersTableSeeder (0.25 seconds)
Seeding: ArticlesTableSeeder

   Illuminate\Database\QueryException

  SQLSTATE[HY000]: General error: 1364 Field 'views_count' doesn't have a default value (SQL: insert into `articles` (`title`, `content`, `author`, `email`, `votes`, `username`) values (Alice,) and., Eum vitae blanditiis unde. Dolores dolore eum facilis rem. Aut quidem vitae non rerum ut iure. Labore et ea expedita ratione ut nemo eum dicta. Tempora asperiores aut occaecati vero aut., Prof. Camilla Pagac DDS, Narciso O'Connell, Joannie Ebert, Mrs. Marcelle Schiller III))

  at C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3\vendor\laravel\framework\src\Illuminate\Database\Connection.php:671
    667|         // If an exception occurs when attempting to run a query, we'll format the error
    668|         // message to include the bindings with SQL, which will make this exception a
    669|         // lot more helpful to the developer instead of just the database's errors.
    670|         catch (Exception $e) {
  > 671|             throw new QueryException(
    672|                 $query, $this->prepareBindings($bindings), $e
    673|             );
    674|         }
    675|

  1   C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3\vendor\laravel\framework\src\Illuminate\Database\Connection.php:464
      PDOException::("SQLSTATE[HY000]: General error: 1364 Field 'views_count' doesn't have a default value")
=> ghi sai cột 
  2   C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3\vendor\laravel\framework\src\Illuminate\Database\Connection.php:464
      PDOStatement::execute()

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3>php artisan db:seed
Seeding: UsersTableSeeder

   Illuminate\Database\QueryException

  SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry 'nguyenvanmanh@gmail.com' for key 'users_email_unique' (SQL: insert into `users` (`name`, `email`, `password`, `updated_at`, `created_at`) values (Manh, nguyenvanmanh@gmail.com, $2y$10$taQ.Y6WXWw0Xu9MJqjPmsu9ZKevWTUpKailUslfJB66UCcsZ66.JS, 2021-09-09 03:54:37, 2021-09-09 03:54:37))

  at C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3\vendor\laravel\framework\src\Illuminate\Database\Connection.php:671
    667|         // If an exception occurs when attempting to run a query, we'll format the error
    668|         // message to include the bindings with SQL, which will make this exception a
    669|         // lot more helpful to the developer instead of just the database's errors.
    670|         catch (Exception $e) {
  > 671|             throw new QueryException(
    672|                 $query, $this->prepareBindings($bindings), $e
    673|             );
    674|         }
    675|

  1   C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3\vendor\laravel\framework\src\Illuminate\Database\Connection.php:464
      PDOException::("SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry 'nguyenvanmanh@gmail.com' for key 'users_email_unique'")
=> thêm dữ liệu trùng 
  2   C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3\vendor\laravel\framework\src\Illuminate\Database\Connection.php:464
      PDOStatement::execute()

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3>php artisan db:seed
Seeding: UsersTableSeeder
Seeded:  UsersTableSeeder (0.26 seconds)
Seeding: ArticlesTableSeeder

   Illuminate\Database\QueryException

  SQLSTATE[42S22]: Column not found: 1054 Unknown column 'view_count' in 'field list' (SQL: insert into `articles` (`title`, `content`, `author`, `email`, `votes`, `username`, `view_count`) values (So she., Quis sequi esse quisquam qui nulla est veritatis. Quo et velit aut illum consectetur non. Culpa nihil aut exercitationem quidem corrupti praesentium maxime., Adrain Adams, Lenore Schaden, Dr. Margot D'Amore Sr., Jennie Schmeler, 1))

  at C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3\vendor\laravel\framework\src\Illuminate\Database\Connection.php:671
    667|         // If an exception occurs when attempting to run a query, we'll format the error
    668|         // message to include the bindings with SQL, which will make this exception a
    669|         // lot more helpful to the developer instead of just the database's errors.
    670|         catch (Exception $e) {
  > 671|             throw new QueryException(
    672|                 $query, $this->prepareBindings($bindings), $e
    673|             );
    674|         }
    675|

  • A column was not found: You might have forgotten to run your migrations. You can run your migrations using `php artisan migrate`.
    https://laravel.com/docs/master/migrations#running-migrations

  1   C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3\vendor\laravel\framework\src\Illuminate\Database\Connection.php:458
      PDOException::("SQLSTATE[42S22]: Column not found: 1054 Unknown column 'view_count' in 'field list'")

  2   C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3\vendor\laravel\framework\src\Illuminate\Database\Connection.php:458
      PDO::prepare("insert into `articles` (`title`, `content`, `author`, `email`, `votes`, `username`, `view_count`) values (?, ?, ?, ?, ?, ?, ?)")

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel3>php artisan db:seed
Seeding: UsersTableSeeder
Seeded:  UsersTableSeeder (0.28 seconds)
Seeding: ArticlesTableSeeder
(Chạy thành công)

unique() => duy nhất 
    + thường thấy nhất đó là username 

laravel2/database/migrations/2021_09_08_045945_catogories.php
laravel2/database/migrations/2021_09_08_050119_create_categories_table.php  
laravel2/database/migrations/2021_09_06_160627_create_articles_table.php
laravel2/database/migrations/2021_09_08_085334_create_product_table.php

laravel3 
database: news3
app/.env
laravel3/database/migrations/2021_09_08_152310_create_articles_table.php
laravel3/database/migrations/2021_09_08_160158_add_author_to_articles_table.php
laravel3/database/migrations/2021_09_08_162137_add_votes_to_articles_table.php
database/seeds/DatabaseSeeder.php
database/seeds/UsersTableSeeder.php
database/seeds/ArticlesTableSeeder.php
app/Models/Article.php
app/Models/Product.php
laravel3/database/migrations/2021_09_09_055150_create_products_table.php
app/Http/Controllers/ArticleController.php 
routes/web.php 

//(video42)

Thao tác trên laravel4 
Database : news4 
.env 
app/Models/Article.php 
resources/Articles.blade.php             
database/migrations/2021_09_10_015907_create_articles_table  
database/seeds/ArticlesTableSeeder.php 
database/seeds/DatabaseSeeder.php 
app/Http/Controllers/ArticleController.php 
routes/web.php 

//(video43)

Nếu như mà muốn dùng lại project cũ thì làm như thế này : 
copy database : news4 sang database : news5
xuất file database của news4 về => news4.sql => tạo database news5 => nhập news4.sql vào news5  
copy laravel4 sang dowload => sửa thành laravel5 rồi paste vào lại learnlaravel 
vào file 
.env 
DB_CONNECTION=mysql
DB_HOST=localhost
DB_PORT=3306
DB_DATABASE=news5
DB_USERNAME=root
DB_PASSWORD=

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel5> php artisan serve 
=> chạy serve 

Bài này thì tạo mới project để thao tác 
=> tạo mới laravel5
=> tạo mới database : news5 


laravel5 
Database : tintuc43 
.env 
routes/web.php 
app/Models/Post.php 
database/migrations/2021_09_10_193312_create_posts_table.php   
resources/views/welcome.blade.php             
app/Http/Controllers/PostController.php 
resources/views/layouts/master.blade.php            
resources/views/post/create.blade.php 
app/Http/Request/post/CreatePostRequest.php 
resources/views/post/list.blade.php 
resources/views/post/detail.blade.php
htdocs/posts_project.sql 
app/Models/Category.php
database/migrations/2021_09_11_193451_create_categories_table.php
resources/views/post/category.blade.php
app/Models/Tag.php
database/migrations/2021_09_12_093227_create_tags_table.php
database/migrations/2021_09_12_093901_create_post_tag_table.php
htdocs/tintuc43.sql 


//(video44)

comment : 
+ comment vào bài viết 
+ comment vào hình ảnh 
+ comment vào video 
+ comment vào comment => reply (trả lời)

bảng comments : 
    id 
    content
    target_type : // post , video , image 
    target_id :  


    id : 1
    content : xin chao 
    target_type : video 
    target_id : 3
    
    => comment vào video có id là 3 

    id : 1
    content : xin chao 
    target_type : post  
    target_id : 3

    => comment vào post có id là 3 

bảng comments : 
    id 
    content
    target_type : // post , video , image 
    target_id : 

=> comment mọi thứ 

comment vào bài viết, comment vào category 

posts:id ,content, title 
categories: id, name 
comments: 
    id 
    content 
    commentable_id 
    commentable_type 

laravel6 
Database: tintuc44 
.env 
app/Http/Controllers/PostController.php 
resources/views/post/detail.blade.php
app/Models/Comment.php
database/migrations/2021_09_13_110058_create_comments_table
app/Models/Post.php 
app/Models/Category.php
resources/views/post/category.blade.php
app/Models/Menu.php
app/Http/Controllers/MenuController.php 
htdocs/tintuc44.sql 


//(video45)

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel7>composer require laravel/ui:^2.4
./composer.json has been updated
Running composer update laravel/ui
Loading composer repositories with package information
Updating dependencies
Lock file operations: 1 install, 0 updates, 0 removals
  - Locking laravel/ui (v2.4.0)
Writing lock file
Installing dependencies from lock file (including require-dev)
Package operations: 1 install, 0 updates, 0 removals
  - Downloading laravel/ui (v2.4.0)
  - Installing laravel/ui (v2.4.0): Extracting archive
Package fzaninotto/faker is abandoned, you should avoid using it. No replacement was suggested.
Package phpunit/php-token-stream is abandoned, you should avoid using it. No replacement was suggested.
Package sebastian/resource-operations is abandoned, you should avoid using it. No replacement was suggested.
Generating optimized autoload files
> Illuminate\Foundation\ComposerScripts::postAutoloadDump
> @php artisan package:discover --ansi
Discovered Package: facade/ignition
Discovered Package: fideloper/proxy
Discovered Package: fruitcake/laravel-cors
Discovered Package: laravel/tinker
Discovered Package: laravel/ui
Discovered Package: nesbot/carbon
Discovered Package: nunomaduro/collision
Package manifest generated successfully.
67 packages you are using are looking for funding.
Use the `composer fund` command to find out more!

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel7>php artisan config:cache
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel7>php artisan make:rule CauVanHoa
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel7>composer require laravel/ui:^2.4
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel7>php artisan ui vue --auth
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel7>npm install
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel7>npm run prod
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel7>php artisan make:middleware BlockIpMiddleware

laravel7
database : tintuc45
.env 
web.php 
app/Http/Controllers/PostController.php 
resources/lang/en/validation.php
resources/views/post/create.blade.php
resources/lang/en/
resources/lang/vi/
config/app.php 
resources/lang/vi/validation.php
app/Http/Request/post/CreatePostRequest.php 
app/Rules/CauVanHoa.php
resources/js/components/ExampleComponent.vue
resources/js/app.js 
resources/js/bootstrap.js 
views/auth / nhiều file views (/blade.php)
views/auth/passwords / nhiều file views (.blade.php)
resources/views/layouts/app.blade.php
resources/views/home.blade.php 
app/Http/Controllers/Auth/ nhiều file controller  
app/Http/Controllers/HomeController.php
app/Http/Middleware/BlockIpMiddleware.php
app\Http\Kernel.php 
database/migrations/2014_10_12_000000_create_users_table.php
app/Http/Middleware/RoleMiddleware.php
htdocs/tintuc45.sql


//(video46)

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel>composer create-project --prefer-dist laravel/laravel:^7.0 laravelAuth
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>composer require laravel/ui:^2.4
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>php artisan ui vue --auth
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>npm install
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>npm run prod
C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>composer require laravel/socialite



SocialiteProviders\Manager\OAuth2\User {#309 ▼
  +accessTokenResponseBody: array:5 [▼
    "access_token" => "ya29.a0ARrdaM-xKeV5PcY0W6KdLyDOmSrEd3hLnYhpoP2jFUdoTn6eKHhZq6SaJIN2Qyr-Unn7bvD9I5AQMhI-4zoykMepTiJ38L9l5nzTZwRBG4v8MkzMOl88mXLXryBzNc-RZu7imizWp3HmZJo99nXGprAAE38k ◀"
    "expires_in" => 3599
    "scope" => "https://www.googleapis.com/auth/userinfo.profile openid https://www.googleapis.com/auth/userinfo.email"
    "token_type" => "Bearer"
    "id_token" => "eyJhbGciOiJSUzI1NiIsImtpZCI6Ijc0MjE3YjhkYWRiYjM2NTc4MzU4MGY5ZTkyNDg3ZDcwMWNkMzhmZTYiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiI3Nzk4NDIzNzEwNzEtZ241NmQ1ZDhvN2w4YmxlcnFuM25iNzV2M3ZuaHNicWYuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJhdWQiOiI3Nzk4NDIzNzEwNzEtZ241NmQ1ZDhvN2w4YmxlcnFuM25iNzV2M3ZuaHNicWYuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJzdWIiOiIxMDk3MjI3MjcxNjIyNDQ4OTE5MDQiLCJlbWFpbCI6Im5ndXllbnZhbm1hbmgyMDAxaXQxQGdtYWlsLmNvbSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJhdF9oYXNoIjoiTnlHZVIxUEh0Y1NMVVFGT2VCemJrUSIsIm5hbWUiOiJN4bqhbmggTmd1eeG7hW4gVsSDbiIsInBpY3R1cmUiOiJodHRwczovL2xoMy5nb29nbGV1c2VyY29udGVudC5jb20vYS0vQU9oMTRHZ1VwZmM1LWlYcFZNaUlIVk84cF9IQ2o4OTZpSmRhTFIwWW82bDc9czk2LWMiLCJnaXZlbl9uYW1lIjoiTeG6oW5oIiwiZmFtaWx5X25hbWUiOiJOZ3V54buFbiBWxINuIiwibG9jYWxlIjoidmkiLCJpYXQiOjE2MzE3NzM5MjEsImV4cCI6MTYzMTc3NzUyMX0.BgWOAi18IW8PQaWqLnLuNQPRexAcn2fUg_ukWikUpizKaj9uosVLIWNmn4EpV--nTRaZp-Sp4JIgeDOBSWV2ChAmTa8WBc0AaKmPisaMfC6WVrIAowb5lX4AhcN4rKcOhk_UU2O_dlgniG_b-RiL-Yz9MMUXTHd7h8E2fsBo0lHYOVOHWk2wgoZAIo9zPc8kJlkE0j2UlA8kOfcTrIEGr-MJnJH0yiZAU9XDc05_XTpKbbvf-Fh0wOM9nNvpYx7M_UIr41279xD3Ymqpsj8fGT4CqI4FEoYW8a2msEq_r7mD8kwBRB8jw0v5JRQWpn6WC2Gq1rA4Q5SkcjwdmPJaLQ ◀"
  ]
  +token: "ya29.a0ARrdaM-xKeV5PcY0W6KdLyDOmSrEd3hLnYhpoP2jFUdoTn6eKHhZq6SaJIN2Qyr-Unn7bvD9I5AQMhI-4zoykMepTiJ38L9l5nzTZwRBG4v8MkzMOl88mXLXryBzNc-RZu7imizWp3HmZJo99nXGprAAE38k ◀"
  +refreshToken: null
  +expiresIn: 3599
  +id: "109722727162244891904"
  +nickname: "Mạnh Nguyễn Văn"
  +name: "Mạnh Nguyễn Văn"
  +email: "nguyenvanmanh2001it1@gmail.com"
  +avatar: "https://lh3.googleusercontent.com/a-/AOh14GgUpfc5-iXpVMiIHVO8p_HCj896iJdaLR0Yo6l7=s96-c"
  +user: array:8 [▼
    "sub" => "109722727162244891904"
    "name" => "Mạnh Nguyễn Văn"
    "given_name" => "Mạnh"
    "family_name" => "Nguyễn Văn"
    "picture" => "https://lh3.googleusercontent.com/a-/AOh14GgUpfc5-iXpVMiIHVO8p_HCj896iJdaLR0Yo6l7=s96-c"
    "email" => "nguyenvanmanh2001it1@gmail.com"
    "email_verified" => true
    "locale" => "vi"
  ]
}


Ứng dụng của bạn cần có sản phẩm, quyền và tính năng nào?

Kinh doanh
Tạo hoặc quản lý các tài sản kinh doanh như Trang, Sự kiện, Nhóm, Quảng cáo, Messenger và API Đồ thị trên Instagram bằng các quyền, tính năng và sản phẩm mà doanh nghiệp hiện có.

Workplace
Tạo các công cụ dành cho doanh nghiệp trên Workplace từ Facebook.

Người tiêu dùng
Kết nối ứng dụng của bạn với các sản phẩm và quyền dành cho người tiêu dùng, chẳng hạn như Đăng nhập bằng Facebook và Instagram Basic Display.

Trò chơi tức thì
Tạo game HTML5 được lưu trữ trên Facebook.

Chơi game
Kết nối một game ngoài nền tảng với phương thức Đăng nhập bằng Facebook.

Không có
Tạo ứng dụng bằng cách kết hợp các quyền và sản phẩm dành cho người tiêu dùng và doanh nghiệp.


C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>php artisan config:cach
Configuration cache cleared!
Configuration cached successfully!

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravelAuth>php artisan config:cache
Configuration cache cleared!
Configuration cached successfully!

cach hay cache điều được 
Database : auth.sql 
laravelAuth 
.env 
database/migrations/2014_10_12_000000_create_users_table.php   
app/Http/Controllers/Auth/RegisterController.php  
resources/views/auth/register.blade.php
app/User.php
resources/views/auth/login.blade.php
app/Http/Controllers/Auth/LoginController.php  
laravel/laravelAuth/vendor/laravel/ui/auth-backend/AuthenticatesUsers.php/{}AuthenticatesUsers (chỉ đọc and copy)
package.json 
webpack.mix.js 
resources/views/layouts/app.blade.php
config/services.php
app/Providers/EventServiceProvider.php 
app/Http/Controllers/Auth/SocialLoginController.php 
htdocs/auth.sql 


//(video47)

serialize(biến)=> chuỗi
unserialize(chuỗi)=> biến


Cài laravel trên hosting 
Không thể cài supervisor => phần mềm quản lí tiến trình (process manager)

=> chạy bằng cronjob 

search : crontab guru 

Database : auth  
laravelAuth 
app/Jobs/SendWelcomeMail.php
app/Http/Controllers/Auth/RegisterController.php  
.env
config/queue.php 
database/2021_09_17_103236_create_jobs_table.php
database/2019_08_19_000000_create_failed_jobs_table.php
app/Console/Commands/ClearCacheCommand.php 
app/Console/Kernel.php
app/Jobs/DailyReportJob.php
a.txt
htdocs/auth47.sql


//(video48)

laravel10
Database : auth48
.env 
app/Models/Article.php
database/migrations/2021_09_17_202607_create_articles_table.php
database/seeds/ArticlesTableSeeder.php
database/seeds/DatabaseSeeder.php
app/Http/Controllers/LandingPageController.php 
routes/web.php 
resources/views/landing.blade.php
config/cache.php
app/Console/Commands/CreateHomePageCache.php 
app/Console/Kernel.php
storage/framework/cache/data/f1/0d (chỉ đọc)
database/migrations/2014_10_12_000000_create_users_table.php
database/seeds/UsersTableSeeder.php
app/User.php
app/Http/Controllers/ArticleController.php 
app/Policies/ArticlePolicy.php
app/Providers/AuthServiceProvider.php
htdocs/auth48.sql 

cache()->remember('tên cache', $số_giây, function () {
    return ...;
});
cache()->remember('users', $seconds, function () {
    return DB::table('users')->get();
});
+ Lần chạy đầu tiên => chạy function => lấy dữ liệu => lưu vào cache 
+ Lần chạy 2 trở đi => kiểm tra ở trong cache có chưa?
    + có rồi => lấy từ cache (không chạy function)
    + chưa có => chạy function 
+ Khi hết hạn => lại chạy function 

Cache::store('redis')->increment('total_views');

C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel10>php artisan route:list
+--------+-----------+------------------------+-------------------+------------------------------------------------------------------------+------------+
| Domain | Method    | URI                    | Name              | Action                                                                 | Middleware |
+--------+-----------+------------------------+-------------------+------------------------------------------------------------------------+------------+
|        | GET|HEAD  | /                      |                   | App\Http\Controllers\LandingPageController@index                       | web        |
|        | GET|HEAD  | api/user               |                   | Closure                                                                | api        |
|        |           |                        |                   |                                                                        | auth:api   |
|        | POST      | article                | article.store     | App\Http\Controllers\ArticleController@store                           | web        |
|        | GET|HEAD  | article                | article.index     | App\Http\Controllers\ArticleController@index                           | web        |
|        | GET|HEAD  | article/create         | article.create    | App\Http\Controllers\ArticleController@create                          | web        |
|        | PUT|PATCH | article/{article}      | article.update    | App\Http\Controllers\ArticleController@update                          | web        |
|        | GET|HEAD  | article/{article}      | article.show      | App\Http\Controllers\ArticleController@show                            | web        |
|        | DELETE    | article/{article}      | article.destroy   | App\Http\Controllers\ArticleController@destroy                         | web        |
|        | GET|HEAD  | article/{article}/edit | article.edit      | App\Http\Controllers\ArticleController@edit                            | web        |
|        | GET|HEAD  | home                   | home              | App\Http\Controllers\HomeController@index                              | web        |
|        |           |                        |                   |                                                                        | auth       |
|        | GET|HEAD  | login                  | login             | App\Http\Controllers\Auth\LoginController@showLoginForm                | web        |
|        |           |                        |                   |                                                                        | guest      |
|        | POST      | login                  |                   | App\Http\Controllers\Auth\LoginController@login                        | web        |
|        |           |                        |                   |                                                                        | guest      |
|        | GET|HEAD  | login/facebook         | facebook.redirect | App\Http\Controllers\Auth\SocialLoginController@redirectToFacebook     | web        |
|        | GET|HEAD  | login/google           | google.redirect   | App\Http\Controllers\Auth\SocialLoginController@redirectToGoogle       | web        |
|        | POST      | logout                 | logout            | App\Http\Controllers\Auth\LoginController@logout                       | web        |
|        | POST      | password/confirm       |                   | App\Http\Controllers\Auth\ConfirmPasswordController@confirm            | web        |
|        |           |                        |                   |                                                                        | auth       |
|        | GET|HEAD  | password/confirm       | password.confirm  | App\Http\Controllers\Auth\ConfirmPasswordController@showConfirmForm    | web        |
|        |           |                        |                   |                                                                        | auth       |
|        | POST      | password/email         | password.email    | App\Http\Controllers\Auth\ForgotPasswordController@sendResetLinkEmail  | web        |
|        | GET|HEAD  | password/reset         | password.request  | App\Http\Controllers\Auth\ForgotPasswordController@showLinkRequestForm | web        |
|        | POST      | password/reset         | password.update   | App\Http\Controllers\Auth\ResetPasswordController@reset                | web        |
|        | GET|HEAD  | password/reset/{token} | password.reset    | App\Http\Controllers\Auth\ResetPasswordController@showResetForm        | web        |
|        | POST      | register               |                   | App\Http\Controllers\Auth\RegisterController@register                  | web        |
|        |           |                        |                   |                                                                        | guest      |
|        | GET|HEAD  | register               | register          | App\Http\Controllers\Auth\RegisterController@showRegistrationForm      | web        |
|        |           |                        |                   |                                                                        | guest      |
|        | GET|HEAD  | social-login/facebook  |                   | App\Http\Controllers\Auth\SocialLoginController@processLoginFacebook   | web        |
|        | GET|HEAD  | social-login/google    |                   | App\Http\Controllers\Auth\SocialLoginController@processLoginGoogle     | web        |
+--------+-----------+------------------------+-------------------+------------------------------------------------------------------------+------------+



//(video49)

Database : auth49
laravel11 
.env 
app/Models/Article.php
app/User.php
app/Http/Controllers/ArticleController.php 
app/Policies/ArticlePolicy.php
app/Providers/AuthServiceProvider.php
routes/web.php 
htdocs/auth49.sql 


qlct (quản lý công ty)
database : qlct 
.env 
database/migrations/2014_10_12_000000_create_users_table.php
app/Http/Middleware/RoleMiddleware.php
app/Http/Kernel.php 
routes/web.php 
app/Http/Controllers/AdminController.php
app/Models/Permission.php
database/migrations/2021_09_19_091429_create_permissions_table.php
app/User.php
database/migrations/2021_09_19_092226_create_user_permission_table.php 
app/Policies/UserPolicy.php
app/Policies/ArticlePolicy.php
app/Models/Menu.php
database/migrations/2021_09_19_094533_create_menus_table.php 
htdocs/qlct.sql


C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel11>php artisan route:list


| POST      | article                | article.store     | App\Http\Controllers\ArticleController@store  | web                            |
|           |                        |                   |                                               |can:create,App\Models\Article   |
| GET|HEAD  | article                | article.index     | App\Http\Controllers\ArticleController@index  | web                            |
|           |                        |                   |                                               |can:viewAny,App\Models\Article  |
| GET|HEAD  | article/create         | article.create    | App\Http\Controllers\ArticleController@create | web                            |
|           |                        |                   |                                               |can:create,App\Models\Article   |
| PUT|PATCH | article/{article}      | article.update    | App\Http\Controllers\ArticleController@update | web                            |
|           |                        |                   |                                               |can:update,article              |
| GET|HEAD  | article/{article}      | article.show      | App\Http\Controllers\ArticleController@show   | web                            |
|           |                        |                   |                                               |can:view,article                |
| DELETE    | article/{article}      | article.destroy   | App\Http\Controllers\ArticleController@destro | web                            |
|           |                        |                   |                                               |can:delete,article              |
| GET|HEAD  | article/{article}/edit | article.edit      | App\Http\Controllers\ArticleController@edit   | web                            |
|           |                        |                   |                                               |can:update,article              |
| GET|HEAD  | home                   | home              | App\Http\Controllers\HomeController@index     | web                            |
|           |                        |                   |                                               | auth                           |


//(video50)










ghichu2 



<-------------------------------------------------------------video 39------------------------------------------------------------->







Laravel 39 

// video 39 

<?php
//-------------------------------------------------------------video 39-------------------------------------------------------------
// Cài đặt laravel , tạo project laravel 
// Cấu trúc file và thư mục : artisan, app(Http, Exceptions, Console), bootstrap, config,
// database(factories, migrations, seeds), public, resources(js, lang, sass, view), 
// routes(web.php, api.php), storage(cache, upload), test, vendor, .env
// Mô hình mvc: model - view - controller 
// Router (controller .php,views .blade.php ,web.php api.php ),...
// Router 
// Route group 
// Route resource
// Route view
// Artisan và các lệnh cơ bản ,make:controller,make:controller --resource, make:model,...
// Hệ thống lại, mô tả khái quát, mối liên hệ của các phần web.php, controller .php, views .blade.php ,...  



use Illuminate\Support\Facades\Route;
// use App\Http\Controllers\ArticleController;
/*
|--------------------------------------------------------------------------
| Web Routes
|--------------------------------------------------------------------------
|
| Here is where you can register web routes for your application. These
| routes are loaded by the RouteServiceProvider within a group which
| contains the "web" middleware group. Now create something great!
|
*/

Route::get('/', function () {
    return view('welcome');
});


// Route::get('/login', function () {
//     return 'Hello Nguyễn Văn Mạnh';
// });


Route::get('/login','UserController@login'); // truy cập đến http://localhost:8000/login để thấy nội dung hàm login trong file UserController 
//Route::get('/abc','UserController@login'); // truy cập đến http://localhost:8000/abc   để thấy nội dung hàm login trong file UserController
// Route::get('/login','UserController@login');// Khi mà truy cập đến địa chỉ login => gọi đến UserController.php rồi gọi hàm login 
// Route::post('/saveuser','UserController@save');
// Route::get('/article/edit','ArticleController@edit');

// Route::get('/article/show', 'ArticleController@show');
// Route::get('/article/create', 'ArticleController@create' );
// Route::get('/article/edit', 'ArticleController@edit' );
// Route::get('/article/delete', 'ArticleController@delete' );

// Route::group([arttributes], hàm xử lí);

// Route::group(['prefix' => 'article'], function(){
//     Route::get('/edit','ArticleController@edit');
//     Route::get('/show','ArticleController@show');
//     Route::get('/create','ArticleController@create');
// })->middleware('kgergoireiergowjfk');


//=> hàm login trong UserController.php sẽ thực hiện 
/*

file UserController.php sẽ có như thế này : 
    <?php
    
    namespace App\Http\Controllers;
    
    use Illuminate\Http\Request;
    
    class UserController extends Controller
    {
      // 
    }

    C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel1>php artisan serve (chạy lại server)

viết hàm vào file UserController.php : 
    <?php
    
    namespace App\Http\Controllers;
    
    use Illuminate\Http\Request;
    
    class UserController extends Controller
    {
        //
        public function login(){       
            return 'Đây là trang login';
        }
    }

*/

Route::view('/welcome','welcome');
Route::view('/abc','welcome'); // có thể thêm nhiều đường dẫn cho một file => đều gọi đến file welcome.blade.php
Route::view('/xinchao','xinchao');
Route::resource('/article','ArticleController');
Route::resource('/baiviet','ArticleController');
// Route::resource('/article','ArticleController'); Chú ý đây là file ArticleController có resource => phải là Route::resource 
// nếu Route::get là sai ,bị lỗi và không chạy được 

// Chú ý web.php chứa các link nhưng nếu các link khác bị lỗi thì cũng không chạy file được nên chú ý 
// Vẫn phải đảm bảo là file web.php không bị lỗi 

// Route::view('/welcome','welcome')->name('chaomung');
// giống như vuejs có name để truy cập cho dễ thì bên laravel cũng có name 
//và từ một hàm có thể gọi tiếp đến một hàm thì tìm hiểu (fluent interface) là được. 

// Route::view('/article',ArticleController::class);
// Route::view('/article','App\Http\Controllers\ArticleController');

 
/*
Bài này ta đã học được kiến thức về 
Mô tả khái quát các phần: 
- routes 
    + file web.php : chứa các route cho web (chứa các đường dẫn cho web)(chứa các đường dẫn cho các file controller,cho các file .blade.php)
        + Đối với các file .php trong controller: 
            + không có --resource :
                + Router::get() 
                    ex : Route::get('/login','UserController@login');
            + có --resource :
                + Router::resource()
                    ex : Route::resource('/article','ArticleController');
        + Đối với các file .blade.php trong views:
            + Router::get() rồi return view
                ex : Route::get('/', function () {
                         return view('welcome');
                     });
            +  Router::view() , Router trực tiếp đến view 
                ex : Route::view('/welcome','welcome');
        + Có thể tạo nhiều đường dẫn cho một file 
            + Route::view('/welcome','welcome'); // http://localhost:8000/welcome
              Route::view('/abc','welcome');     // http://localhost:8000/abc
              => đều gọi đến file welcome.blade.php
            + Route::resource('/article','ArticleController'); // http://localhost:8000/article
              Route::resource('/baiviet','ArticleController'); // http://localhost:8000/baiviet
              => đều gọi đến file ArticleController.php
            => Đấy là tìm hiểu thêm như vậy ,còn thực tế nếu không vì mục đích gì thì cũng không nên cho một file có nhiều đường dẫn 
            + Vậy đặt trường hợp một đường dẫn chạy nhiều file thì sao => 
            ex : Route::get('/welcome','UserController@login'); 
                 Route::get('/', function () {
                     return view('welcome');
                 });
                 Route::view('/welcome','welcome');
                 Route::resource('/welcome','ArticleController');
            => Nó sẽ chạy theo thứ tự ưu tiên 
                 Route::resource (file controller.php có resource trước) đến 
                 Route::view (file .blade.php trong thư mục view) đến (Route trực tiếp đến view)
                 Route::get() (file controller.php không có resource) đến 
                 Route::get() return view (file .balde.php trong thư mục view) get rồi mới return view 
            => Và đây cũng là tìm hiểu thêm thôi , chú có bao giờ cho nhiều file cùng một đường dẫn để làm gì đâu 

            => Cứ đặt mỗi đừng dẫn cho mỗi file cho nó đơn giản 

            nó sẽ chạy file controller .php 
    + file api.php : tương tự  
- resources 
    - views : 
        + chứa các file .blade.php  (cơ bản dễ thấy nhất là chứa code hiển thị client html)
        + được tạo bằng tay 
- app
    - http 
        - controller : 
            + chứa các file : controller.php 
            + thường được tạo bằng cách dùng CMD:  
                + C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel1>php artisan make:controller UserController  (không resource)
                + C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel1>php artisan make:controller ArticleController --resource (có resource)
                + C:\Users\nguye\OneDrive\Máy tính\Laravel\learnlaravel\laravel1>php artisan make:controller Admin/ManageUser (thêm vào thư mục Admin)
                => tương ứng tạo ra các file UserController.php ArticleController.php Admin/ManageUser.php
            + đặt điểm khác biệt giữa có --resource và không có --resource
                + không có --resource : 
                    + Không có các hàm có sẵn 
                    + Máy chỉ tạo ra chủ yếu là khung của file 
                    + Khi viết các hàm vào thì muốn thực hiện phải gọi rõ ràng ra ở file web.php 
                + có --resource : 
                    + Có các hàm có sẵn theo quy chuẩn : index,create,store, show, edit, update, destroy.
                    + Máy tạo tự động tạo ra các hàm index,create,store, show, edit, update, destroy cho chúng ta.
                    + Không cần ghi rõ đường dẫn rõ ràng chi tiết ở file web.php , khi mà gõ link ở url là tự động load và gọi đến các hàm đó 

Bây giờ đến sự liên kết giữa các phần:
(ex : 1)
- app
    - http 
        - controller : 
                Giả sử ta có một file được tạo ra bằng CMD UserController.php (không có --resource) 
                cơ bản có nội dung chính sau :  public function login(){
                                                    return 'Đây là trang login';
                                                }
- resources 
    - views : 
- routes 
    + file web.php :  
                Route::get('/login','UserController@login');
                => khi ta vào http://localhost:8000/login thì sẽ có ''Đây là trang login' , cơ bản là nó sẽ trả về những thứ gì có trong hàm 
                login , nằm trong file UserController.php 
                (Về file@hàm phải ghi cho đúng , tức là trong thư mục controller có file UserController.php , trong file đó có chứa hàm login thì phải ghi cho đúng , còn về phần đường dẫn có thể ghi theo ý ta,Route::get('/abc','UserController@login'); cũng được => thì truy cập đến http://localhost:8000/abc để thấy nội dung của hàm login)
                (Các file khác cũng tương tự , các file khác nằm trong thư mục views cũng tương tự)
                (Nhưng thường thì nên đặt đường dẫn giống với tên các hàm cho dễ hiểu và dễ nhớ)


    + file api.php :  
(ex : 2)
- controller : 
                Giả sử ta có một file được tạo ra bằng CMD ArticleController.php (có --resource) 
                => máy sẽ tự động tạo ra một loạt các hàm index,create,store, show, edit, update, destroy.
                giả sử trong các hàm ta sẽ return ra thứ gì đó : 
                                                                 public function index(){
                                                                         return 'Index Danh sách bài viết.';
                                                                     }
                                                                 public function create(){
                                                                         return 'Thêm bài viết';
                                                                     }
                                                                 public function store(Request $request){
                                                                         return 'store';
                                                                     }
                                                                 public function show($id){
                                                                         return 'show';
                                                                     }
                                                                 public function edit($id){
                                                                         return 'Chỉnh sửa bài viết .';
                                                                     }
                                                                 public function update(Request $request, $id){
                                                                         return 'Cập nhật bài viết .';
                                                                     }
                                                                 public function destroy($id){
                                                                         return 'Destroy';
                                                                     }
- resources 
    - views : 
- routes 
    + file web.php :  
                Route::resource('/article','ArticleController'); 
                => Chỉ cần ghi như thế này là đủ 
                => http://localhost:8000/article        => tự động gọi hàm index  => hiển thị ra 'Index Danh sách bài viết.'
                => http://localhost:8000/article/create => tự động gọi hàm create => hiển thị ra 'Thêm bài viết'
                => http://localhost:8000/article/... => tự động gọi hàm ...
    + file api.php :  
(ex : 3)
- app
    - http 
        - controller : 
- resources 
    - views : 
        + tạo bằng tay file : xinchao.blade.php 
        + có nội dung cơ bản sau : 
                                   <!DOCTYPE html>
                                   <html lang="en">
                                   <head>
                                       <title>Xin chao</title>
                                       <meta charset="utf-8">
                                       <meta name="viewport" content="width=device-width, initial-scale=1">
                                       <meta http-equiv="X-UA-Compatible" content="ie=edge">
                                   </head>
                                   <body>
                                       <h1>Xin chào</h1>
                                   </body>
                                   </html>
- routes 
    + file web.php :  
        Route::view('/xinchao','xinchao'); 
        => http://localhost:8000/xinchao
        => Hiển thị ra nội dung file xinchao.blade.php :hiện 'Xin chào' ở màn hình 
        (Như đã nói ở trên đối với file phải ghi cho đúng , còn lại url ta tự đặt tùy ý)
        (Nếu là Route::view('/xyz','xinchao'); => thì vào http://localhost:8000/xyz để thấy nội dung file xinchao.blade.php)

        Hoặc là Route::view trực tiếp,hoặc là Route::get rồi return view như ở dưới cũng được
    + file api.php :  

(Lúc đầu tiên khi mà cài đặt xong vào http://localhost:8000/ => hiện ra giao diện laravel => đó chính là đang gọi đến file welcome.blade.php trong views : 
web.php : 
    Route::get('/', function () {
       return view('welcome');
    });
)


- Còn về phần model như đã nói ở trên ta chỉ mới dừng ngang cách tạo ra các file model 
Qua những giải thích chi tiết phía trên => hiểu rõ hơn về mô hình mvc 
Mô hình mvc: model - view - controller 
- Ứng dụng: chia thành 3 phần : 
    + model: class, thực thể trong ứng dụng 
        + conVat,conVoi,... 
        + Articles,category,user 
    + controller: thành phần xử lí 
        + làm nhiệm vụ xử lí logic 
        + gọi các model lên => tương tác với nhau
    + view: thành phần hiển thị (giống bên vuejs là <template></templace>)
     
- Truy cập web : (trình tự khi một người truy cập web)
    + router : 
    + controller => model 
    + view 
Khi user bắt đầu truy cập vào web => (truy cập đến các url có trong file web.php) 
(- routes sẽ gọi đến các file views blade.php , các file controller .php và các hàm trong file đó , tương ứng với các đường dẫn đó 
=> các controller xử lí => gọi đến các model => xử lí => hiển thị lại với user) 
*/

//-------------------------------------------------------------video 39-------------------------------------------------------------


app/http/controller/UserController.php

video 39 

<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;

class UserController extends Controller
{
    //
    public function login(){
        return 'Đây là trang login';
    }
}
//-------------------------------------------------------------video 39-------------------------------------------------------------


routes/api.php

video 39 

<?php

use Illuminate\Http\Request;
use Illuminate\Support\Facades\Route;

/*
|--------------------------------------------------------------------------
| API Routes
|--------------------------------------------------------------------------
|
| Here is where you can register API routes for your application. These
| routes are loaded by the RouteServiceProvider within a group which
| is assigned the "api" middleware group. Enjoy building your API!
|
*/

Route::middleware('auth:api')->get('/user', function (Request $request) {
    return $request->user();
});
//-------------------------------------------------------------video 39-------------------------------------------------------------


resources/views/welcome.blade.php

video 39 

<!DOCTYPE html>
<html lang="{{ str_replace('_', '-', app()->getLocale()) }}">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>Laravel</title>

        <!-- Fonts -->
        <link href="https://fonts.googleapis.com/css?family=Nunito:200,600" rel="stylesheet">

        <!-- Styles -->
        <style>
            html, body {
                background-color: #fff;
                color: #636b6f;
                font-family: 'Nunito', sans-serif;
                font-weight: 200;
                height: 100vh;
                margin: 0;
            }

            .full-height {
                height: 100vh;
            }

            .flex-center {
                align-items: center;
                display: flex;
                justify-content: center;
            }

            .position-ref {
                position: relative;
            }

            .top-right {
                position: absolute;
                right: 10px;
                top: 18px;
            }

            .content {
                text-align: center;
            }

            .title {
                font-size: 84px;
            }

            .links > a {
                color: #636b6f;
                padding: 0 25px;
                font-size: 13px;
                font-weight: 600;
                letter-spacing: .1rem;
                text-decoration: none;
                text-transform: uppercase;
            }

            .m-b-md {
                margin-bottom: 30px;
            }
        </style>
    </head>
    <body>
        <div class="flex-center position-ref full-height">
            @if (Route::has('login'))
                <div class="top-right links">
                    @auth
                        <a href="{{ url('/home') }}">Home</a>
                    @else
                        <a href="{{ route('login') }}">Login</a>

                        @if (Route::has('register'))
                            <a href="{{ route('register') }}">Register</a>
                        @endif
                    @endauth
                </div>
            @endif

            <div class="content">
                <div class="title m-b-md">
                    Laravel
                </div>

                <div class="links">
                    <a href="https://laravel.com/docs">Docs</a>
                    <a href="https://laracasts.com">Laracasts</a>
                    <a href="https://laravel-news.com">News</a>
                    <a href="https://blog.laravel.com">Blog</a>
                    <a href="https://nova.laravel.com">Nova</a>
                    <a href="https://forge.laravel.com">Forge</a>
                    <a href="https://vapor.laravel.com">Vapor</a>
                    <a href="https://github.com/laravel/laravel">GitHub</a>
                </div>
            </div>
        </div>
    </body>
</html>
//-------------------------------------------------------------video 39-------------------------------------------------------------


resources/views/xinchao.blade.php

video 39 

<!DOCTYPE html>
<html lang="en">
<head>
    <title>Xin chao</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
</head>
<body>
    <h1>Xin chào</h1>
</body>
</html>
//-------------------------------------------------------------video 39-------------------------------------------------------------


app/http/controller/ArticleController.php

video 39 

<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;

class ArticleController extends Controller
{
    /**
     * Display a listing of the resource.
     *
     * @return \Illuminate\Http\Response
     */
    public function index()
    {
        //
        return 'Index Danh sách bài viết.';
    }

    /**
     * Show the form for creating a new resource.
     *
     * @return \Illuminate\Http\Response
     */
    public function create()
    {
        //
        return 'Thêm bài viết';
    }

    /**
     * Store a newly created resource in storage.
     *
     * @param  \Illuminate\Http\Request  $request
     * @return \Illuminate\Http\Response
     */
    public function store(Request $request)
    {
        //
        return 'store';
    }

    /**
     * Display the specified resource.
     *
     * @param  int  $id
     * @return \Illuminate\Http\Response
     */
    public function show($id)
    {
        //
        return 'show';
    }

    /**
     * Show the form for editing the specified resource.
     *
     * @param  int  $id
     * @return \Illuminate\Http\Response
     */
    public function edit($id)
    {
        //
        return 'Chỉnh sửa bài viết .';
    }

    /**
     * Update the specified resource in storage.
     *
     * @param  \Illuminate\Http\Request  $request
     * @param  int  $id
     * @return \Illuminate\Http\Response
     */
    public function update(Request $request, $id)
    {
        //
        return 'Cập nhật bài viết .';
    }

    /**
     * Remove the specified resource from storage.
     *
     * @param  int  $id
     * @return \Illuminate\Http\Response
     */
    public function destroy($id)
    {
        //
        return 'Destroy';
    }
}
//-------------------------------------------------------------video 39-------------------------------------------------------------


app/http/controller/Admin/ManageUser.php 

video 39 

<?php

namespace App\Http\Controllers\Admin;

use App\Http\Controllers\Controller;
use Illuminate\Http\Request;

class ManageUser extends Controller
{
    //
}
//-------------------------------------------------------------video 39-------------------------------------------------------------


app/User.php

video 39 

<?php

namespace App;

use Illuminate\Contracts\Auth\MustVerifyEmail;
use Illuminate\Foundation\Auth\User as Authenticatable;
use Illuminate\Notifications\Notifiable;

class User extends Authenticatable
{
    use Notifiable;

    /**
     * The attributes that are mass assignable.
     *
     * @var array
     */
    protected $fillable = [
        'name', 'email', 'password',
    ];

    /**
     * The attributes that should be hidden for arrays.
     *
     * @var array
     */
    protected $hidden = [
        'password', 'remember_token',
    ];

    /**
     * The attributes that should be cast to native types.
     *
     * @var array
     */
    protected $casts = [
        'email_verified_at' => 'datetime',
    ];
}
//-------------------------------------------------------------video 39-------------------------------------------------------------


app/Book.php

video 39 

<?php

namespace App;

use Illuminate\Database\Eloquent\Model;

class Book extends Model
{
    //
}
//-------------------------------------------------------------video 39-------------------------------------------------------------


app/Models/Person.php 

video 39 

<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;

class Person extends Model
{
    //
}

<-------------------------------------------------------------video 39------------------------------------------------------------->







Laravel 40 

// video 40 

<?php
//-------------------------------------------------------------video 40-------------------------------------------------------------
// config: Configuration (Cấu hình)
// file .env, các file trong thư mục /config
// Hàm env() Thứ tự lấy biến mỗi trường 
// Config thì được cache (lưu tạm)(cache : bộ nhớ đệm)php artisan config:clear (xóa cache) php artisan config:cache (cập nhật cache)
// Tự tạo một config
// Một số biến cần lưu ý trong file .env 
// Request 
// Nguyên lí hoạt động của Request trong laravel
// $request->[tên_giá_trị], $request->post('tên_giá_trị'), $request->get('tên_giá_trị')
// Tự tạo một request: php artisan make:request [tên_request]
// Hàm authorize() và hàm rules() trong file request
// <form> @csrf </form>
// Controller return view 
// Các kiểu cách return view 
// Blade template: 
// Các câu lệnh cơ bản trong Blade template 
// {{ $tên_biến }}
// Vòng lặp: @foreach ( $array as $phần_tử ) /code/ @endforeach , ex : @foreach ( $students as $student ) /code/ @endforeach
// Câu lệnh điều kiện @if(điều_kiện) @elseif @else @endif 
// Kế thừa template : tenplate cha : @yield('tên section')
// Ở template con : @extends('tên_cha') @section('tên section','Nội dung') // Nếu mà Nội dung ngắn có thể dùng trực tiếp như thế này luôn cũng được 
// @section('tên section') @endsection
// Một file sử dụng một đoạn code của file khác @include('tên_cha')
// Kết nối database
// migration,hàm up(), hàm down(), php artisan make:migration [tên_migration]
// Chạy migration : php artisan migrate 
// Rollback : php artisan migrate:rollback (hoàn tác,hủy những gì đã chạy trước đó)
// Bảng : migrations (bảng đặc biệt)







use Illuminate\Support\Facades\Route;

/*
|--------------------------------------------------------------------------
| Web Routes
|--------------------------------------------------------------------------
|
| Here is where you can register web routes for your application. These
| routes are loaded by the RouteServiceProvider within a group which
| contains the "web" middleware group. Now create something great!
|
*/

Route::get('/', function () {
    return view('welcome');
});

Route::view('/xinchaolaravel2','xinchao');
//Route::get('/login','UserController@login');
Route::post('/login','UserController@login');
Route::get('/article','ArticleController@show');
Route::view('/inheritanceTemplate','inheritanceTemplate');


//-------------------------------------------------------------video 40-------------------------------------------------------------


.env 

video 40 

APP_NAME=NguyenVanManh
APP_ENV=local
APP_KEY=base64:daYKp2zWyZoj45LQYLXEJ08cZzPYjGnfR10TxR1gcY4=
APP_DEBUG=true
APP_URL=http://localhost

LOG_CHANNEL=stack

DB_CONNECTION=mysql
DB_HOST=localhost
DB_PORT=3306
DB_DATABASE=tintuc3
DB_USERNAME=root
DB_PASSWORD=

BROADCAST_DRIVER=log
CACHE_DRIVER=file
QUEUE_CONNECTION=sync
SESSION_DRIVER=file
SESSION_LIFETIME=120

REDIS_HOST=127.0.0.1
REDIS_PASSWORD=null
REDIS_PORT=6379

MAIL_MAILER=smtp
MAIL_HOST=smtp.mailtrap.io
MAIL_PORT=2525
MAIL_USERNAME=null
MAIL_PASSWORD=null
MAIL_ENCRYPTION=null
MAIL_FROM_ADDRESS=null
MAIL_FROM_NAME="${APP_NAME}"

AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_DEFAULT_REGION=us-east-1
AWS_BUCKET=

PUSHER_APP_ID=
PUSHER_APP_KEY=
PUSHER_APP_SECRET=
PUSHER_APP_CLUSTER=mt1

MIX_PUSHER_APP_KEY="${PUSHER_APP_KEY}"
MIX_PUSHER_APP_CLUSTER="${PUSHER_APP_CLUSTER}"
//-------------------------------------------------------------video 40-------------------------------------------------------------


config/app.php 

video 40 

<?php

return [

    /*
    |--------------------------------------------------------------------------
    | Application Name
    |--------------------------------------------------------------------------
    |
    | This value is the name of your application. This value is used when the
    | framework needs to place the application's name in a notification or
    | any other location as required by the application or its packages.
    |
    */

    'name' => env('APP_NAME', 'Laravel'),

    /*
    |--------------------------------------------------------------------------
    | Application Environment
    |--------------------------------------------------------------------------
    |
    | This value determines the "environment" your application is currently
    | running in. This may determine how you prefer to configure various
    | services the application utilizes. Set this in your ".env" file.
    |
    */

    'env' => env('APP_ENV', 'production'),

    /*
    |--------------------------------------------------------------------------
    | Application Debug Mode
    |--------------------------------------------------------------------------
    |
    | When your application is in debug mode, detailed error messages with
    | stack traces will be shown on every error that occurs within your
    | application. If disabled, a simple generic error page is shown.
    |
    */

    'debug' => env('APP_DEBUG', false),

    /*
    |--------------------------------------------------------------------------
    | Application URL
    |--------------------------------------------------------------------------
    |
    | This URL is used by the console to properly generate URLs when using
    | the Artisan command line tool. You should set this to the root of
    | your application so that it is used when running Artisan tasks.
    |
    */

    'url' => env('APP_URL', 'http://localhost'),

    'asset_url' => env('ASSET_URL', null),

    /*
    |--------------------------------------------------------------------------
    | Application Timezone
    |--------------------------------------------------------------------------
    |
    | Here you may specify the default timezone for your application, which
    | will be used by the PHP date and date-time functions. We have gone
    | ahead and set this to a sensible default for you out of the box.
    |
    */

    'timezone' => 'UTC',

    /*
    |--------------------------------------------------------------------------
    | Application Locale Configuration
    |--------------------------------------------------------------------------
    |
    | The application locale determines the default locale that will be used
    | by the translation service provider. You are free to set this value
    | to any of the locales which will be supported by the application.
    |
    */

    'locale' => 'en',

    /*
    |--------------------------------------------------------------------------
    | Application Fallback Locale
    |--------------------------------------------------------------------------
    |
    | The fallback locale determines the locale to use when the current one
    | is not available. You may change the value to correspond to any of
    | the language folders that are provided through your application.
    |
    */

    'fallback_locale' => 'en',

    /*
    |--------------------------------------------------------------------------
    | Faker Locale
    |--------------------------------------------------------------------------
    |
    | This locale will be used by the Faker PHP library when generating fake
    | data for your database seeds. For example, this will be used to get
    | localized telephone numbers, street address information and more.
    |
    */

    'faker_locale' => 'en_US',

    /*
    |--------------------------------------------------------------------------
    | Encryption Key
    |--------------------------------------------------------------------------
    |
    | This key is used by the Illuminate encrypter service and should be set
    | to a random, 32 character string, otherwise these encrypted strings
    | will not be safe. Please do this before deploying an application!
    |
    */

    'key' => env('APP_KEY'),

    'cipher' => 'AES-256-CBC',

    /*
    |--------------------------------------------------------------------------
    | Autoloaded Service Providers
    |--------------------------------------------------------------------------
    |
    | The service providers listed here will be automatically loaded on the
    | request to your application. Feel free to add your own services to
    | this array to grant expanded functionality to your applications.
    |
    */

    'providers' => [

        /*
         * Laravel Framework Service Providers...
         */
        Illuminate\Auth\AuthServiceProvider::class,
        Illuminate\Broadcasting\BroadcastServiceProvider::class,
        Illuminate\Bus\BusServiceProvider::class,
        Illuminate\Cache\CacheServiceProvider::class,
        Illuminate\Foundation\Providers\ConsoleSupportServiceProvider::class,
        Illuminate\Cookie\CookieServiceProvider::class,
        Illuminate\Database\DatabaseServiceProvider::class,
        Illuminate\Encryption\EncryptionServiceProvider::class,
        Illuminate\Filesystem\FilesystemServiceProvider::class,
        Illuminate\Foundation\Providers\FoundationServiceProvider::class,
        Illuminate\Hashing\HashServiceProvider::class,
        Illuminate\Mail\MailServiceProvider::class,
        Illuminate\Notifications\NotificationServiceProvider::class,
        Illuminate\Pagination\PaginationServiceProvider::class,
        Illuminate\Pipeline\PipelineServiceProvider::class,
        Illuminate\Queue\QueueServiceProvider::class,
        Illuminate\Redis\RedisServiceProvider::class,
        Illuminate\Auth\Passwords\PasswordResetServiceProvider::class,
        Illuminate\Session\SessionServiceProvider::class,
        Illuminate\Translation\TranslationServiceProvider::class,
        Illuminate\Validation\ValidationServiceProvider::class,
        Illuminate\View\ViewServiceProvider::class,

        /*
         * Package Service Providers...
         */

        /*
         * Application Service Providers...
         */
        App\Providers\AppServiceProvider::class,
        App\Providers\AuthServiceProvider::class,
        // App\Providers\BroadcastServiceProvider::class,
        App\Providers\EventServiceProvider::class,
        App\Providers\RouteServiceProvider::class,

    ],

    /*
    |--------------------------------------------------------------------------
    | Class Aliases
    |--------------------------------------------------------------------------
    |
    | This array of class aliases will be registered when this application
    | is started. However, feel free to register as many as you wish as
    | the aliases are "lazy" loaded so they don't hinder performance.
    |
    */

    'aliases' => [

        'App' => Illuminate\Support\Facades\App::class,
        'Arr' => Illuminate\Support\Arr::class,
        'Artisan' => Illuminate\Support\Facades\Artisan::class,
        'Auth' => Illuminate\Support\Facades\Auth::class,
        'Blade' => Illuminate\Support\Facades\Blade::class,
        'Broadcast' => Illuminate\Support\Facades\Broadcast::class,
        'Bus' => Illuminate\Support\Facades\Bus::class,
        'Cache' => Illuminate\Support\Facades\Cache::class,
        'Config' => Illuminate\Support\Facades\Config::class,
        'Cookie' => Illuminate\Support\Facades\Cookie::class,
        'Crypt' => Illuminate\Support\Facades\Crypt::class,
        'DB' => Illuminate\Support\Facades\DB::class,
        'Eloquent' => Illuminate\Database\Eloquent\Model::class,
        'Event' => Illuminate\Support\Facades\Event::class,
        'File' => Illuminate\Support\Facades\File::class,
        'Gate' => Illuminate\Support\Facades\Gate::class,
        'Hash' => Illuminate\Support\Facades\Hash::class,
        'Http' => Illuminate\Support\Facades\Http::class,
        'Lang' => Illuminate\Support\Facades\Lang::class,
        'Log' => Illuminate\Support\Facades\Log::class,
        'Mail' => Illuminate\Support\Facades\Mail::class,
        'Notification' => Illuminate\Support\Facades\Notification::class,
        'Password' => Illuminate\Support\Facades\Password::class,
        'Queue' => Illuminate\Support\Facades\Queue::class,
        'Redirect' => Illuminate\Support\Facades\Redirect::class,
        'Redis' => Illuminate\Support\Facades\Redis::class,
        'Request' => Illuminate\Support\Facades\Request::class,
        'Response' => Illuminate\Support\Facades\Response::class,
        'Route' => Illuminate\Support\Facades\Route::class,
        'Schema' => Illuminate\Support\Facades\Schema::class,
        'Session' => Illuminate\Support\Facades\Session::class,
        'Storage' => Illuminate\Support\Facades\Storage::class,
        'Str' => Illuminate\Support\Str::class,
        'URL' => Illuminate\Support\Facades\URL::class,
        'Validator' => Illuminate\Support\Facades\Validator::class,
        'View' => Illuminate\Support\Facades\View::class,

    ],

];
//-------------------------------------------------------------video 40-------------------------------------------------------------


resources/views/xinchao.blade.php 

video 40 

<!DOCTYPE html>
<html lang="en">
<head>
    <title>Xin chao</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
</head>
<body>
    <h1>Xin chào</h1>
    <p>{{config('app.name')}}</p>
    <p>{{config('game.hardness')}}</p>
    <form action="/login" method="post">
        @csrf <!-- tìm hiểu sau -->
        <input type="text" name="name" placeholder="name">
        <input type="text" name="age" placeholder="age">
        <!-- hiển thị ra lỗi gì -->
        @foreach ($errors->all() as $error)
            <li>{{ $error }}</li>
        @endforeach
        <!-- hiển thị ra lỗi gì --><!--nếu dưới 6 kí tự => sẽ báo lỗi : The name must be at least 6 characters. -->
        <button type="submit">Dang Nhap</button>
    </form>
</body>
</html>
//-------------------------------------------------------------video 40-------------------------------------------------------------


config/game.php 

video 40 

<?php

return [
    'hardness'=> 2 


];
//-------------------------------------------------------------video 40-------------------------------------------------------------


app/Http/Controller/UserController.php 

video 40 

<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use App\Http\Requests\LoginRequest;

class UserController extends Controller
{
    //
    public function login(LoginRequest $Request){
        //print_r($Request);
        echo $Request->name;
        echo $Request->age;
        echo $Request->post('name');
        return 'Đây là trang login Laravel2';
    }
}
//-------------------------------------------------------------video 40-------------------------------------------------------------


app/Http/Requests/LoginRequest.php 

video 40 

<?php

namespace App\Http\Requests;

use Illuminate\Foundation\Http\FormRequest;

class LoginRequest extends FormRequest
{
    /**
     * Determine if the user is authorized to make this request.
     *
     * @return bool
     */
    public function authorize()
    {
        return true;
    }

    /**
     * Get the validation rules that apply to the request.
     *
     * @return array
     */
    public function rules()
    {
        return [
            //
            'name' => 'min:6' //'name' => 'required|min:6'
            //'age' 
        ];
    }
}
//-------------------------------------------------------------video 40-------------------------------------------------------------


app/Http/Controller/ArticleController.php

video 40 

<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;

class ArticleController extends Controller
{
    //
    public function show(Request $Request){
        $name = 'Nguyen Van Manh';
        $age = 20;
        $students =[
            'Nguyen Van Manh',
            'Bui Van Nguyen',
            'Huong Giang',
            'Hoang Phuc'
        ];
        $agree = true;
        $number = 1;
        //return view('article',['ten' => $name,'tuoi' => $age,'students' => $students]); //cách 1
        //return view('article')->with(['ten'=>$name,'tuoi' => $age]);//cách 2 // nếu chỉ truyền vào một biến : return view('article')->with('ten',$name);
        return view('article')->with('ten',$name)->with('tuoi',$age)->with('students',$students)->with('agree',$agree)->with('number',$number);
        // return view('welcome');
        //return view('xinchao');
    }
}
//-------------------------------------------------------------video 40-------------------------------------------------------------


views/article.blade.php

video 40 

<!DOCTYPE html>
<html>
<head>
    <title>Article</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
</head>
<body>
    <h2>Đây là trang bài viết !</h2>
    {{$ten}} <!-- Cách 1 -->
    {{$tuoi}}
    <p><?php echo $ten.$tuoi ?></p> <!-- Cách 2 -->

    @foreach ( $students as $student)
    <p>{{ $student }}</p>
    @endforeach 
    <!-- Tương đương với đoạn dưới này-->   
    <?php foreach ($students as $student){
        # code...
        echo '<p>'.$student.'</p>';
        // echo "<p>$student</p>";
    }
    ?>

    @if ($agree)
    <p>Ban da dong y</p> <!-- Nếu true thì no xuấ thẻ p ra , còn false thì không xuất gì-->
    @endif 

    @if ($number==1)
        <p>Một</p>
    @elseif ($number==2)
        <p>Hai</p>
    @elseif ($number==3)
        <p>Ba</p>
    @else 
        <p>Else</p>
    @endif 
</body>
</html>
//-------------------------------------------------------------video 40-------------------------------------------------------------


views/master.blade.php

video 40 

<!DOCTYPE html>
<html>
<head>
    <title>@yield('tieude')</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
</head>
<body>
<header>
    <h1>Day la web pro</h1>
</header>
<div>
    @yield('noidung')
</div>
@include('parts.div')
<footer>
    <p>Ban quyen thuoc laptrinhcuocsong</p>
</footer>
</body>
</html>
//-------------------------------------------------------------video 40-------------------------------------------------------------


views/inheritanceTemplate.blade.php

video 40 

@extends('master')

@section('tieude','Trang web pro')

@section('noidung')
<?php

echo "<h2>Đây là trang bài viết !</h2>";
$students =[
            'Nguyen Van Manh',
            'Bui Van Nguyen',
            'Huong Giang',
            'Hoang Phuc'
        ];
foreach ($students as $student){
        # code...
        echo '<p>'.$student.'</p>';
        // echo "<p>$student</p>";
}
?>
@endsection
//-------------------------------------------------------------video 40-------------------------------------------------------------


views/parts/div.blade.php

video 40 

<div>
    <p>Chào mừng bạn đến với trang web</p>
</div>
//-------------------------------------------------------------video 40-------------------------------------------------------------


app/database/migrations/2021_09_06_160627_create_articles_table.php

video 40 

<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

class CreateArticlesTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::create('articles', function (Blueprint $table) {
            $table->id();
            $table->string('title');
            $table->text('content');
            $table->timestamps();
        });
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::dropIfExists('articles');
    }
}

<-------------------------------------------------------------video 40------------------------------------------------------------->







Laravel 41 

// video 41 

<?php
//-------------------------------------------------------------video 41------------------------------------------------------------
// Giải thích thêm về : php artisan make:migration ... , php artisan migrate, php artisan migrate:rollback, php artisan migrate:reset, php artisan migrate:refresh
// $table và các hàm : 
// id(), string(), string(tên cột, chiều dài), integer, text(tên cột), date(), dateTime, time(), boolean(), softDeletes()
// timestamps(), created_at, updated_at , index và hai cách đánh index : index([mảng các giá trị đánh index]), $table->kiểu('tên trường')->index() 
// default(), unique(), nullable(), Lưu ý về ghi nhiều hàm cùng một lúc
// add_[tên cột]_to_[tên bảng]_table : Thêm một cột vào cuối bảng bảng, Thêm cột vào vị trí tùy ý, ->after('') 
// Seeder: Công cụ tạo dữ liệu mẫu 
// php artisan make:seeder [Tên class muốn được tạo ra(tên file)] ex : php artisan make:seeder UsersTableSeeder (tạo file)
// php artisan db:seed --class=[Tên class muốn seed]  ex : php artisan db:seed --class=UsersTableSeeder (chạy file)
// php artisan db:seed : chạy file DatabaseSeeder.php
// Father 
// PHẦN QUAN TRỌNG NHẤT CỦA LARAVEL:
// Model,Tạo model
// php artisan make:model [tên model] -m (tạo migration) (tạo được cả hai file model và databse/migration cùng một lần)
// ORM
// object relation maping, mối liên hệ giữa model và database, controller use model lưu dữ liệu đến database , gọi dữ liệu từ database
// giải thích thêm về mvc 



use Illuminate\Support\Facades\Route;

/*
|--------------------------------------------------------------------------
| Web Routes
|--------------------------------------------------------------------------
|
| Here is where you can register web routes for your application. These
| routes are loaded by the RouteServiceProvider within a group which
| contains the "web" middleware group. Now create something great!
|
*/

Route::get('/', function () {
    return view('welcome');
});
Route::get('/test','ArticleController@test');


//-------------------------------------------------------------video 41-------------------------------------------------------------


laravel2/database/migrations/2021_09_08_045945_catogories.php

video 41

<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

class Catogories extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        //
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        //
    }
}
//-------------------------------------------------------------video 41-------------------------------------------------------------


laravel2/database/migrations/2021_09_08_050119_create_categories_table.php  

video 41 

<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

class CreateCategoriesTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::create('categories', function (Blueprint $table) {
            $table->id();
            $table->string('title');
            $table->timestamps();
        });
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::dropIfExists('categories');
    }
}
//-------------------------------------------------------------video 41-------------------------------------------------------------


laravel2/database/migrations/2021_09_06_160627_create_articles_table.php

video 41 

<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

class CreateArticlesTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::create('articles', function (Blueprint $table) {
            $table->id();
            $table->string('title');
            $table->text('content');
            $table->string('username');
            $table->string('email');
            $table->timestamps();
        });
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::dropIfExists('articles');
    }
}
//-------------------------------------------------------------video 41-------------------------------------------------------------


laravel2/database/migrations/2021_09_08_085334_create_product_table.php

video 41 

<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

class CreateProductTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::create('product', function (Blueprint $table) {
            $table->id();
            $table->timestamps();
        });
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::dropIfExists('product');
    }
}
//-------------------------------------------------------------video 41-------------------------------------------------------------


laravel3 
database: news3

video 41 

//-------------------------------------------------------------video 41-------------------------------------------------------------


app/.env

video 41 

APP_NAME=Laravel
APP_ENV=local
APP_KEY=base64:roxqCEXulabnETpvqJjC3VO/7tDCgwXzO/P87e7lMPI=
APP_DEBUG=true
APP_URL=http://localhost

LOG_CHANNEL=stack

DB_CONNECTION=mysql
DB_HOST=localhost
DB_PORT=3306
DB_DATABASE=news3
DB_USERNAME=root
DB_PASSWORD=


BROADCAST_DRIVER=log
CACHE_DRIVER=file
QUEUE_CONNECTION=sync
SESSION_DRIVER=file
SESSION_LIFETIME=120

REDIS_HOST=127.0.0.1
REDIS_PASSWORD=null
REDIS_PORT=6379

MAIL_MAILER=smtp
MAIL_HOST=smtp.mailtrap.io
MAIL_PORT=2525
MAIL_USERNAME=null
MAIL_PASSWORD=null
MAIL_ENCRYPTION=null
MAIL_FROM_ADDRESS=null
MAIL_FROM_NAME="${APP_NAME}"

AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_DEFAULT_REGION=us-east-1
AWS_BUCKET=

PUSHER_APP_ID=
PUSHER_APP_KEY=
PUSHER_APP_SECRET=
PUSHER_APP_CLUSTER=mt1

MIX_PUSHER_APP_KEY="${PUSHER_APP_KEY}"
MIX_PUSHER_APP_CLUSTER="${PUSHER_APP_CLUSTER}"
//-------------------------------------------------------------video 41-------------------------------------------------------------


laravel3/database/migrations/2021_09_08_152310_create_articles_table.php

video 41 

<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

class CreateArticlesTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::create('articles', function (Blueprint $table) {
            $table->id();
            $table->string('title') ;
            $table->text('content');
            $table->string('username');
            $table->string('email'); 
            $table->integer('views_count');
            $table->timestamps();
            //$table->index(['title','content']);
            // $table->string('title')->index()->nullable();
            // $table->text('content');
            // $table->string('username')->unique();
            // $table->string('email')->unique(); 
            // $table->integer('views_count')->default(0);
            // $table->timestamps();
            // $table->index(['title','content']);
        });
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::dropIfExists('articles');
    }
}
//-------------------------------------------------------------video 41-------------------------------------------------------------


laravel3/database/migrations/2021_09_08_160158_add_author_to_articles_table.php

video 41 

<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

class AddAuthorToArticlesTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::table('articles', function (Blueprint $table) {
            $table->string('author');
        });
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::table('articles', function (Blueprint $table) {
            $table->dropColumn('author');
        });
    }
}
//-------------------------------------------------------------video 41-------------------------------------------------------------


laravel3/database/migrations/2021_09_08_162137_add_votes_to_articles_table.php

video 41 

<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

class AddVotesToArticlesTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::table('articles', function (Blueprint $table) {
            $table->string('votes')->after('content');
        });
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::table('articles', function (Blueprint $table) {
            $table->dropColumn('votes');
        });
    }
}
//-------------------------------------------------------------video 41-------------------------------------------------------------


database/seeds/DatabaseSeeder.php

video 41 

<?php

use Illuminate\Database\Seeder;

class DatabaseSeeder extends Seeder
{
    /**
     * Seed the application's database.
     *
     * @return void
     */
    public function run()
    {
        // $this->call(UsersTableSeeder::class);
        $this->call(UsersTableSeeder::class);
        $this->call(ArticlesTableSeeder::class);
    }
}
//-------------------------------------------------------------video 41-------------------------------------------------------------


database/seeds/UsersTableSeeder.php

video 41 

<?php

use Illuminate\Database\Seeder;
use App\User;
use Illuminate\Support\Facades\Hash;
class UsersTableSeeder extends Seeder
{
    /**
     * Run the database seeds.
     *
     * @return void
     */
    public function run()
    {
        //
        // viết code để tạo dữ liệu ở đây 
        User::create([
            'name'=>'Manh',
            'email'=>'nguyenvanmanh@gmail.com',
            'password'=>hash::make('123456')
            ]);
    }
}
//-------------------------------------------------------------video 41-------------------------------------------------------------


database/seeds/ArticlesTableSeeder.php

video 41 

<?php

use Illuminate\Database\Seeder;
use Illuminate\Support\Facades\DB;

class ArticlesTableSeeder extends Seeder
{
    /**
     * Run the database seeds.
     *
     * @return void
     */
    public function run()
    {
        //
        $faker = Faker\Factory::create();
        for($i = 0;$i<300;$i++){
            DB::table('articles')->insert([
                'title'=>$faker->realText(rand(10,20)),
                'content'=>$faker->text,
                'author'=>$faker->name,
                'email'=>$faker->name,
                'votes'=>$faker->name,
                'username'=>$faker->name,
                'views_count'=>$faker->randomDigitNot(10)
            ]);
        }
    }
}
//-------------------------------------------------------------video 41-------------------------------------------------------------


app/Models/Article.php

video 41 

<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;

class Article extends Model
{
    //
}

// chứa hết tất các thuộc tính dưới database 
//-------------------------------------------------------------video 41-------------------------------------------------------------

app/Models/Product.php

video 41 

<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;

class Product extends Model
{
    //
}
//-------------------------------------------------------------video 41-------------------------------------------------------------


laravel3/database/migrations/2021_09_09_055150_create_products_table.php

video 41 

<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

class CreateProductsTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::create('products', function (Blueprint $table) {
            $table->id();
            $table->timestamps();
        });
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::dropIfExists('products');
    }
}
//-------------------------------------------------------------video 41-------------------------------------------------------------


app/Http/Controllers/ArticleController.php 

video 41 

<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use App\Models\Article; // chính là tên file Article.php trong thư mục Models 

class ArticleController extends Controller
{
    //
    public function test(){
        // quá trình lưu xuống 
        // $article = new Article;
        // $article->title = 'tieu de 1';
        // $article->content = 'noi dung 1';
        // $article->author = 'tac gia 1';
        // $article->email = 'email 1';
        // $article->votes = 'votes 1';
        // $article->username = 'user name1';
        // $article->views_count =99;

        // $article->save();
        //return 'test';

        // quá trình gọi lên 
        $article = Article::find(847362); // 847362 là id của dòng dữ liệu đó 
        print_r($article); // hàm find() là hàm chuyển một dòng dữ liệu có id đó thành một object
        echo $article->title;
        echo $article->content;

        // các trường là các property (thuộc tính) , giá trị trong các trường là các giá trị của property 
        // hai qúa trình này gọi là ORM 

    }
}

<-------------------------------------------------------------video 41------------------------------------------------------------->







Laravel 42 

// video 42 

<?php
//-------------------------------------------------------------video 42------------------------------------------------------------
// Eloquent model
// Các hàm Eloquent model
// Hàm đọc dữ liệu và các hàm để build câu lệnh query sql : find(id), findOrFail(id, first(), firstOrFail(), max(), min() , count(), all(), paginate(), get()
// Hàm build câu lệnh query : where(), limit(), offset(), take(), orderBy(), orderByDesc()
// findOrFail()
// all()
// paginate(số lượng) phân trang và echo $articles2->links()
// get() => lấy tất cả theo điều kiện và Điều kiệu where,...
// where('cột','giá trị') và where[tên_cột](giá trị)
// where('cột','so sánh','giá trị')
// where() Nhiều điều kiện cách 1
// where() Nhiều điều kiện cách 2
// where() kết hợp cả hai cách 
// limit() : giới hạn số lượng bảng ghi cần lấy
// offset() : cùng với limit() và điều kiện => xác định vị trí bắt đầu lấy
// first() => tra về bản ghi đầu tiên thõa mãn điều kiện
// firstOrFail() => nếu không tồn tại => báo lỗi
// orderBy('tên cột') => sắp xếp tăng
// orderByDesc('tên cột') => sắp xếp giảm
// max(tên cột) => lấy số lớn nhất
// min(tên cột) => lấy số nhỏ nhất
// count() : số các hàng dữ liệu của bảng
// firstOr(function()=>{})
// Các hàm tạo dữ liệu
// Ghi dữ liệu cách 1 : tạo ra một object => đổ dữ liệu vào => save xuống database => save()
// Ghi dữ liệu cách 2 : đổ dữ liệu vào model, $fillable và hàm fill 
// Ghi dữ liệu cách 2 $fillable và Sử dụng tốt biến $request hàm fill()
// Cách 3: (hay) create() cách 1 
// Cách 3: (hay) create() cách 2, $request và hàm only([])
// Cách 4: insert([])
// Vừa đọc và vừa ghi 
// firstOrCreate() firstOrNew()
// updateOrCreate() updateOrNew()
// Cập nhật dữ liệu : update()
// đọc model ra => sửa => save(); (cách 1)
// update([các filed cần sửa]);   (cách 2)
// Xóa dữ liệu
// đọc model ra => gọi hàm delete();
// destroy(id) xóa một hàng dữ liệu 
// destroy([id,id,id,id]) xóa nhiều hàng dữ liệu 





use Illuminate\Support\Facades\Route;

/*
|--------------------------------------------------------------------------
| Web Routes
|--------------------------------------------------------------------------
|
| Here is where you can register web routes for your application. These
| routes are loaded by the RouteServiceProvider within a group which
| contains the "web" middleware group. Now create something great!
|
*/

Route::get('/', function () {
    return view('welcome');
});
Route::get('/test','ArticleController@test');
Route::get('/test2','ArticleController@test2');
Route::get('/test3','ArticleController@test3');
//-------------------------------------------------------------video 42------------------------------------------------------------


.env 

video 42 

APP_NAME=Laravel
APP_ENV=local
APP_KEY=base64:vN8G8WxP+UBWP8Q+Imw1f0SXeV5bqAegiTk1BAvyFYI=
APP_DEBUG=true
APP_URL=http://localhost

LOG_CHANNEL=stack

DB_CONNECTION=mysql
DB_HOST=localhost
DB_PORT=3306
DB_DATABASE=news4
DB_USERNAME=root
DB_PASSWORD=

BROADCAST_DRIVER=log
CACHE_DRIVER=file
QUEUE_CONNECTION=sync
SESSION_DRIVER=file
SESSION_LIFETIME=120

REDIS_HOST=127.0.0.1
REDIS_PASSWORD=null
REDIS_PORT=6379

MAIL_MAILER=smtp
MAIL_HOST=smtp.mailtrap.io
MAIL_PORT=2525
MAIL_USERNAME=null
MAIL_PASSWORD=null
MAIL_ENCRYPTION=null
MAIL_FROM_ADDRESS=null
MAIL_FROM_NAME="${APP_NAME}"

AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_DEFAULT_REGION=us-east-1
AWS_BUCKET=

PUSHER_APP_ID=
PUSHER_APP_KEY=
PUSHER_APP_SECRET=
PUSHER_APP_CLUSTER=mt1

MIX_PUSHER_APP_KEY="${PUSHER_APP_KEY}"
MIX_PUSHER_APP_CLUSTER="${PUSHER_APP_CLUSTER}"
//-------------------------------------------------------------video 42------------------------------------------------------------


app/Models/Article.php 

video 42 

<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;

class Article extends Model
{
    protected $fillable = ['title','content','author','views_count'];

}
//-------------------------------------------------------------video 42------------------------------------------------------------


resources/Articles.blade.php             

video 42 

//-------------------------------------------------------------video 42------------------------------------------------------------


database/migrations/2021_09_10_015907_create_articles_table  

video 42 

<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

class CreateArticlesTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::create('articles', function (Blueprint $table) {
            $table->id()->index();
            $table->string('title');
            $table->text('content');
            $table->string('author');
            $table->integer('views_count');
            $table->timestamps();
        });
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::dropIfExists('articles');
    }
}
//-------------------------------------------------------------video 42------------------------------------------------------------


database/seeds/ArticlesTableSeeder.php 

video 42 

<?php
  use Illuminate\Database\Seeder;
  use Illuminate\Support\Facades\DB;
  
  class ArticlesTableSeeder extends Seeder
  {
      public function run()
      {
          $faker = Faker\Factory::create();
          for($i = 0;$i<300;$i++){
              DB::table('articles')->insert([
                  'title'=>$faker->realText(rand(10,20)),
                  'content'=>$faker->text,
                  'author'=>$faker->name,
                  'views_count'=>$faker->randomDigitNot(10)
              ]);
          }
      }
  }
//-------------------------------------------------------------video 42------------------------------------------------------------


database/seeds/DatabaseSeeder.php 

video 42 

<?php

use Illuminate\Database\Seeder;
class DatabaseSeeder extends Seeder
{
    /**
     * Seed the application's database.
     *
     * @return void
     */
    public function run()
    {
        // $this->call(UsersTableSeeder::class);
           $this->call(ArticlesTableSeeder::class);
    }
}
//-------------------------------------------------------------video 42------------------------------------------------------------


app/Http/Controllers/ArticleController.php 

video 42 

<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use App\Models\Article; // chính là tên file Article.php trong thư mục Models 

class ArticleController extends Controller
{
    //
    public function test(){
        echo '<br>-----------------------------------------------------------------ORM-----------------------------------------------------------------<br>';
        // quá trình lưu xuống 
        // $article = new Article;
        // $article->title = 'tieu de 1';
        // $article->content = 'noi dung 1';
        // $article->author = 'tac gia 1';
        // $article->views_count =99;

        // $article->email = 'email 1';
        // $article->votes = 'votes 1';
        // $article->username = 'user name1';

        // $article->save();
        // return 'test';
        echo '<br>----------------------------------------Hàm đọc dữ liệu và các hàm để build câu lệnh query sql----------------------------------------<br>';

        echo '<br>-----------------------------------------------------------------find()-----------------------------------------------------------------<br>';
        // quá trình gọi lên 
        $article = Article::find(301); // 301 là id của dòng dữ liệu đó 
        print_r($article); // hàm find() là hàm chuyển một dòng dữ liệu có id đó thành một object
        echo $article->id.' | ';
        echo $article->title.' | ';
        echo $article->content.' | ';
        echo $article->author.' | ';
        echo $article->views_count.' | ';
        // => nếu không có id đó sẽ bị lỗi => dùng if 
        // các trường là các property (thuộc tính) , giá trị trong các trường là các giá trị của property 
        // hai qúa trình này gọi là ORM 

        if($article){
            echo $article->id.' | ';
            echo $article->title.' | ';
            echo $article->content.' | ';
            echo $article->author.' | ';
            echo $article->views_count.' | ';
        }
        echo '<br>-----------------------------------------------------------------findOrFail()-----------------------------------------------------------------<br>';
        // $article2 = Article::findOrFail(2000);
        // echo '<br>'.$article2->title;
        echo '<br>-----------------------------------------------------------------all()-----------------------------------------------------------------<br>';
        $articles = Article::all();
        echo count($articles);
        echo '<br>';
        //print_r($articles);
        print_r($articles[1]); 
        echo '<br>----------------------------------------------<br>';
        echo $articles[1]->title; 
        echo '<br>---------------------------------------------<br>';
        foreach ($articles as $article) {
            echo $article->title;
            // echo '<br>';
            echo ' | ';
        }  ;
        echo '<br>---------------------------------------paginate(số lượng) phân trang và echo $articles2->links();---------------------------------------<br>';
        $article2s = Article::paginate(10);
        foreach ($article2s as $article) {
            echo $article->title;
            echo '<br>';
        }  
        echo $article2s->links();
        echo '<br>---------------------------------------get() => lấy tất cả theo điều kiện và Điều kiệu where,...---------------------------------------<br>';
        echo "<br>--------------------------------------- where('cột','giá trị') và where[tên_cột](giá trị)---------------------------------------<br>";
        $article3s = Article::where('id',10)->get();    // lấy "Những" bài viết có id = 10 
        print_r($article3s);
        echo '<br>---------------------------------------------<br>';
        echo $article3s[0]->id;
        echo '<br>---------------------------------------------<br>';
        $article4s = Article::where('title','like','%you%')->get(); // lấy những bài viết có title có chữ you
        foreach ($article4s as $article) {
            echo $article->title;
            echo '<br>';
        }  
        echo '---------------------------------------------<br>';
        $article5s = Article::whereId(301)->get();     // lấy "những" bài viết có id = 301 
        echo $article5s[0]->title.'<br>';  
        echo '---------------------------------------------<br>';
        $article6s = Article::whereTitle('I should say.')->get();  // lấy những bài viết có title là 'I should say.'
        echo $article6s[0]->title.'<br>'; 
        echo $article6s[0]->content.'<br>';  
        echo '---------------------------------------------<br>';
        $article7s = Article::whereid(301)->get();     // lấy "những" bài viết có id = 301 
        echo $article7s[0]->title.'<br>';  
        echo '---------------------------------------------<br>';
        $article8s = Article::wheretitle('I should say.')->get();  // lấy những bài viết có title là 'I should say.' 
        echo $article8s[0]->title.'<br>'; 
        echo $article8s[0]->content.'<br>';  
        echo '---------------------------------------------<br>';
        echo "<br>---------------------------------------where('cột','so sánh','giá trị')---------------------------------------<br>";
        $article9s = Article::where('views_count','>=',100)->get();  // lấy ra những bài viết có views_count >= 100 
        foreach ($article9s as $article) {
            echo $article->title;
            echo '<br>';
        }   
        echo "<br>---------------------------------------where() Nhiều điều kiện cách 1---------------------------------------<br>";
        $article10s = Article::where('views_count','>=',100)->where('title','like','%you%')->get();  
        // lấy ra những bài viết có views_count >= 100 và title có chữ "you"
        foreach ($article10s as $article) {
            echo $article->title.' | '.$article->views_count;
            echo '<br>';
        }   
        echo "<br>---------------------------------------where() Nhiều điều kiện cách 2---------------------------------------<br>";
        $article11s = Article::where([
            'id' => 2,                    // bài viết có id = 2 , title = 'I gave her.''
            'title' => 'I gave her.'])
            ->get();   
        foreach ($article11s as $article) {
            echo $article->title.' | '.$article->views_count;
            echo '<br>';
        }   
        echo "<br>--------------------------------------Kết hợp cả hai cách--------------------------------------<br>";
        $article12s = Article::where([
            'views_count' => 99,                     
            'title' => 'Let me.'])
            ->where('id','>=',100)->get();   
        foreach ($article12s as $article) {
            echo $article->id.' | '.$article->title.' | '.$article->views_count.' | '.$article->content;
            echo '<br>';
        }   
        echo "<br>----------------------------------------------------------------------------<br>";
        $article12as = Article::where([
            'views_count' => 99,                     
            'title' => 'Let me.'])
            ->where('id','>=',100)->where('content','like','%pro%')->get();   
        foreach ($article12as as $article) {
            echo $article->id.' | '.$article->title.' | '.$article->views_count.' | '.$article->content;
            echo '<br>';
        }   
        echo "<br>---------------------------------------limit() : giới hạn số lượng bảng ghi cần lấy---------------------------------------<br>";
        $article14s = Article::where('id','>',100)->limit(10)->get();   //lấy 10 bài viết đầu tiên (bài viết có id từ 101 đến 110) 
        foreach ($article14s as $article) {
            echo $article->id.' | '.$article->title.' | '.$article->views_count.' | '.$article->content;
            echo '<br>';
        }   
        echo "<br>------------------------offset() : cùng với limit() và điều kiện => xác định vị trí bắt đầu lấy------------------------<br>";
        $article15s = Article::where('id','>',100)->limit(10)->offset(16)->get();   
        // lấy 10 bài viết đầu tiên (bắt đầu từ bài viết có id > 100+16) (117 đến 216)
        foreach ($article15s as $article) {
            echo $article->id.' | '.$article->title.' | '.$article->views_count.' | '.$article->content;
            echo '<br>';
        }   
        echo "<br>-------------------------------first() => tra về bản ghi đầu tiên thõa mãn điều kiện-------------------------------<br>";
        $article16 = Article::where('id','>',100)->first();  // lấy bài viết đầu tiên => bài có id = 101 
        echo $article16->title;
        echo "<br>-------------------------------firstOrFail() => nếu không tồn tại => báo lỗi-------------------------------<br>";
        //$article17 = Article::where('id','>',99999999)->firstOrFail();  // lấy bài viết đầu tiên => bài có id = 100000000
        //echo $article17->title;
        echo "<br>-------------------------------orderBy('tên cột') => sắp xếp tăng-------------------------------<br>";
        $article17s = Article::where('id','>',100)->limit(10)->orderBy('views_count')->get();   
        foreach ($article17s as $article) {
            echo $article->id.' | '.$article->title.' | '.$article->views_count.' | '.$article->content;
            echo '<br>';
        }   
        echo "<br>-------------------------------orderByDesc('tên cột') => sắp xếp giảm-------------------------------<br>";
        $article18s = Article::where('id','>',100)->limit(10)->orderByDesc('views_count')->get();   
        foreach ($article18s as $article) {
            echo $article->id.' | '.$article->title.' | '.$article->views_count.' | '.$article->content;
            echo '<br>';
        }   
        echo "<br>-------------------------------max(tên cột) => lấy số lớn nhất-------------------------------<br>";
        $MaxViews_count = Article::max('views_count');  
        echo $MaxViews_count;
        echo "<br>-------------------------------min(tên cột) => lấy số nhỏ nhất-------------------------------<br>";
        $MinViews_count = Article::min('views_count');  
        echo $MinViews_count;
        echo "<br>-------------------------------count() : số các hàng dữ liệu của bảng-------------------------------<br>";
        $columsNumber = Article::count('views_count');  
        echo $columsNumber;
        echo "<br>-------------------------------firstOr(function()=>{})-------------------------------<br>";
        $article18s = Article::where('id','>',10000000)->firstOr(function(){
            echo 'Đọc ra cái đầu tiên , nếu lỗi thì chạy function này';
        });
    }
    public function test2(Request $request){
    echo '<br>--------------------------------------------------Các hàm tạo dữ liệu--------------------------------------------------<br>';
    echo '<br>--------------------------------------------------Ghi dữ liệu cách 1--------------------------------------------------<br>';
        // $article1 = new Article;
     //    $article1->title = 'tieu de 1';
     //    $article1->content = 'noi dung 1';
     //    $article1->author = 'tac gia 1';
     //    $article1->views_count =99;
        // $article1->save(); // thực hiện lưu db 

     //    return 'test2';
    echo '<br>--------------------------------------------------Ghi dữ liệu cách 2--------------------------------------------------<br>';
    // vào file Models/Article.php => code thêm : class Article extends Model{protected $fillable = ['title','content','author','views_count'];}
    //     $article2 = new Article;
    //     $article2->fill([
    //      'title' => 'bai viet 3',
    //      'content' => 'noi dung 3',
    //      'author' => 'manh',
    //      'views_count' => 9999
    //     ]);

    //     $article2->save(); // thực hiện lưu db 
    echo '<br>----------------------------------------Ghi dữ liệu cách 2 và Sử dụng tốt biến $request----------------------------------------<br>';
    // vào file Models/Article.php => code thêm : class Article extends Model{protected $fillable = ['title','content','author','views_count'];}
           // $article3 = new Article;
           // $article3->fill($request->all() );
           // $article3->save(); // thực hiện lưu db 
    echo '<br>--------------------------------------------------create() cách 1--------------------------------------------------<br>';
    // vào file Models/Article.php => code thêm : class Article extends Model{protected $fillable = ['title','content','author','views_count'];}
           // $article4 = Article::create([
           //   'title' => 'tieu de 1',
        //     'content' => 'noi dung 1',
        //     'author' => 'tac gia 1',
        //     'views_count' => 99
           // ]); 
           // create() yêu cầu phải đúng chính xác những thứ mà bảng Article cần , không viết sai giá trị khác vào được 
    echo '<br>--------------------------------------------------create() cách 2--------------------------------------------------<br>';
           // $article5 = Article::create($request->only(['title','content','author','views_count']));
    echo '<br>--------------------------------------------------insert([])--------------------------------------------------<br>';
    // vào file Models/Article.php => code thêm : class Article extends Model{protected $fillable = ['title','content','author','views_count'];}
    //     $article6 = Article::insert([
    //      [
    //      'title' => 'tieu de 1',
    //        'content' => 'noi dung 1',
    //        'author' => 'tac gia 1',
    //        'views_count' => 99
    //     ],
    //     [
    //      'title' => 'tieu de 2',
    //        'content' => 'noi dung 2',
    //        'author' => 'tac gia 2',
    //        'views_count' => 99
    //     ],
    //  ]); 
    }
    public function test3(Request $request){
    echo '<br>--------------------------------------------------Vừa đọc và vừa ghi--------------------------------------------------<br>';
    echo '<br>--------------------------------------------firstOrCreate() firstOrNew()--------------------------------------------<br>';
        // $article = Article::firstOrCreate(
        //  ['title' => 'bai viet 1000'],// tìm có thì thôi còn nếu tìm không có bài viết có title = 'bai viet 5' 
        //  ['content' => 'noi dung bai viet 5','author' => 'manh','views_count' => 999]// thì tạo ra bài viết với dầy đủ nội dung như sau 
        // );

        // echo $article->title;
    echo '<br>--------------------------------------------------updateOrCreate() updateOrNew()--------------------------------------------------<br>';
        // $article2 = Article::updateOrCreate(
        //  ['title' => 'bai viet 999999'],// tìm nếu có bài viết có title = 'bai viet 999999' 
        //  // thì sửa content thành 'noi dung bai viet 9999999'  sửa author thành 'manh pro' , sửa views_count thành 999 
        //  ['content' => 'noi dung bai viet 9999999','author' => 'manh pro','views_count' => 999]
        // );

        // echo $article2->title;
    echo '<br>--------------------------------------------------Cập nhật dữ liệu : update()--------------------------------------------------<br>';
    echo '<br>--------------------------------------------------đọc model ra => sửa => save(); (cách 1)--------------------------------------------------<br>';
     //    $article3 = Article::find(316);
     //    $article3->title = 'tieu de moi';
     //    $article3->content = 'noi dung bai viet moi';
     //    $article3->author = 'tac gia manh pro';
     //    $article3->views_count =99;
        // $article3->save(); 
    echo '<br>--------------------------------------------------update([các filed cần sửa]);   (cách 2)--------------------------------------------------<br>';
        // $article4 = Article::whereId(312)->update([
        //  'title' =>  'tieu de rat la moi',
        //     'content' =>  'noi dung bai viet rat la moi',
        //     'author' =>  'tac gia manh pro',
        //     'views_count' => 99
        // ]);    
    echo '<br>--------------------------------------------------Xóa dữ liệu--------------------------------------------------<br>';
    echo '<br>--------------------------------------------------đọc model ra => gọi hàm delete();--------------------------------------------------<br>';
         // $article5 = Article::find(313); // kiểu như còn xuất ra một số câu như bạn có muốn xóa hay không hay kểu kểu thế 
         // $article5->detete();
    echo '<br>--------------------------------------------------destroy(id)--------------------------------------------------<br>';
         Article::destroy(313); // xóa bài viết có id = 313 
    echo '<br>--------------------------------------------------destroy([id,id,id,id])--------------------------------------------------<br>';
         Article::destroy([308,303,304]); // xóa bài viết có id = 308 , id = 303 , id = 304  

    }

}


<-------------------------------------------------------------video 42------------------------------------------------------------->







Laravel 43

// video 43

<?php
//-------------------------------------------------------------video 43------------------------------------------------------------
// Thực hành làm project : thêm,xóa,sửa,xem bài viết (Hay) 
// Eloquent relationship: Mối quan hệ giữa các model 1-1,1-n,n-n 
// 1-n : Model cha : hasMany('tên model con'), model con : belongsTo('tên model cha')
// n-n : Cách 1 đặt tên bảng phụ chính xác : Model 1 : belongsToMany('tên model 2'), Model 2 : belongsToMany('tên model 1') 
// n-n : Cách 2 đặt tên bảng phụ tùy ý : Model 1 : belongsToMany('tên model 2','tên_bảng_phụ'), Model 2 : belongsToMany('tên model 1','tên_bảng_phụ') 
// 1-1 : model 1: hasOne('tên model 2'), model 2: hasOne('tên model 1')



use Illuminate\Support\Facades\Route;

/*
|--------------------------------------------------------------------------
| Web Routes
|--------------------------------------------------------------------------
|
| Here is where you can register web routes for your application. These
| routes are loaded by the RouteServiceProvider within a group which
| contains the "web" middleware group. Now create something great!
|
*/

Route::get('/', function () {
    return view('welcome');
});

// Route::get('/user/{user}')->name('user');
Route::resource('/post','PostController');

Route::get('/category/{category}','PostController@showCategoryPost');  // /category/{category} = category/id 

//-------------------------------------------------------------video 43------------------------------------------------------------


.env 

video 43 

APP_NAME=Laravel
APP_ENV=local
APP_KEY=base64:IgxQxEeV4z0G0jdMPIyzCKJl7wYeD/eT3I1NCXZU5HQ=
APP_DEBUG=true
APP_URL=http://localhost

LOG_CHANNEL=stack

DB_CONNECTION=mysql
DB_HOST=localhost
DB_PORT=3306
DB_DATABASE=tintuc43
DB_USERNAME=root
DB_PASSWORD=

BROADCAST_DRIVER=log
CACHE_DRIVER=file
QUEUE_CONNECTION=sync
SESSION_DRIVER=file
SESSION_LIFETIME=120

REDIS_HOST=127.0.0.1
REDIS_PASSWORD=null
REDIS_PORT=6379

MAIL_MAILER=smtp
MAIL_HOST=smtp.mailtrap.io
MAIL_PORT=2525
MAIL_USERNAME=null
MAIL_PASSWORD=null
MAIL_ENCRYPTION=null
MAIL_FROM_ADDRESS=null
MAIL_FROM_NAME="${APP_NAME}"

AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_DEFAULT_REGION=us-east-1
AWS_BUCKET=

PUSHER_APP_ID=
PUSHER_APP_KEY=
PUSHER_APP_SECRET=
PUSHER_APP_CLUSTER=mt1

MIX_PUSHER_APP_KEY="${PUSHER_APP_KEY}"
MIX_PUSHER_APP_CLUSTER="${PUSHER_APP_CLUSTER}"
//-------------------------------------------------------------video 43------------------------------------------------------------


routes/web.php 

video 43

//-------------------------------------------------------------video 43------------------------------------------------------------


app/Models/Post.php 

video 43 

<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;

class Post extends Model
{
    //
    protected $fillable = ['title','content'];

    public function category(){
        return $this->belongsTo('App\Models\Category');
    }

    public function tags(){  // tags là số nhiều để sau này $tag->posts , $post->tags 
        return $this->belongsToMany('App\Models\Tag'/* ,'manhpro' */);
    }



}
//-------------------------------------------------------------video 43------------------------------------------------------------


database/migrations/2021_09_10_193312_create_posts_table.php   


video 43 

<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

class CreatePostsTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::create('posts', function (Blueprint $table) {
            $table->id();
            $table->string('title');
            $table->text('content');
            $table->text('category_id')->nullable();
            $table->timestamps();
        });
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::dropIfExists('posts');
    }
}
//-------------------------------------------------------------video 43------------------------------------------------------------


resources/views/welcome.blade.php             

video 43 

<!DOCTYPE html>
<html lang="{{ str_replace('_', '-', app()->getLocale()) }}">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>Laravel</title>

        <!-- Fonts -->
        <link href="https://fonts.googleapis.com/css?family=Nunito:200,600" rel="stylesheet">

        <!-- Styles -->
        <style>
            html, body {
                background-color: #fff;
                color: #636b6f;
                font-family: 'Nunito', sans-serif;
                font-weight: 200;
                height: 100vh;
                margin: 0;
            }

            .full-height {
                height: 100vh;
            }

            .flex-center {
                align-items: center;
                display: flex;
                justify-content: center;
            }

            .position-ref {
                position: relative;
            }

            .top-right {
                position: absolute;
                right: 10px;
                top: 18px;
            }

            .content {
                text-align: center;
            }

            .title {
                font-size: 84px;
            }

            .links > a {
                color: #636b6f;
                padding: 0 25px;
                font-size: 13px;
                font-weight: 600;
                letter-spacing: .1rem;
                text-decoration: none;
                text-transform: uppercase;
            }

            .m-b-md {
                margin-bottom: 30px;
            }
        </style>
    </head>
    <body>
        <div class="flex-center position-ref full-height">
            @if (Route::has('login'))
                <div class="top-right links">
                    @auth
                        <a href="{{ url('/home') }}">Home</a>
                    @else
                        <a href="{{ route('login') }}">Login</a>

                        @if (Route::has('register'))
                            <a href="{{ route('register') }}">Register</a>
                        @endif
                    @endauth
                </div>
            @endif

            <div class="content">
                <div class="title m-b-md">
                    Laravel Nguyễn Văn Mạnh pro 
                </div>

                <div class="links">
                    <a href="https://laravel.com/docs">Docs</a>
                    <a href="https://laracasts.com">Laracasts</a>
                    <a href="https://laravel-news.com">News</a>
                    <a href="https://blog.laravel.com">Blog</a>
                    <a href="https://nova.laravel.com">Nova</a>
                    <a href="https://forge.laravel.com">Forge</a>
                    <a href="https://vapor.laravel.com">Vapor</a>
                    <a href="https://github.com/laravel/laravel">GitHub</a>
                </div>
            </div>
        </div>
    </body>
</html>
//-------------------------------------------------------------video 43------------------------------------------------------------


app/Http/Controllers/PostController.php 

video 43 

<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use App\Http\Requests\post\CreatePostRequest; // App\Http\Requests\post là namespace của file CreatePostRequest.php , CreatePostRequest là class trong file đó
use App\Models\Post;   // App\Models là namespace của file app\Models\Post.php , Post là class trong file đó
use App\Models\Category;  // App\Models là namespace của file app\Models\Post.php , Post là class trong file đó



class PostController extends Controller
{
    /**
     * Display a listing of the resource.
     *
     * @return \Illuminate\Http\Response
     */
    public function index()
    {
        //
        $posts = Post::latest()->paginate(10); // hiển thị 10 bài viết trên một trang 
        return view('post.list')->with('posts',$posts);
    }

    /**
     * Show the form for creating a new resource.
     *
     * @return \Illuminate\Http\Response
     */
    public function create()
    {
        //
        return view('post.create');
    }

    /**
     * Store a newly created resource in storage.
     *
     * @param  \Illuminate\Http\Request  $request
     * @return \Illuminate\Http\Response
     */
    public function store(CreatePostRequest $request) // thay vì dùng store(Request $request)
    {
        //
        // return 'Đây là hàm lưu';
        $post = new Post;
        $post->fill($request->all());
        $post->save();

        // sau khi mà lưu xong thì 
        return redirect('/post/create') // trở về trang cũ http://localhost:8000/post/create 
               ->with('success',true); 
    }

    /**
     * Display the specified resource.
     *
     * @param  int  $id
     * @return \Illuminate\Http\Response
     */
    public function show(/* Request $request ,*/ Post $post /* $id */ )
    {
        // return $id;
        // $post = Post::findOrFail($id);
        return view('post.detail')->with('post',$post);
    }
    public function showCategoryPost(Category $category){
        return view('post.category')->with('category',$category);
    }

    /**
     * Show the form for editing the specified resource.
     *
     * @param  int  $id
     * @return \Illuminate\Http\Response
     */
    public function edit($id)
    {
        //
    }

    /**
     * Update the specified resource in storage.
     *
     * @param  \Illuminate\Http\Request  $request
     * @param  int  $id
     * @return \Illuminate\Http\Response
     */
    public function update(Request $request, $id)
    {
        //
    }

    /**
     * Remove the specified resource from storage.
     *
     * @param  int  $id
     * @return \Illuminate\Http\Response
     */
    public function destroy($id)
    {
        //
    }
}
//-------------------------------------------------------------video 43------------------------------------------------------------


resources/views/layouts/master.blade.php            

video 43 

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>@yield('title')</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"  crossorigin="anonymous">
</head>
<body>
<div class="container">
    <div class="row">
        @yield('content')
    </div>
</div>
</body>
</html>
//-------------------------------------------------------------video 43------------------------------------------------------------


resources/views/post/create.blade.php 

video 43 

@extends('layouts.master')

@section('title','Tạo bài viết')

@section('content')

@foreach ($errors->all() as $error)
    <div class="alert alert-danger">{{ $error }}</div>
@endforeach

@if(session('success'))
    <div class="alert alert-success">
        Thêm bài viết thành công !
    </div>
@endif

<form action="{{route('post.store')}}" method="post">
    @csrf
    <div class="form-group">
        <label for="title">Tiêu đề :</label>
        <input class="form-control" type="text" name="title" value="{{old('title')}}">
    </div>
    <div class="form-group">
        <label for="content">Nội dung : </label>
        <textarea class="form-control" name="content" id="content" rows="10">{{old('content')}}</textarea>
    </div>
    <div>
        <button type="submit">Đăng bài</button>
    </div>


</form>

@endsection 
//-------------------------------------------------------------video 43------------------------------------------------------------


app/Http/Request/post/CreatePostRequest.php 

video 43 

<?php

namespace App\Http\Requests\post;

use Illuminate\Foundation\Http\FormRequest;

class CreatePostRequest extends FormRequest
{
    /**
     * Determine if the user is authorized to make this request.
     *
     * @return bool
     */
    public function authorize()
    {
        return true;
    }

    /**
     * Get the validation rules that apply to the request.
     * /
     * @return array
     */
    public function rules()
    {
        return [
            'title' => 'required|max:500|min:10',
            'content' => 'required|min:5'
        ];
    }
}
//-------------------------------------------------------------video 43------------------------------------------------------------


resources/views/post/list.blade.php 

video 43 

@extends('layouts.master')

@section('title','Danh sách bài viết')

@section('content')

<div>
    @foreach($posts as $post)
    <li><a href="{{route('post.show',['post'=>$post->id])}}">{{$post->title}}</a></li>
    @endforeach

</div>
@endsection 
//-------------------------------------------------------------video 43------------------------------------------------------------


resources/views/post/detail.blade.php

video 43 

@extends('layouts.master')

@section('title',$post->title)

@section('content')

<div>
    <h1>{{$post->title}}</h1>
    <h1>{{$post->category->name}}</h1>
    Tag:
    @foreach($post->tags as $tag)
        {{$tag->name}}
    @endforeach
    <div>{{$post->content}}</div>
</div>
@endsection 
//-------------------------------------------------------------video 43------------------------------------------------------------


app/Models/Category.php

video 43

<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;

class Category extends Model
{
    //
    public function posts(){
        return $this->hasMany('App\Models\Post');
    }
}
//-------------------------------------------------------------video 43------------------------------------------------------------


database/migrations/2021_09_11_193451_create_categories_table.php

video 43

<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

class CreateCategoriesTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::create('categories', function (Blueprint $table) {
            $table->id();
            $table->string('name');
            $table->timestamps();
        });
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::dropIfExists('categories');
    }
}
//-------------------------------------------------------------video 43------------------------------------------------------------


resources/views/post/category.blade.php

video 43 

@extends('layouts.master')

@section('title',$category->name)

@section('content')

<div>
    <h2>Các bài viết thuộc chuyên mục : {{$category->name}}</h2>
    @foreach($category->posts as $post)
    <li><a href="{{route('post.show',['post'=>$post->id])}}">{{$post->title}}</a></li>
    @endforeach
</div>
@endsection 
//-------------------------------------------------------------video 43------------------------------------------------------------


app/Models/Tag.php

video 43 

<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;

class Tag extends Model
{
    
    public function posts(){
        return $this->belongsTo('App\Models\Post'/* ,'manhpro' */);
    }
}
//-------------------------------------------------------------video 43------------------------------------------------------------


database/migrations/2021_09_12_093227_create_tags_table.php

video 43 

<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

class CreateTagsTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::create('tags', function (Blueprint $table) {
            $table->id();
            $table->string('name');
            $table->timestamps();
        });
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::dropIfExists('tags');
    }
}
//-------------------------------------------------------------video 43------------------------------------------------------------


database/migrations/2021_09_12_093901_create_post_tag_table.php

video 43

<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

class CreatePostTagsTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::create('post_tags', function (Blueprint $table) {
            $table->id();
            $table->integer('post_id');
            $table->integer('tag_id');
            $table->timestamps();
        });
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::dropIfExists('post_tags');
    }
}

<-------------------------------------------------------------video 42------------------------------------------------------------->







Laravel 44

// video 44

<?php
//-------------------------------------------------------------video 44------------------------------------------------------------
// Eagle loading (tăng tốc Eloquent model)
// + Custom Eager loading (tối ưu số query cần chạy,chạy ít query hơn)
// + Contrain query (liệt kê sẵn các bảng,trường được dùng,chạy qua các function())
// + Hàm Load() 
// Model Morph (polymorphic relation)(một bảng có quan hệ đến nhiều bảng khác): (Dùng cực kỳ nhiều)(học kỹ)
// + morphTo,morphMany
// + getAttribute (Dùng nhiều) public function get[tên_thuộc_tính]Attribute, xử lí một property của model trước khi trả về (chạy qua một function trước khi trả về)



use Illuminate\Support\Facades\Route;

/*
|--------------------------------------------------------------------------
| Web Routes
|--------------------------------------------------------------------------
|
| Here is where you can register web routes for your application. These
| routes are loaded by the RouteServiceProvider within a group which
| contains the "web" middleware group. Now create something great!
|
*/

Route::get('/', function () {
    return view('welcome');
});

// Route::get('/user/{user}')->name('user');
Route::resource('/post','PostController');

Route::get('/category/{category}','PostController@showCategoryPost');  // /category/{category} = category/id 


//-------------------------------------------------------------video 44------------------------------------------------------------


.env 

video 44

APP_NAME=Laravel
APP_ENV=local
APP_KEY=base64:IgxQxEeV4z0G0jdMPIyzCKJl7wYeD/eT3I1NCXZU5HQ=
APP_DEBUG=true
APP_URL=http://localhost

LOG_CHANNEL=stack

DB_CONNECTION=mysql
DB_HOST=localhost
DB_PORT=3306
DB_DATABASE=tintuc44
DB_USERNAME=root
DB_PASSWORD=

BROADCAST_DRIVER=log
CACHE_DRIVER=file
QUEUE_CONNECTION=sync
SESSION_DRIVER=file
SESSION_LIFETIME=120

REDIS_HOST=127.0.0.1
REDIS_PASSWORD=null
REDIS_PORT=6379

MAIL_MAILER=smtp
MAIL_HOST=smtp.mailtrap.io
MAIL_PORT=2525
MAIL_USERNAME=null
MAIL_PASSWORD=null
MAIL_ENCRYPTION=null
MAIL_FROM_ADDRESS=null
MAIL_FROM_NAME="${APP_NAME}"

AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_DEFAULT_REGION=us-east-1
AWS_BUCKET=

PUSHER_APP_ID=
PUSHER_APP_KEY=
PUSHER_APP_SECRET=
PUSHER_APP_CLUSTER=mt1

MIX_PUSHER_APP_KEY="${PUSHER_APP_KEY}"
MIX_PUSHER_APP_CLUSTER="${PUSHER_APP_CLUSTER}"
//-------------------------------------------------------------video 44------------------------------------------------------------


app/Http/Controllers/PostController.php 

video 44

<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use App\Http\Requests\post\CreatePostRequest; // App\Http\Requests\post là namespace của file CreatePostRequest.php , CreatePostRequest là class trong file đó
use App\Models\Post;   // App\Models là namespace của file app\Models\Post.php , Post là class trong file đó
use App\Models\Category;  // App\Models là namespace của file app\Models\Post.php , Post là class trong file đó



class PostController extends Controller
{
    /**
     * Display a listing of the resource.
     *
     * @return \Illuminate\Http\Response
     */
    public function index()
    {
        //

        // video44
        // comment của bài viết (post)
        // $post = Post::whereId(1)->first();
        // $post->comments()->create([
        //         'content' => 'comment 1'
        //     ]);
        // return $post->title;

        // video44 
        // comment của chuyên mục (category)
        $category = Category::find(1);
        $category->comments()->create([
            'content' => 'đây là comment chuyên mục'
        ]);






        $posts = Post::latest()->paginate(10); // hiển thị 10 bài viết trên một trang 
        return view('post.list')->with('posts',$posts);
    }

    /**
     * Show the form for creating a new resource.
     *
     * @return \Illuminate\Http\Response
     */
    public function create()
    {
        //
        return view('post.create');
    }

    /**
     * Store a newly created resource in storage.
     *
     * @param  \Illuminate\Http\Request  $request
     * @return \Illuminate\Http\Response
     */
    public function store(CreatePostRequest $request) // thay vì dùng store(Request $request)
    {
        //
        // return 'Đây là hàm lưu';
        $post = new Post;
        $post->fill($request->all());
        $post->save();

        // sau khi mà lưu xong thì 
        return redirect('/post/create') // trở về trang cũ http://localhost:8000/post/create 
               ->with('success',true); 
    }

    /**
     * Display the specified resource.
     *
     * @param  int  $id
     * @return \Illuminate\Http\Response
     */
    // public function show(/* Request $request ,*/ Post $post /* $id */ )
    // {
    //     // return $id;
    //     // $post = Post::findOrFail($id);
    //     return view('post.detail')->with('post',$post);
    // }
    public function show($id) 
    {
        // $post = Post::whereId($id)->with('category:id,name')->with('tags:id,name')->firstOrFail();
        $post = Post::whereId($id)
                ->with('category:id,name')
                ->with(['tags' => function($query){
                    // return $query->orderBy('create_at')->limit(5);
                    return $query->orderByDesc('created_at')->limit(1);

                }])
                ->with('comments')
                ->firstOrFail();

        // lấy ra tag đầu tiên 
        // $firstTag = $post->tags->first(); // cách 1
        // select * from tags where id = posts.id => đọc tất cả mới nhặt ra 1 cái 
       
        // $firstTag = $post->tags()->first();// cách 2  // nhanh hơn , đọc 1 phát là 1 cái luôn 
        // select * from tags where id = posts.id limit 1 

        // cũng phải tùy từng trường hợp mà viết theo cách 1 hay cách 2 
        /* Giống như fb , một bài viết thì chỉ load vài comment thôi , nếu muốn xem nhiều hơn => bấm xem thêm => lúc này mới load ra nhiều hơn để xem , còn nếu mà ban đầu load hết luôn thì serve sẽ mệt*/
        return view('post.detail')->with('post',$post);
    }





    public function showCategoryPost(/* Category $category */ $id){
        $category = Category::whereId($id)
                              ->with('comments')
                              ->first();
        return view('post.category')->with('category',$category);
    }

    // public function showCategoryPost( Category $category /* $id */){
    //     $category->load('comments');
    //     return view('post.category')->with('category',$category);
    // }

    /**
     * Show the form for editing the specified resource.
     *
     * @param  int  $id
     * @return \Illuminate\Http\Response
     */
    public function edit($id)
    {
        //
    }

    /**
     * Update the specified resource in storage.
     *
     * @param  \Illuminate\Http\Request  $request
     * @param  int  $id
     * @return \Illuminate\Http\Response
     */
    public function update(Request $request, $id)
    {
        //
    }

    /**
     * Remove the specified resource from storage.
     *
     * @param  int  $id
     * @return \Illuminate\Http\Response
     */
    public function destroy($id)
    {
        //
    }
}
//-------------------------------------------------------------video 44------------------------------------------------------------


resources/views/post/detail.blade.php

video 44

@extends('layouts.master')

@section('title',$post->title)

@section('content')

<div>
    <h1>{{$post->title}}</h1>
    <h1>{{$post->category->name}}</h1>
    Tag:
    @foreach($post->tags as $tag)
        {{$tag->name}}
    @endforeach
    <div>{{$post->content}}</div>
    <div>
        Comments:
        @foreach($post->comments as $comment)
        {{$comment->content}}
    @endforeach
    </div>
</div>
@endsection 
//-------------------------------------------------------------video 44------------------------------------------------------------


app/Models/Comment.php

video 44

<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;

class Comment extends Model
{
    //
    protected $fillable = ['content'];
    function commentable(){
        return $this->morphTo();
    }
    function reply(){
        return $this->morphMany('App\Models\Comment','commentable');
    }
}
//-------------------------------------------------------------video 44------------------------------------------------------------


database/migrations/2021_09_13_110058_create_comments_table

video 44

<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

class CreateCommentsTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::create('comments', function (Blueprint $table) {
            $table->id();
            $table->text('content');
            $table->integer('commentable_id');
            $table->string('commentable_type');
            $table->timestamps();
        });
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::dropIfExists('comments');
    }
}
//-------------------------------------------------------------video 44------------------------------------------------------------


app/Models/Post.php 

video 44

<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;

class Post extends Model
{
    //
    protected $fillable = ['title','content'];

    public function getTitleAttribute($value){  // xử lí title trước khi trả về
        return 'abc '.$value;
    }

    public function category(){
        return $this->belongsTo('App\Models\Category');
    }

    public function tags(){  // tags là số nhiều để sau này $tag->posts , $post->tags 
        return $this->belongsToMany('App\Models\Tag' /* ,'manhpro' */);
    }

    public function comments(){
        return $this->morphMany('App\Models\Comment','commentable');
    }

}
//-------------------------------------------------------------video 44------------------------------------------------------------


app/Models/Category.php

video 44

<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;

class Category extends Model
{
    //
    public function posts(){
        return $this->hasMany('App\Models\Post');
    }

    public function comments(){
        return $this->morphMany('App\Models\Comment','commentable');
    }
}
//-------------------------------------------------------------video 44------------------------------------------------------------


resources/views/post/category.blade.php

video 44

@extends('layouts.master')

@section('title',$category->name)

@section('content')

<div>
    <h2>Các bài viết thuộc chuyên mục : {{$category->name}}</h2>
    @foreach($category->posts as $post)
    <li><a href="{{route('post.show',['post'=>$post->id])}}">{{$post->title}}</a></li>
    @endforeach
</div>
<div>
    @foreach($category->comments as $comment)
    {{$comment->content}}
    @endforeach
</div>
@endsection 
//-------------------------------------------------------------video 44------------------------------------------------------------


app/Models/Menu.php

video 44

<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;

class Menu extends Model
{
    //
    public function children(){
        return $this->hasMany('App\Models\Menu');
    }

    public function parrentMenu(){
        return $this->belongsTo('App\Models\Menu','parrent_id');
    }
}
//-------------------------------------------------------------video 44------------------------------------------------------------


app/Http/Controllers/MenuController.php 

video 44

<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;

class MenuController extends Controller
{
    //
    public function getAllMenu(){
        $allMenu = Menu::whereNull('parrent_id')
                        ->with(['children' => function($query){
                            return $query->with('children');
                        }])
                        ->get();
    }
}
<-------------------------------------------------------------video 44------------------------------------------------------------->







Laravel 45 

// video 45 

<?php
//-------------------------------------------------------------video 45------------------------------------------------------------
// Collection, dd($biến), 
// Các hàm thường dùng của Collection : max(), min(), toArray(), unique(), every(), fillter(), take(), pluck(), pop(), sum(), avg(), shuffle(),...
// Validation, viết các luật vào rules(),file xuất ra các luật : resources/lang/en/validation.php, viết các lỗi tùy ý vào đó
// resources/lang/en : có các file chứa các lỗi , thay đổi ngôn ngữ xuất lỗi : /lang/en, /lang/vi 
// ::attribute, function attributes() sửa tên các thuộc tính, các trường thành ý mình 
// Rules() : Các luật trong rules(), hai cách ghi luật 
// Luật trong rules() : required, max, min, email, integer, alpha, alpha_dash, number, string, in, unique, array, ends with, url, image, nullable, confirmed, date
// Custom rules(), Tự viết một hàm để check, use hàm của class trong file đó vào rules() của file request để check 
// Tạo file rules : php artisan make:rule [tên_file]
// passes() : viết luật, message() : hiển thị lỗi của file rules
// Auth và Middleware (quan trọng)
// Authentication
// composer require laravel/ui:^2.4
// php artisan ui vue --auth, dùng react thì php artisan ui react --auth
// Có nhiều file của framework Laravel, Vue được tự động tạo 
// Middleware
// Thêm middleware cho một route (thêm middleware cho một thành phần) 
// Tạo middleware : php artisan make:middleware [tên_file]
// Đăng kí middleware vào file app\Http\Kernel.php
// Dùng middleware (thêm middleware cho một route (thành phần))
// function handle() trong một file middleware
// Các tham số, truyền tham số vào middleware khi dùng,lấy các giá trị được truyền vào bằng biến,truyền nhiều giá trị,lấy nhiều giá trị cùng lúc bằng cách lưu mảng
// ví dụ về Hệ thống 2 role : admin và user



use Illuminate\Support\Facades\Route;

/*
|--------------------------------------------------------------------------
| Web Routes
|--------------------------------------------------------------------------
|
| Here is where you can register web routes for your application. These
| routes are loaded by the RouteServiceProvider within a group which
| contains the "web" middleware group. Now create something great!
|
*/

Route::get('/', function () {
    return view('welcome');
});

// Route::get('/user/{user}')->name('user');
// Route::get('/post/create','PostController@create')->middleware(['auth','blockIp:manh,20']);
// Route::get('/post/create','PostController@create')->middleware(['auth','role:admin']);
Route::get('/post/create','PostController@create')->middleware(['auth','role:admin,user']);
Route::post('/post/store','PostController@store')->name('post.store');

Route::get('/category/{category}','PostController@showCategoryPost');  // /category/{category} = category/id 

// Route::get('/abc','xyz...')->middleware('blockIp');


Auth::routes();

Route::get('/home', 'HomeController@index')->name('home');

//-------------------------------------------------------------video 45------------------------------------------------------------


.env 

video 45 

APP_NAME=Laravel
APP_ENV=local
APP_KEY=base64:IgxQxEeV4z0G0jdMPIyzCKJl7wYeD/eT3I1NCXZU5HQ=
APP_DEBUG=true
APP_URL=http://localhost

LOG_CHANNEL=stack

DB_CONNECTION=mysql
DB_HOST=localhost
DB_PORT=3306
DB_DATABASE=tintuc45
DB_USERNAME=root
DB_PASSWORD=

BROADCAST_DRIVER=log
CACHE_DRIVER=file
QUEUE_CONNECTION=sync
SESSION_DRIVER=file
SESSION_LIFETIME=120

REDIS_HOST=127.0.0.1
REDIS_PASSWORD=null
REDIS_PORT=6379

MAIL_MAILER=smtp
MAIL_HOST=smtp.mailtrap.io
MAIL_PORT=2525
MAIL_USERNAME=null
MAIL_PASSWORD=null
MAIL_ENCRYPTION=null
MAIL_FROM_ADDRESS=null
MAIL_FROM_NAME="${APP_NAME}"

AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_DEFAULT_REGION=us-east-1
AWS_BUCKET=

PUSHER_APP_ID=
PUSHER_APP_KEY=
PUSHER_APP_SECRET=
PUSHER_APP_CLUSTER=mt1

MIX_PUSHER_APP_KEY="${PUSHER_APP_KEY}"
MIX_PUSHER_APP_CLUSTER="${PUSHER_APP_CLUSTER}"
//-------------------------------------------------------------video 45------------------------------------------------------------


app/Http/Controllers/PostController.php 

video 45

<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use App\Http\Requests\post\CreatePostRequest; // App\Http\Requests\post là namespace của file CreatePostRequest.php , CreatePostRequest là class trong file đó
use App\Models\Post;   // App\Models là namespace của file app\Models\Post.php , Post là class trong file đó
use App\Models\Category;  // App\Models là namespace của file app\Models\Post.php , Post là class trong file đó



class PostController extends Controller
{
    /**
     * Display a listing of the resource.
     *
     * @return \Illuminate\Http\Response
     */
    public function index()
    {
        //

        // video44
        // comment của bài viết (post)
        // $post = Post::whereId(1)->first();
        // $post->comments()->create([
        //         'content' => 'comment 1'
        //     ]);
        // return $post->title;

        // video44 
        // comment của chuyên mục (category)
        $category = Category::find(1);
        $category->comments()->create([
            'content' => 'đây là comment chuyên mục'
        ]);


        // $titles = $posts->pluck('title');





        $posts = Post::latest()->paginate(10); // hiển thị 10 bài viết trên một trang 
        $posts = Post::latest()->first();
        dd($posts);
        return view('post.list')->with('posts',$posts);
    }

    /**
     * Show the form for creating a new resource.
     *
     * @return \Illuminate\Http\Response
     */
    public function create()
    {
        //
        return view('post.create');
    }

    /**
     * Store a newly created resource in storage.
     *
     * @param  \Illuminate\Http\Request  $request
     * @return \Illuminate\Http\Response
     */
    public function store(CreatePostRequest $request) // thay vì dùng store(Request $request)
    {
        //
        // return 'Đây là hàm lưu';
        $post = new Post;
        $post->fill($request->all());
        $post->save();

        // sau khi mà lưu xong thì 
        return redirect('/post/create') // trở về trang cũ http://localhost:8000/post/create 
               ->with('success',true); 
    }

    /**
     * Display the specified resource.
     *
     * @param  int  $id
     * @return \Illuminate\Http\Response
     */
    // public function show(/* Request $request ,*/ Post $post /* $id */ )
    // {
    //     // return $id;
    //     // $post = Post::findOrFail($id);
    //     return view('post.detail')->with('post',$post);
    // }
    public function show($id) 
    {
        // $post = Post::whereId($id)->with('category:id,name')->with('tags:id,name')->firstOrFail();
        $post = Post::whereId($id)
                ->with('category:id,name')
                ->with(['tags' => function($query){
                    // return $query->orderBy('create_at')->limit(5);
                    return $query->orderByDesc('created_at')->limit(1);

                }])
                ->with('comments')
                ->firstOrFail();

        // lấy ra tag đầu tiên 
        // $firstTag = $post->tags->first(); // cách 1
        // select * from tags where id = posts.id => đọc tất cả mới nhặt ra 1 cái 
       
        // $firstTag = $post->tags()->first();// cách 2  // nhanh hơn , đọc 1 phát là 1 cái luôn 
        // select * from tags where id = posts.id limit 1 

        // cũng phải tùy từng trường hợp mà viết theo cách 1 hay cách 2 
        /* Giống như fb , một bài viết thì chỉ load vài comment thôi , nếu muốn xem nhiều hơn => bấm xem thêm => lúc này mới load ra nhiều hơn để xem , còn nếu mà ban đầu load hết luôn thì serve sẽ mệt*/
        return view('post.detail')->with('post',$post);
    }





    public function showCategoryPost(/* Category $category */ $id){
        $category = Category::whereId($id)
                              ->with('comments')
                              ->first();
        return view('post.category')->with('category',$category);
    }

    // public function showCategoryPost( Category $category /* $id */){
    //     $category->load('comments');
    //     return view('post.category')->with('category',$category);
    // }

    /**
     * Show the form for editing the specified resource.
     *
     * @param  int  $id
     * @return \Illuminate\Http\Response
     */
    public function edit($id)
    {
        //
    }

    /**
     * Update the specified resource in storage.
     *
     * @param  \Illuminate\Http\Request  $request
     * @param  int  $id
     * @return \Illuminate\Http\Response
     */
    public function update(Request $request, $id)
    {
        //
    }

    /**
     * Remove the specified resource from storage.
     *
     * @param  int  $id
     * @return \Illuminate\Http\Response
     */
    public function destroy($id)
    {
        //
    }
}
//-------------------------------------------------------------video 45------------------------------------------------------------


resources/lang/en/validation.php

video 45 

<?php

return [

    /*
    |--------------------------------------------------------------------------
    | Validation Language Lines
    |--------------------------------------------------------------------------
    |
    | The following language lines contain the default error messages used by
    | the validator class. Some of these rules have multiple versions such
    | as the size rules. Feel free to tweak each of these messages here.
    |
    */

    'accepted' => 'The :attribute must be accepted.',
    'active_url' => 'The :attribute is not a valid URL.',
    'after' => 'The :attribute must be a date after :date.',
    'after_or_equal' => 'The :attribute must be a date after or equal to :date.',
    'alpha' => 'The :attribute may only contain letters.',
    'alpha_dash' => 'The :attribute may only contain letters, numbers, dashes and underscores.',
    'alpha_num' => 'The :attribute may only contain letters and numbers.',
    'array' => 'The :attribute must be an array.',
    'before' => 'The :attribute must be a date before :date.',
    'before_or_equal' => 'The :attribute must be a date before or equal to :date.',
    'between' => [
        'numeric' => 'The :attribute must be between :min and :max.',
        'file' => 'The :attribute must be between :min and :max kilobytes.',
        'string' => 'The :attribute must be between :min and :max characters.',
        'array' => 'The :attribute must have between :min and :max items.',
    ],
    'boolean' => 'The :attribute field must be true or false.',
    'confirmed' => 'The :attribute confirmation does not match.',
    'date' => 'The :attribute is not a valid date.',
    'date_equals' => 'The :attribute must be a date equal to :date.',
    'date_format' => 'The :attribute does not match the format :format.',
    'different' => 'The :attribute and :other must be different.',
    'digits' => 'The :attribute must be :digits digits.',
    'digits_between' => 'The :attribute must be between :min and :max digits.',
    'dimensions' => 'The :attribute has invalid image dimensions.',
    'distinct' => 'The :attribute field has a duplicate value.',
    'email' => 'The :attribute must be a valid email address.',
    'ends_with' => 'The :attribute must end with one of the following: :values.',
    'exists' => 'The selected :attribute is invalid.',
    'file' => 'The :attribute must be a file.',
    'filled' => 'The :attribute field must have a value.',
    'gt' => [
        'numeric' => 'The :attribute must be greater than :value.',
        'file' => 'The :attribute must be greater than :value kilobytes.',
        'string' => 'The :attribute must be greater than :value characters.',
        'array' => 'The :attribute must have more than :value items.',
    ],
    'gte' => [
        'numeric' => 'The :attribute must be greater than or equal :value.',
        'file' => 'The :attribute must be greater than or equal :value kilobytes.',
        'string' => 'The :attribute must be greater than or equal :value characters.',
        'array' => 'The :attribute must have :value items or more.',
    ],
    'image' => 'The :attribute must be an image.',
    'in' => 'The selected :attribute is invalid.',
    'in_array' => 'The :attribute field does not exist in :other.',
    'integer' => 'The :attribute must be an integer.',
    'ip' => 'The :attribute must be a valid IP address.',
    'ipv4' => 'The :attribute must be a valid IPv4 address.',
    'ipv6' => 'The :attribute must be a valid IPv6 address.',
    'json' => 'The :attribute must be a valid JSON string.',
    'lt' => [
        'numeric' => 'The :attribute must be less than :value.',
        'file' => 'The :attribute must be less than :value kilobytes.',
        'string' => 'The :attribute must be less than :value characters.',
        'array' => 'The :attribute must have less than :value items.',
    ],
    'lte' => [
        'numeric' => 'The :attribute must be less than or equal :value.',
        'file' => 'The :attribute must be less than or equal :value kilobytes.',
        'string' => 'The :attribute must be less than or equal :value characters.',
        'array' => 'The :attribute must not have more than :value items.',
    ],
    'max' => [
        'numeric' => 'The :attribute may not be greater than :max.',
        'file' => 'The :attribute may not be greater than :max kilobytes.',
        'string' => 'The :attribute may not be greater than :max characters.',
        'array' => 'The :attribute may not have more than :max items.',
    ],
    'mimes' => 'The :attribute must be a file of type: :values.',
    'mimetypes' => 'The :attribute must be a file of type: :values.',
    'min' => [
        'numeric' => 'The :attribute must be at least :min.',
        'file' => 'The :attribute must be at least :min kilobytes.',
        'string' => 'The :attribute must be at least :min characters.',
        'array' => 'The :attribute must have at least :min items.',
    ],
    'not_in' => 'The selected :attribute is invalid.',
    'not_regex' => 'The :attribute format is invalid.',
    'numeric' => 'The :attribute must be a number.',
    'password' => 'The password is incorrect.',
    'present' => 'The :attribute field must be present.',
    'regex' => 'The :attribute format is invalid.',
    'required' => 'The :attribute field is requiredssssssss.',
    'required_if' => 'The :attribute field is required when :other is :value.',
    'required_unless' => 'The :attribute field is required unless :other is in :values.',
    'required_with' => 'The :attribute field is required when :values is present.',
    'required_with_all' => 'The :attribute field is required when :values are present.',
    'required_without' => 'The :attribute field is required when :values is not present.',
    'required_without_all' => 'The :attribute field is required when none of :values are present.',
    'same' => 'The :attribute and :other must match.',
    'size' => [
        'numeric' => 'The :attribute must be :size.',
        'file' => 'The :attribute must be :size kilobytes.',
        'string' => 'The :attribute must be :size characters.',
        'array' => 'The :attribute must contain :size items.',
    ],
    'starts_with' => 'The :attribute must start with one of the following: :values.',
    'string' => 'The :attribute must be a string.',
    'timezone' => 'The :attribute must be a valid zone.',
    'unique' => 'The :attribute has already been taken.',
    'uploaded' => 'The :attribute failed to upload.',
    'url' => 'The :attribute format is invalid.',
    'uuid' => 'The :attribute must be a valid UUID.',

    /*
    |--------------------------------------------------------------------------
    | Custom Validation Language Lines
    |--------------------------------------------------------------------------
    |
    | Here you may specify custom validation messages for attributes using the
    | convention "attribute.rule" to name the lines. This makes it quick to
    | specify a specific custom language line for a given attribute rule.
    |
    */

    'custom' => [
        'attribute-name' => [
            'rule-name' => 'custom-message',
        ],
    ],

    /*
    |--------------------------------------------------------------------------
    | Custom Validation Attributes
    |--------------------------------------------------------------------------
    |
    | The following language lines are used to swap our attribute placeholder
    | with something more reader friendly such as "E-Mail Address" instead
    | of "email". This simply helps us make our message more expressive.
    |
    */

    'attributes' => [],

];
//-------------------------------------------------------------video 45------------------------------------------------------------


resources/views/post/create.blade.php

video 45 

@extends('layouts.master')

@section('title','Tạo bài viết')

@section('content')

@foreach ($errors->all() as $error)
    <div class="alert alert-danger">{{ $error }}</div>
@endforeach

@if(session('success'))
    <div class="alert alert-success">
        Thêm bài viết thành công !
    </div>
@endif

<form action="{{route('post.store')}}" method="post">
    @csrf
    <div class="form-group">
        <label for="title">Tiêu đề :</label>
        <input class="form-control" type="text" name="title" value="{{old('title')}}">
    </div>
    <div class="form-group">
        <label for="content">Nội dung : </label>
        <textarea class="form-control" name="content" id="content" rows="10">{{old('content')}}</textarea>
    </div>
    <div>
        <button type="submit">Đăng bài</button>
    </div>


</form>

@endsection 
//-------------------------------------------------------------video 45------------------------------------------------------------


resources/lang/en/

video 45

//-------------------------------------------------------------video 45------------------------------------------------------------


resources/lang/vi/

video 45 

//-------------------------------------------------------------video 45------------------------------------------------------------


config/app.php 

video 45

<?php

return [

    /*
    |--------------------------------------------------------------------------
    | Application Name
    |--------------------------------------------------------------------------
    |
    | This value is the name of your application. This value is used when the
    | framework needs to place the application's name in a notification or
    | any other location as required by the application or its packages.
    |
    */

    'name' => env('APP_NAME', 'Laravel'),

    /*
    |--------------------------------------------------------------------------
    | Application Environment
    |--------------------------------------------------------------------------
    |
    | This value determines the "environment" your application is currently
    | running in. This may determine how you prefer to configure various
    | services the application utilizes. Set this in your ".env" file.
    |
    */

    'env' => env('APP_ENV', 'production'),

    /*
    |--------------------------------------------------------------------------
    | Application Debug Mode
    |--------------------------------------------------------------------------
    |
    | When your application is in debug mode, detailed error messages with
    | stack traces will be shown on every error that occurs within your
    | application. If disabled, a simple generic error page is shown.
    |
    */

    'debug' => env('APP_DEBUG', false),

    /*
    |--------------------------------------------------------------------------
    | Application URL
    |--------------------------------------------------------------------------
    |
    | This URL is used by the console to properly generate URLs when using
    | the Artisan command line tool. You should set this to the root of
    | your application so that it is used when running Artisan tasks.
    |
    */

    'url' => env('APP_URL', 'http://localhost'),

    'asset_url' => env('ASSET_URL', null),

    /*
    |--------------------------------------------------------------------------
    | Application Timezone
    |--------------------------------------------------------------------------
    |
    | Here you may specify the default timezone for your application, which
    | will be used by the PHP date and date-time functions. We have gone
    | ahead and set this to a sensible default for you out of the box.
    |
    */

    'timezone' => 'UTC',

    /*
    |--------------------------------------------------------------------------
    | Application Locale Configuration
    |--------------------------------------------------------------------------
    |
    | The application locale determines the default locale that will be used
    | by the translation service provider. You are free to set this value
    | to any of the locales which will be supported by the application.
    |
    */

    'locale' => 'vi',

    /*
    |--------------------------------------------------------------------------
    | Application Fallback Locale
    |--------------------------------------------------------------------------
    |
    | The fallback locale determines the locale to use when the current one
    | is not available. You may change the value to correspond to any of
    | the language folders that are provided through your application.
    |
    */

    'fallback_locale' => 'en',

    /*
    |--------------------------------------------------------------------------
    | Faker Locale
    |--------------------------------------------------------------------------
    |
    | This locale will be used by the Faker PHP library when generating fake
    | data for your database seeds. For example, this will be used to get
    | localized telephone numbers, street address information and more.
    |
    */

    'faker_locale' => 'en_US',

    /*
    |--------------------------------------------------------------------------
    | Encryption Key
    |--------------------------------------------------------------------------
    |
    | This key is used by the Illuminate encrypter service and should be set
    | to a random, 32 character string, otherwise these encrypted strings
    | will not be safe. Please do this before deploying an application!
    |
    */

    'key' => env('APP_KEY'),

    'cipher' => 'AES-256-CBC',

    /*
    |--------------------------------------------------------------------------
    | Autoloaded Service Providers
    |--------------------------------------------------------------------------
    |
    | The service providers listed here will be automatically loaded on the
    | request to your application. Feel free to add your own services to
    | this array to grant expanded functionality to your applications.
    |
    */

    'providers' => [

        /*
         * Laravel Framework Service Providers...
         */
        Illuminate\Auth\AuthServiceProvider::class,
        Illuminate\Broadcasting\BroadcastServiceProvider::class,
        Illuminate\Bus\BusServiceProvider::class,
        Illuminate\Cache\CacheServiceProvider::class,
        Illuminate\Foundation\Providers\ConsoleSupportServiceProvider::class,
        Illuminate\Cookie\CookieServiceProvider::class,
        Illuminate\Database\DatabaseServiceProvider::class,
        Illuminate\Encryption\EncryptionServiceProvider::class,
        Illuminate\Filesystem\FilesystemServiceProvider::class,
        Illuminate\Foundation\Providers\FoundationServiceProvider::class,
        Illuminate\Hashing\HashServiceProvider::class,
        Illuminate\Mail\MailServiceProvider::class,
        Illuminate\Notifications\NotificationServiceProvider::class,
        Illuminate\Pagination\PaginationServiceProvider::class,
        Illuminate\Pipeline\PipelineServiceProvider::class,
        Illuminate\Queue\QueueServiceProvider::class,
        Illuminate\Redis\RedisServiceProvider::class,
        Illuminate\Auth\Passwords\PasswordResetServiceProvider::class,
        Illuminate\Session\SessionServiceProvider::class,
        Illuminate\Translation\TranslationServiceProvider::class,
        Illuminate\Validation\ValidationServiceProvider::class,
        Illuminate\View\ViewServiceProvider::class,

        /*
         * Package Service Providers...
         */

        /*
         * Application Service Providers...
         */
        App\Providers\AppServiceProvider::class,
        App\Providers\AuthServiceProvider::class,
        // App\Providers\BroadcastServiceProvider::class,
        App\Providers\EventServiceProvider::class,
        App\Providers\RouteServiceProvider::class,

    ],

    /*
    |--------------------------------------------------------------------------
    | Class Aliases
    |--------------------------------------------------------------------------
    |
    | This array of class aliases will be registered when this application
    | is started. However, feel free to register as many as you wish as
    | the aliases are "lazy" loaded so they don't hinder performance.
    |
    */

    'aliases' => [

        'App' => Illuminate\Support\Facades\App::class,
        'Arr' => Illuminate\Support\Arr::class,
        'Artisan' => Illuminate\Support\Facades\Artisan::class,
        'Auth' => Illuminate\Support\Facades\Auth::class,
        'Blade' => Illuminate\Support\Facades\Blade::class,
        'Broadcast' => Illuminate\Support\Facades\Broadcast::class,
        'Bus' => Illuminate\Support\Facades\Bus::class,
        'Cache' => Illuminate\Support\Facades\Cache::class,
        'Config' => Illuminate\Support\Facades\Config::class,
        'Cookie' => Illuminate\Support\Facades\Cookie::class,
        'Crypt' => Illuminate\Support\Facades\Crypt::class,
        'DB' => Illuminate\Support\Facades\DB::class,
        'Eloquent' => Illuminate\Database\Eloquent\Model::class,
        'Event' => Illuminate\Support\Facades\Event::class,
        'File' => Illuminate\Support\Facades\File::class,
        'Gate' => Illuminate\Support\Facades\Gate::class,
        'Hash' => Illuminate\Support\Facades\Hash::class,
        'Http' => Illuminate\Support\Facades\Http::class,
        'Lang' => Illuminate\Support\Facades\Lang::class,
        'Log' => Illuminate\Support\Facades\Log::class,
        'Mail' => Illuminate\Support\Facades\Mail::class,
        'Notification' => Illuminate\Support\Facades\Notification::class,
        'Password' => Illuminate\Support\Facades\Password::class,
        'Queue' => Illuminate\Support\Facades\Queue::class,
        'Redirect' => Illuminate\Support\Facades\Redirect::class,
        'Redis' => Illuminate\Support\Facades\Redis::class,
        'Request' => Illuminate\Support\Facades\Request::class,
        'Response' => Illuminate\Support\Facades\Response::class,
        'Route' => Illuminate\Support\Facades\Route::class,
        'Schema' => Illuminate\Support\Facades\Schema::class,
        'Session' => Illuminate\Support\Facades\Session::class,
        'Storage' => Illuminate\Support\Facades\Storage::class,
        'Str' => Illuminate\Support\Str::class,
        'URL' => Illuminate\Support\Facades\URL::class,
        'Validator' => Illuminate\Support\Facades\Validator::class,
        'View' => Illuminate\Support\Facades\View::class,

    ],

];
//-------------------------------------------------------------video 45------------------------------------------------------------


resources/lang/vi/validation.php

video 45

<?php

return [

    /*
    |--------------------------------------------------------------------------
    | Validation Language Lines
    |--------------------------------------------------------------------------
    |
    | The following language lines contain the default error messages used by
    | the validator class. Some of these rules have multiple versions such
    | as the size rules. Feel free to tweak each of these messages here.
    |
    */

    'accepted' => 'The :attribute must be accepted.',
    'active_url' => 'The :attribute is not a valid URL.',
    'after' => 'The :attribute must be a date after :date.',
    'after_or_equal' => 'The :attribute must be a date after or equal to :date.',
    'alpha' => 'The :attribute may only contain letters.',
    'alpha_dash' => 'The :attribute may only contain letters, numbers, dashes and underscores.',
    'alpha_num' => 'The :attribute may only contain letters and numbers.',
    'array' => 'The :attribute must be an array.',
    'before' => 'The :attribute must be a date before :date.',
    'before_or_equal' => 'The :attribute must be a date before or equal to :date.',
    'between' => [
        'numeric' => 'The :attribute must be between :min and :max.',
        'file' => 'The :attribute must be between :min and :max kilobytes.',
        'string' => 'The :attribute must be between :min and :max characters.',
        'array' => 'The :attribute must have between :min and :max items.',
    ],
    'boolean' => 'The :attribute field must be true or false.',
    'confirmed' => 'The :attribute confirmation does not match.',
    'date' => 'The :attribute is not a valid date.',
    'date_equals' => 'The :attribute must be a date equal to :date.',
    'date_format' => 'The :attribute does not match the format :format.',
    'different' => 'The :attribute and :other must be different.',
    'digits' => 'The :attribute must be :digits digits.',
    'digits_between' => 'The :attribute must be between :min and :max digits.',
    'dimensions' => 'The :attribute has invalid image dimensions.',
    'distinct' => 'The :attribute field has a duplicate value.',
    'email' => 'The :attribute must be a valid email address.',
    'ends_with' => 'The :attribute must end with one of the following: :values.',
    'exists' => 'The selected :attribute is invalid.',
    'file' => 'The :attribute must be a file.',
    'filled' => 'The :attribute field must have a value.',
    'gt' => [
        'numeric' => 'The :attribute must be greater than :value.',
        'file' => 'The :attribute must be greater than :value kilobytes.',
        'string' => 'The :attribute must be greater than :value characters.',
        'array' => 'The :attribute must have more than :value items.',
    ],
    'gte' => [
        'numeric' => 'The :attribute must be greater than or equal :value.',
        'file' => 'The :attribute must be greater than or equal :value kilobytes.',
        'string' => 'The :attribute must be greater than or equal :value characters.',
        'array' => 'The :attribute must have :value items or more.',
    ],
    'image' => 'The :attribute must be an image.',
    'in' => 'The selected :attribute is invalid.',
    'in_array' => 'The :attribute field does not exist in :other.',
    'integer' => 'The :attribute must be an integer.',
    'ip' => 'The :attribute must be a valid IP address.',
    'ipv4' => 'The :attribute must be a valid IPv4 address.',
    'ipv6' => 'The :attribute must be a valid IPv6 address.',
    'json' => 'The :attribute must be a valid JSON string.',
    'lt' => [
        'numeric' => 'The :attribute must be less than :value.',
        'file' => 'The :attribute must be less than :value kilobytes.',
        'string' => 'The :attribute must be less than :value characters.',
        'array' => 'The :attribute must have less than :value items.',
    ],
    'lte' => [
        'numeric' => 'The :attribute must be less than or equal :value.',
        'file' => 'The :attribute must be less than or equal :value kilobytes.',
        'string' => 'The :attribute must be less than or equal :value characters.',
        'array' => 'The :attribute must not have more than :value items.',
    ],
    'max' => [
        'numeric' => 'The :attribute may not be greater than :max.',
        'file' => 'The :attribute may not be greater than :max kilobytes.',
        'string' => 'The :attribute may not be greater than :max characters.',
        'array' => 'The :attribute may not have more than :max items.',
    ],
    'mimes' => 'The :attribute must be a file of type: :values.',
    'mimetypes' => 'The :attribute must be a file of type: :values.',
    'min' => [
        'numeric' => 'The :attribute must be at least :min.',
        'file' => 'The :attribute must be at least :min kilobytes.',
        'string' => 'The :attribute must be at least :min characters.',
        'array' => 'The :attribute must have at least :min items.',
    ],
    'not_in' => 'The selected :attribute is invalid.',
    'not_regex' => 'The :attribute format is invalid.',
    'numeric' => 'The :attribute must be a number.',
    'password' => 'The password is incorrect.',
    'present' => 'The :attribute field must be present.',
    'regex' => 'The :attribute format is invalid.',
    'required' => 'Trường :attribute là bắt buộc.',
    // 'required' => 'The :attribute field is requiredssssssss.',
    'required_if' => 'The :attribute field is required when :other is :value.',
    'required_unless' => 'The :attribute field is required unless :other is in :values.',
    'required_with' => 'The :attribute field is required when :values is present.',
    'required_with_all' => 'The :attribute field is required when :values are present.',
    'required_without' => 'The :attribute field is required when :values is not present.',
    'required_without_all' => 'The :attribute field is required when none of :values are present.',
    'same' => 'The :attribute and :other must match.',
    'size' => [
        'numeric' => 'The :attribute must be :size.',
        'file' => 'The :attribute must be :size kilobytes.',
        'string' => 'The :attribute must be :size characters.',
        'array' => 'The :attribute must contain :size items.',
    ],
    'starts_with' => 'The :attribute must start with one of the following: :values.',
    'string' => 'The :attribute must be a string.',
    'timezone' => 'The :attribute must be a valid zone.',
    'unique' => 'The :attribute has already been taken.',
    'uploaded' => 'The :attribute failed to upload.',
    'url' => 'The :attribute format is invalid.',
    'uuid' => 'The :attribute must be a valid UUID.',

    /*
    |--------------------------------------------------------------------------
    | Custom Validation Language Lines
    |--------------------------------------------------------------------------
    |
    | Here you may specify custom validation messages for attributes using the
    | convention "attribute.rule" to name the lines. This makes it quick to
    | specify a specific custom language line for a given attribute rule.
    |
    */

    'custom' => [
        'attribute-name' => [
            'rule-name' => 'custom-message',
        ],
    ],

    /*
    |--------------------------------------------------------------------------
    | Custom Validation Attributes
    |--------------------------------------------------------------------------
    |
    | The following language lines are used to swap our attribute placeholder
    | with something more reader friendly such as "E-Mail Address" instead
    | of "email". This simply helps us make our message more expressive.
    |
    */

    'attributes' => [],

];
//-------------------------------------------------------------video 45------------------------------------------------------------


app/Http/Request/post/CreatePostRequest.php 

video 45

<?php

namespace App\Http\Requests\post;

use Illuminate\Foundation\Http\FormRequest;
use App\Rules\CauVanHoa;

class CreatePostRequest extends FormRequest
{
    /**
     * Determine if the user is authorized to make this request.
     *
     * @return bool
     */
    public function authorize()
    {
        return true;
    }

    /**
     * Get the validation rules that apply to the request.
     * /
     * @return array
     */
    public function rules()
    {
        return [
              // 'title' => [
              // 'required',
              // 'max:500',
              // 'in:dn,hn,hcm',
              // ],

              // 'title' => ['required|max:500|in:dn,hn,hcm|unique:posts,title',
              //     function($attribute,$value){
              //       echo $attribute.$value;
              //     }
              // ],

            'title' => [
                'required',
                'max:500',
                'unique:posts,title',
                'min:10',
                new CauVanHoa()

            ],
            'content' => 'required|min:5',
          ];
    }
    // public function messages(){
    //     return [
    //         'title.required' => 'Chỗ này bắt buộc nhập ! :attribute',
    //         'content.required' => 'Bạn xinh đẹp ơi bạn quên chưa nhập :attribute'
    //     ];
    // }
    public function attributes(){
        return [
            'title' => 'Tiêu đề',
            'content' => 'Nội dung'
        ];
    }
}
//-------------------------------------------------------------video 45------------------------------------------------------------


app/Rules/CauVanHoa.php

video 45 

<?php

namespace App\Rules;

use Illuminate\Contracts\Validation\Rule;

class CauVanHoa implements Rule
{
    /**
     * Create a new rule instance.
     *
     * @return void
     */
    public function __construct()
    {
        //
    }

    /**
     * Determine if the validation rule passes.
     *
     * @param  string  $attribute
     * @param  mixed  $value
     * @return bool
     */
    public function passes($attribute, $value)
    {
        //
        if(strpos($value, 'dit') !== false){
            return false;   // return true thì là pass 
        }
        return true;
    }

    /**
     * Get the validation error message.
     *
     * @return string
     */
    public function message()
    {
        // return 'The validation error message.';
        return 'Bạn phải viết một câu văn hóa !';
    }
}
//-------------------------------------------------------------video 45------------------------------------------------------------


resources/js/components/ExampleComponent.vue

video 45 

<template>
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header">Example Component</div>

                    <div class="card-body">
                        I'm an example component.
                    </div>
                </div>
            </div>
        </div>
    </div>
</template>

<script>
    export default {
        mounted() {
            console.log('Component mounted.')
        }
    }
</script>
//-------------------------------------------------------------video 45------------------------------------------------------------


resources/js/app.js 

video 45

/**
 * First we will load all of this project's JavaScript dependencies which
 * includes Vue and other libraries. It is a great starting point when
 * building robust, powerful web applications using Vue and Laravel.
 */

require('./bootstrap');

window.Vue = require('vue');

/**
 * The following block of code may be used to automatically register your
 * Vue components. It will recursively scan this directory for the Vue
 * components and automatically register them with their "basename".
 *
 * Eg. ./components/ExampleComponent.vue -> <example-component></example-component>
 */

// const files = require.context('./', true, /\.vue$/i)
// files.keys().map(key => Vue.component(key.split('/').pop().split('.')[0], files(key).default))

Vue.component('example-component', require('./components/ExampleComponent.vue').default);

/**
 * Next, we will create a fresh Vue application instance and attach it to
 * the page. Then, you may begin adding components to this application
 * or customize the JavaScript scaffolding to fit your unique needs.
 */

const app = new Vue({
    el: '#app',
});
//-------------------------------------------------------------video 45------------------------------------------------------------


resources/js/components/bootstrap.js 

video 45

window._ = require('lodash');

/**
 * We'll load jQuery and the Bootstrap jQuery plugin which provides support
 * for JavaScript based Bootstrap features such as modals and tabs. This
 * code may be modified to fit the specific needs of your application.
 */

try {
    window.Popper = require('popper.js').default;
    window.$ = window.jQuery = require('jquery');

    require('bootstrap');
} catch (e) {}

/**
 * We'll load the axios HTTP library which allows us to easily issue requests
 * to our Laravel back-end. This library automatically handles sending the
 * CSRF token as a header based on the value of the "XSRF" token cookie.
 */

window.axios = require('axios');

window.axios.defaults.headers.common['X-Requested-With'] = 'XMLHttpRequest';

/**
 * Echo exposes an expressive API for subscribing to channels and listening
 * for events that are broadcast by Laravel. Echo and event broadcasting
 * allows your team to easily build robust real-time web applications.
 */

// import Echo from 'laravel-echo';

// window.Pusher = require('pusher-js');

// window.Echo = new Echo({
//     broadcaster: 'pusher',
//     key: process.env.MIX_PUSHER_APP_KEY,
//     cluster: process.env.MIX_PUSHER_APP_CLUSTER,
//     forceTLS: true
// });
//-------------------------------------------------------------video 45------------------------------------------------------------


views/auth / nhiều file views (/blade.php)

video 45

//-------------------------------------------------------------video 45------------------------------------------------------------


views/auth/passwords / nhiều file views (.blade.php)

video 45

//-------------------------------------------------------------video 45------------------------------------------------------------


resources/views/layouts/app.blade.php

video 45

<!doctype html>
<html lang="{{ str_replace('_', '-', app()->getLocale()) }}">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- CSRF Token -->
    <meta name="csrf-token" content="{{ csrf_token() }}">

    <title>{{ config('app.name', 'Laravel') }}</title>

    <!-- Scripts -->
    <script src="{{ asset('js/app.js') }}" defer></script>

    <!-- Fonts -->
    <link rel="dns-prefetch" href="//fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css?family=Nunito" rel="stylesheet">

    <!-- Styles -->
    <link href="{{ asset('css/app.css') }}" rel="stylesheet">
</head>
<body>
    <div id="app">
        <nav class="navbar navbar-expand-md navbar-light bg-white shadow-sm">
            <div class="container">
                <a class="navbar-brand" href="{{ url('/') }}">
                    {{ config('app.name', 'Laravel') }}
                </a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="{{ __('Toggle navigation') }}">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <!-- Left Side Of Navbar -->
                    <ul class="navbar-nav mr-auto">

                    </ul>

                    <!-- Right Side Of Navbar -->
                    <ul class="navbar-nav ml-auto">
                        <!-- Authentication Links -->
                        @guest
                            <li class="nav-item">
                                <a class="nav-link" href="{{ route('login') }}">{{ __('Login') }}</a>
                            </li>
                            @if (Route::has('register'))
                                <li class="nav-item">
                                    <a class="nav-link" href="{{ route('register') }}">{{ __('Register') }}</a>
                                </li>
                            @endif
                        @else
                            <li class="nav-item dropdown">
                                <a id="navbarDropdown" class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" v-pre>
                                    {{ Auth::user()->name }}
                                </a>

                                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                                    <a class="dropdown-item" href="{{ route('logout') }}"
                                       onclick="event.preventDefault();
                                                     document.getElementById('logout-form').submit();">
                                        {{ __('Logout') }}
                                    </a>

                                    <form id="logout-form" action="{{ route('logout') }}" method="POST" class="d-none">
                                        @csrf
                                    </form>
                                </div>
                            </li>
                        @endguest
                    </ul>
                </div>
            </div>
        </nav>

        <main class="py-4">
            @yield('content')
        </main>
    </div>
</body>
</html>
//-------------------------------------------------------------video 45------------------------------------------------------------


resources/views/home.blade.php 

video 45

@extends('layouts.app')

@section('content')
<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card">
                <div class="card-header">{{ __('Dashboard') }}</div>

                <div class="card-body">
                    @if (session('status'))
                        <div class="alert alert-success" role="alert">
                            {{ session('status') }}
                        </div>
                    @endif

                    {{ __('You are logged in!') }}
                </div>
            </div>
        </div>
    </div>
</div>
@endsection
//-------------------------------------------------------------video 45------------------------------------------------------------


app/Http/Controllers/Auth/ nhiều file controller  

video 45

//-------------------------------------------------------------video 45------------------------------------------------------------


app/Http/Controllers/HomeController.php

video 45

<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;

class HomeController extends Controller
{
    /**
     * Create a new controller instance.
     *
     * @return void
     */
    public function __construct()
    {
        $this->middleware('auth');
    }

    /**
     * Show the application dashboard.
     *
     * @return \Illuminate\Contracts\Support\Renderable
     */
    public function index()
    {
        return view('home');
    }
}
//-------------------------------------------------------------video 45------------------------------------------------------------


app/Http/Middleware/BlockIpMiddleware.php

video 45

<?php

namespace App\Http\Middleware;

use Closure;

class BlockIpMiddleware
{
    /**
     * Handle an incoming request.
     *
     * @param  \Illuminate\Http\Request  $request
     * @param  \Closure  $next
     * @return mixed
     */
    public function handle($request, Closure $next,$name,$age)
    {
        echo $name.' '.$age;
        return $next($request);
        // if($_SERVER['REMOTE_ADDR'] == '127.0.0.1'){
        //     return $next($request);
        // }
        // abort(403,'Access denied');
    }
}
//-------------------------------------------------------------video 45------------------------------------------------------------


app\Http\Kernel.php 

video 45

<?php

namespace App\Http;

use Illuminate\Foundation\Http\Kernel as HttpKernel;

class Kernel extends HttpKernel
{
    /**
     * The application's global HTTP middleware stack.
     *
     * These middleware are run during every request to your application.
     *
     * @var array
     */
    protected $middleware = [
        \App\Http\Middleware\TrustProxies::class,
        \Fruitcake\Cors\HandleCors::class,
        \App\Http\Middleware\CheckForMaintenanceMode::class,
        \Illuminate\Foundation\Http\Middleware\ValidatePostSize::class,
        \App\Http\Middleware\TrimStrings::class,
        \Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull::class,
    ];

    /**
     * The application's route middleware groups.
     *
     * @var array
     */
    protected $middlewareGroups = [
        'web' => [
            \App\Http\Middleware\EncryptCookies::class,
            \Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse::class,
            \Illuminate\Session\Middleware\StartSession::class,
            // \Illuminate\Session\Middleware\AuthenticateSession::class,
            \Illuminate\View\Middleware\ShareErrorsFromSession::class,
            \App\Http\Middleware\VerifyCsrfToken::class,
            \Illuminate\Routing\Middleware\SubstituteBindings::class,
        ],

        'api' => [
            'throttle:60,1', // chỉ được request 60 lần trên 1 phút 
            \Illuminate\Routing\Middleware\SubstituteBindings::class,
        ],
    ];

    /**
     * The application's route middleware.
     *
     * These middleware may be assigned to groups or used individually.
     *
     * @var array
     */
    protected $routeMiddleware = [
        'auth' => \App\Http\Middleware\Authenticate::class,
        'auth.basic' => \Illuminate\Auth\Middleware\AuthenticateWithBasicAuth::class,
        'bindings' => \Illuminate\Routing\Middleware\SubstituteBindings::class,
        'cache.headers' => \Illuminate\Http\Middleware\SetCacheHeaders::class,
        'can' => \Illuminate\Auth\Middleware\Authorize::class,
        'guest' => \App\Http\Middleware\RedirectIfAuthenticated::class,
        'password.confirm' => \Illuminate\Auth\Middleware\RequirePassword::class,
        'signed' => \Illuminate\Routing\Middleware\ValidateSignature::class,
        'throttle' => \Illuminate\Routing\Middleware\ThrottleRequests::class,
        'verified' => \Illuminate\Auth\Middleware\EnsureEmailIsVerified::class,
        'blockIp' => \App\Http\Middleware\BlockIpMiddleware::class,
        // 'blockIp' => 'App\Http\Middleware\BlockIpMiddleware' như này cũng được 
        'role' => \App\Http\Middleware\RoleMiddleware::class,

    ];
}
//-------------------------------------------------------------video 45------------------------------------------------------------


database/migrations/2014_10_12_000000_create_users_table.php

video 45

<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

class CreateUsersTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::create('users', function (Blueprint $table) {
            $table->id();
            $table->string('name');
            $table->string('email')->unique();
            $table->timestamp('email_verified_at')->nullable();
            $table->string('password');
            $table->string('role')->default('user');
            $table->rememberToken();
            $table->timestamps();
        });
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::dropIfExists('users');
    }
}
//-------------------------------------------------------------video 45------------------------------------------------------------


app/Http/Middleware/RoleMiddleware.php

video 45

<?php

namespace App\Http\Middleware;

use Closure;

class RoleMiddleware
{
    /**
     * Handle an incoming request.
     *
     * @param  \Illuminate\Http\Request  $request
     * @param  \Closure  $next
     * @return mixed
     */
    public function handle($request, Closure $next, ...$roles)
    {
        dd($roles);
        foreach ($roles as $role){
            if(auth()->user()->role == $role){
                return $next($request);
            }
        }
        abort(403,'Bạn không có quyền truy cập ! ');


        // if(auth()->user()->role == $role){
        //     return $next($request);
        // }
        // // abort(403,'access denied');
        // abort(403,'Bạn không có quyền truy cập ! ');
    }
}


<-------------------------------------------------------------video 45------------------------------------------------------------->







Laravel 46 

// video 46

<?php
//-------------------------------------------------------------video 46------------------------------------------------------------
// Custom hệ thông đăng kí, đăng nhập 
// + Đăng kí bằng username (email), + Thêm field khác : số điện thoại, địa chỉ
// overide(ghi đè) một hàm 
// webpack.mix.js .version()
// Đăng kí/Đăng nhập : đăng kí/đăng nhập bằng mạng xã hội : Laravel Socialite : composer require laravel/socialite
// socialiteproviders (Trang hướng dẫn đăng nhập bằng mạng xã hội)(chứa rất nhiều mạng xã hội)
// Đăng nhập bằng google, composer require socialiteproviders/google
// Tạo GOOGLE_CLIENT_ID, GOOGLE_CLIENT_SECRET bằng Google Developer s
// Tạo FACEBOOK_CLIENT_ID, FACEBOOK_CLIENT_SECRET bằng Facebook Developer 
// Đăng nhập bằng cả google và facebook 
// Liên kết tài khoản với mạng xã hội 


use Illuminate\Support\Facades\Route;

/*
|--------------------------------------------------------------------------
| Web Routes
|--------------------------------------------------------------------------
|
| Here is where you can register web routes for your application. These
| routes are loaded by the RouteServiceProvider within a group which
| contains the "web" middleware group. Now create something great!
|
*/

Route::get('/', function () {
    return view('welcome');
});

Auth::routes();

Route::get('/home', 'HomeController@index')->name('home');

//-----------------------------------------------------------------------------------------
// Route::get('/login/google',function(){ // nếu viết function ở đây thì đỡ phải tạo hàm bên file app/Http/Controllers/Auth/SocialLoginController.php
// còn không thì ở đây chỉ cần tạo route rồi viết hàm bên file kia  
//  return Socialite::driver('google')->redirect();
// })
Route::get('/login/google','Auth\SocialLoginController@redirectToGoogle')->name('google.redirect');
Route::get('/social-login/google','Auth\SocialLoginController@processLoginGoogle');

Route::get('/login/facebook','Auth\SocialLoginController@redirectToFacebook')->name('facebook.redirect');
Route::get('/social-login/facebook','Auth\SocialLoginController@processLoginFacebook');


//-------------------------------------------------------------video 46------------------------------------------------------------


.env 

video 46

APP_NAME=Laravel
APP_ENV=local
APP_KEY=base64:+OCNUfPCEC0pXu4bIrGSgKS1Vn4Vo7JbebMeVKdijZ8=
APP_DEBUG=true
APP_URL=http://localhost

LOG_CHANNEL=stack

DB_CONNECTION=mysql
DB_HOST=localhost
DB_PORT=3306
DB_DATABASE=auth
DB_USERNAME=root
DB_PASSWORD=

BROADCAST_DRIVER=log
CACHE_DRIVER=file
QUEUE_CONNECTION=sync
SESSION_DRIVER=file
SESSION_LIFETIME=120

REDIS_HOST=127.0.0.1
REDIS_PASSWORD=null
REDIS_PORT=6379

MAIL_MAILER=smtp
MAIL_HOST=smtp.mailtrap.io
MAIL_PORT=2525
MAIL_USERNAME=null
MAIL_PASSWORD=null
MAIL_ENCRYPTION=null
MAIL_FROM_ADDRESS=null
MAIL_FROM_NAME="${APP_NAME}"

AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_DEFAULT_REGION=us-east-1
AWS_BUCKET=

PUSHER_APP_ID=
PUSHER_APP_KEY=
PUSHER_APP_SECRET=
PUSHER_APP_CLUSTER=mt1

MIX_PUSHER_APP_KEY="${PUSHER_APP_KEY}"
MIX_PUSHER_APP_CLUSTER="${PUSHER_APP_CLUSTER}"

GOOGLE_CLIENT_ID=779842371071-gn56d5d8o7l8blerqn3nb75v3vnhsbqf.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=YSVd1Sm_tIFsmsf5lp1YISs_
GOOGLE_REDIRECT_URI=http://localhost:8000/social-login/google

FACEBOOK_CLIENT_ID=238901438243111  
FACEBOOK_CLIENT_SECRET=65b85bdb2937ec8b142970630b689dab 
FACEBOOK_REDIRECT_URI=http://localhost:8000/social-login/facebook 
//-------------------------------------------------------------video 46------------------------------------------------------------


database/migrations/2014_10_12_000000_create_users_table.php   

video 46

<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

class CreateUsersTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::create('users', function (Blueprint $table) {
            $table->id();
            $table->string('name');
            $table->string('username')->unique();
            $table->string('phone')->nullable();
            $table->string('address')->nullable();
            $table->string('password')->nullable();
            $table->string('google_id')->nullable();
            $table->string('facebook_id')->nullable();
            $table->rememberToken();
            $table->timestamps();
        });
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::dropIfExists('users');
    }
}
//-------------------------------------------------------------video 46------------------------------------------------------------


app/Http/Controllers/Auth/RegisterController.php  

video 46

<?php

namespace App\Http\Controllers\Auth;

use App\Http\Controllers\Controller;
use App\Providers\RouteServiceProvider;
use App\User;
use Illuminate\Foundation\Auth\RegistersUsers;
use Illuminate\Support\Facades\Hash;
use Illuminate\Support\Facades\Validator;

class RegisterController extends Controller
{
    /*
    |--------------------------------------------------------------------------
    | Register Controller
    |--------------------------------------------------------------------------
    |
    | This controller handles the registration of new users as well as their
    | validation and creation. By default this controller uses a trait to
    | provide this functionality without requiring any additional code.
    |
    */

    use RegistersUsers;

    /**
     * Where to redirect users after registration.
     *
     * @var string
     */
    protected $redirectTo = RouteServiceProvider::HOME; // có thể chuyển đến bất cứ thứ gì sau khi đăng kí xong, sửa lại thành route nào đó 

    /**
     * Create a new controller instance.
     *
     * @return void
     */
    public function __construct()
    {
        $this->middleware('guest');
    }

    /**
     * Get a validator for an incoming registration request.
     *
     * @param  array  $data
     * @return \Illuminate\Contracts\Validation\Validator
     */
    protected function validator(array $data)
    {
        return Validator::make($data, [
            'name' => ['required', 'string', 'max:255'],
            'username' => ['required', 'alpha', 'string', 'max:30', 'unique:users'],
            'phone' => ['required', 'max:15'],
            'address' => ['required'],
            'password' => ['required', 'string', 'min:8', 'confirmed'],
        ]);
    }

    /**
     * Create a new user instance after a valid registration.
     *
     * @param  array  $data
     * @return \App\User
     */
    protected function create(array $data)
    {
        return User::create([
            'name' => $data['name'],
            'username' => $data['username'],
            'phone' => $data['phone'],
            'address' => $data['address'],
            'password' => Hash::make($data['password']),
        ]);
    }
}
//-------------------------------------------------------------video 46------------------------------------------------------------


resources/views/auth/register.blade.php

video 46 

@extends('layouts.app')

@section('content')
<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card">
                <div class="card-header">{{ __('Register') }}</div>

                <div class="card-body">
                    <form method="POST" action="{{ route('register') }}">
                        @csrf

                        <div class="form-group row">
                            <label for="name" class="col-md-4 col-form-label text-md-right">{{ __('Name') }}</label>

                            <div class="col-md-6">
                                <input id="name" type="text" class="form-control @error('name') is-invalid @enderror" name="name" value="{{ old('name') }}" required autocomplete="name" autofocus>

                                @error('name')
                                    <span class="invalid-feedback" role="alert">
                                        <strong>{{ $message }}</strong>
                                    </span>
                                @enderror
                            </div>
                        </div>
<!-- ///////////////////////////////// /////////////////-->
                        <div class="form-group row">
                            <label for="username" class="col-md-4 col-form-label text-md-right">{{ __('Username') }}</label>

                            <div class="col-md-6">
                                <input id="username" type="text" class="form-control @error('username') is-invalid @enderror" name="username" value="{{ old('username') }}" required autocomplete="username">

                                @error('username')
                                    <span class="invalid-feedback" role="alert">
                                        <strong>{{ $message }}</strong>
                                    </span>
                                @enderror
                            </div>
                        </div>
                        
                        <div class="form-group row">
                            <label for="phone" class="col-md-4 col-form-label text-md-right">{{ __('Phone') }}</label>

                            <div class="col-md-6">
                                <input id="phone" type="text" class="form-control @error('phone') is-invalid @enderror" name="phone" value="{{ old('phone') }}" required autocomplete="phone">

                                @error('phone')
                                    <span class="invalid-feedback" role="alert">
                                        <strong>{{ $message }}</strong>
                                    </span>
                                @enderror
                            </div>
                        </div>

                        <div class="form-group row">
                            <label for="address" class="col-md-4 col-form-label text-md-right">{{ __('Address') }}</label>

                            <div class="col-md-6">
                                <input id="address" type="text" class="form-control @error('address') is-invalid @enderror" name="address" value="{{ old('address') }}" required autocomplete="address">

                                @error('address')
                                    <span class="invalid-feedback" role="alert">
                                        <strong>{{ $message }}</strong>
                                    </span>
                                @enderror
                            </div>
                        </div>


<!-- ///////////////////////////////// /////////////////-->
                        <div class="form-group row">
                            <label for="password" class="col-md-4 col-form-label text-md-right">{{ __('Password') }}</label>

                            <div class="col-md-6">
                                <input id="password" type="password" class="form-control @error('password') is-invalid @enderror" name="password" required autocomplete="new-password">

                                @error('password')
                                    <span class="invalid-feedback" role="alert">
                                        <strong>{{ $message }}</strong>
                                    </span>
                                @enderror
                            </div>
                        </div>

                        <div class="form-group row">
                            <label for="password-confirm" class="col-md-4 col-form-label text-md-right">{{ __('Confirm Password') }}</label>

                            <div class="col-md-6">
                                <input id="password-confirm" type="password" class="form-control" name="password_confirmation" required autocomplete="new-password">
                            </div>
                        </div>

                        <div class="form-group row mb-0">
                            <div class="col-md-6 offset-md-4">
                                <button type="submit" class="btn btn-primary">
                                    {{ __('Register') }}
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
@endsection
//-------------------------------------------------------------video 46------------------------------------------------------------


app/User.php

video 46

<?php

namespace App;

use Illuminate\Contracts\Auth\MustVerifyEmail;
use Illuminate\Foundation\Auth\User as Authenticatable;
use Illuminate\Notifications\Notifiable;

class User extends Authenticatable
{
    use Notifiable;

    /**
     * The attributes that are mass assignable.
     *
     * @var array
     */
    protected $fillable = [
        'name', 'username','phone','address','password','google_id',
        'facebook_id',
    ];

    /**
     * The attributes that should be hidden for arrays.
     *
     * @var array
     */
    protected $hidden = [
        'password', 'remember_token',
    ];

    /**
     * The attributes that should be cast to native types.
     *
     * @var array
     */
    protected $casts = [
        'email_verified_at' => 'datetime',
    ];
}
//-------------------------------------------------------------video 46------------------------------------------------------------


resources/views/auth/login.blade.php

video 46

@extends('layouts.app')

@section('content')
<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card">
                <div class="card-header">{{ __('Login') }}</div>

                <div class="card-body">
                    <form method="POST" action="{{ route('login') }}">
                        @csrf

                        <div class="form-group row">
                            <label for="username" class="col-md-4 col-form-label text-md-right">{{ __('Username') }}</label>

                            <div class="col-md-6">
                                <input id="username" type="text" class="form-control @error('username') is-invalid @enderror" name="username" value="{{ old('username') }}" required autocomplete="username" autofocus>

                                @error('username')
                                    <span class="invalid-feedback" role="alert">
                                        <strong>{{ $message }}</strong>
                                    </span>
                                @enderror
                            </div>
                        </div>

                        <div class="form-group row">
                            <label for="password" class="col-md-4 col-form-label text-md-right">{{ __('Password') }}</label>

                            <div class="col-md-6">
                                <input id="password" type="password" class="form-control @error('password') is-invalid @enderror" name="password" required autocomplete="current-password">

                                @error('password')
                                    <span class="invalid-feedback" role="alert">
                                        <strong>{{ $message }}</strong>
                                    </span>
                                @enderror
                            </div>
                        </div>

                        <div class="form-group row">
                            <div class="col-md-6 offset-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="remember" id="remember" {{ old('remember') ? 'checked' : '' }}>

                                    <label class="form-check-label" for="remember">
                                        {{ __('Remember Me') }}
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div class="form-group row mb-0">
                            <div class="col-md-8 offset-md-4">
                                <button type="submit" class="btn btn-primary">
                                    {{ __('Login') }}
                                </button>

                                @if (Route::has('password.request'))
                                    <a class="btn btn-link" href="{{ route('password.request') }}">
                                        {{ __('Forgot Your Password?') }}
                                    </a>
                                @endif
                            </div>
                        </div>
<!-- ------------------------------------------------------------------------------------- -->
                        <div>
                            <a href="{{route('google.redirect')}}">Đăng nhập bằng Google</a>
                            <a href="{{route('facebook.redirect')}}">Đăng nhập bằng Facebook</a>
                        </div>





                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
@endsection
//-------------------------------------------------------------video 46------------------------------------------------------------


app/Http/Controllers/Auth/LoginController.php  

video 46

<?php

namespace App\Http\Controllers\Auth;

use App\Http\Controllers\Controller;
use App\Providers\RouteServiceProvider;
use Illuminate\Foundation\Auth\AuthenticatesUsers;

class LoginController extends Controller
{
    /*
    |--------------------------------------------------------------------------
    | Login Controller
    |--------------------------------------------------------------------------
    |
    | This controller handles authenticating users for the application and
    | redirecting them to your home screen. The controller uses a trait
    | to conveniently provide its functionality to your applications.
    |
    */

    use AuthenticatesUsers;

    /**
     * Where to redirect users after login.
     *
     * @var string
     */
    protected $redirectTo = RouteServiceProvider::HOME;

    /**
     * Create a new controller instance.
     *
     * @return void
     */
    public function __construct()
    {
        $this->middleware('guest')->except('logout');
    }

    /**
     * Get the login username to be used by the controller.
     *
     * @return string
     */
    public function username()
    {
        return 'username';
    }
}
//-------------------------------------------------------------video 46------------------------------------------------------------


laravel/laravelAuth/vendor/laravel/ui/auth-backend/AuthenticatesUsers.php/{}AuthenticatesUsers (chỉ đọc and copy)

video 46

//-------------------------------------------------------------video 46------------------------------------------------------------


package.json 

video 46

{
    "private": true,
    "scripts": {
        "dev": "npm run development",
        "development": "cross-env NODE_ENV=development node_modules/webpack/bin/webpack.js --progress --hide-modules --config=node_modules/laravel-mix/setup/webpack.config.js",
        "watch": "npm run development -- --watch",
        "watch-poll": "npm run watch -- --watch-poll",
        "hot": "cross-env NODE_ENV=development node_modules/webpack-dev-server/bin/webpack-dev-server.js --inline --hot --config=node_modules/laravel-mix/setup/webpack.config.js",
        "prod": "npm run production",
        "production": "cross-env NODE_ENV=production node_modules/webpack/bin/webpack.js --no-progress --hide-modules --config=node_modules/laravel-mix/setup/webpack.config.js"
    },
    "devDependencies": {
        "axios": "^0.19",
        "bootstrap": "^4.0.0",
        "cross-env": "^7.0",
        "jquery": "^3.2",
        "laravel-mix": "^5.0.1",
        "lodash": "^4.17.13",
        "popper.js": "^1.12",
        "resolve-url-loader": "^2.3.1",
        "sass": "^1.20.1",
        "sass-loader": "^8.0.0",
        "vue": "^2.5.17",
        "vue-template-compiler": "^2.6.10"
    }
}
//-------------------------------------------------------------video 46------------------------------------------------------------


webpack.mix.js 

video 46

const mix = require('laravel-mix');

/*
 |--------------------------------------------------------------------------
 | Mix Asset Management
 |--------------------------------------------------------------------------
 |
 | Mix provides a clean, fluent API for defining some Webpack build steps
 | for your Laravel application. By default, we are compiling the Sass
 | file for the application as well as bundling up all the JS files.
 |
 */

mix.js('resources/js/app.js', 'public/js').version();
mix.sass('resources/sass/app.scss', 'public/css').version();
//-------------------------------------------------------------video 46------------------------------------------------------------


resources/views/layouts/app.blade.php

video 46

<!doctype html>
<html lang="{{ str_replace('_', '-', app()->getLocale()) }}">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- CSRF Token -->
    <meta name="csrf-token" content="{{ csrf_token() }}">

    <title>{{ config('app.name', 'Laravel') }}</title>

    <!-- Scripts -->
    <script src="{{ mix('js/app.js') }}" defer></script>

    <!-- Fonts -->
    <link rel="dns-prefetch" href="//fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css?family=Nunito" rel="stylesheet">

    <!-- Styles -->
    <link href="{{ mix('css/app.css') }}" rel="stylesheet">
</head>
<body>
    <div id="app">
        <nav class="navbar navbar-expand-md navbar-light bg-white shadow-sm">
            <div class="container">
                <a class="navbar-brand" href="{{ url('/') }}">
                    {{ config('app.name', 'Laravel') }}
                </a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="{{ __('Toggle navigation') }}">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <!-- Left Side Of Navbar -->
                    <ul class="navbar-nav mr-auto">

                    </ul>

                    <!-- Right Side Of Navbar -->
                    <ul class="navbar-nav ml-auto">
                        <!-- Authentication Links -->
                        @guest
                            <li class="nav-item">
                                <a class="nav-link" href="{{ route('login') }}">{{ __('Login') }}</a>
                            </li>
                            @if (Route::has('register'))
                                <li class="nav-item">
                                    <a class="nav-link" href="{{ route('register') }}">{{ __('Register') }}</a>
                                </li>
                            @endif
                        @else
                            <li class="nav-item dropdown">
                                <a id="navbarDropdown" class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" v-pre>
                                    {{ Auth::user()->name }}
                                </a>

                                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                                    <a class="dropdown-item" href="{{ route('logout') }}"
                                       onclick="event.preventDefault();
                                                     document.getElementById('logout-form').submit();">
                                        {{ __('Logout') }}
                                    </a>

                                    <form id="logout-form" action="{{ route('logout') }}" method="POST" class="d-none">
                                        @csrf
                                    </form>
                                </div>
                            </li>
                        @endguest
                    </ul>
                </div>
            </div>
        </nav>

        <main class="py-4">
            @yield('content')
        </main>
    </div>
</body>
</html>
//-------------------------------------------------------------video 46------------------------------------------------------------


config/services.php

video 46 

<?php

return [

    /*
    |--------------------------------------------------------------------------
    | Third Party Services
    |--------------------------------------------------------------------------
    |
    | This file is for storing the credentials for third party services such
    | as Mailgun, Postmark, AWS and more. This file provides the de facto
    | location for this type of information, allowing packages to have
    | a conventional file to locate the various service credentials.
    |
    */

    'mailgun' => [
        'domain' => env('MAILGUN_DOMAIN'),
        'secret' => env('MAILGUN_SECRET'),
        'endpoint' => env('MAILGUN_ENDPOINT', 'api.mailgun.net'),
    ],

    'postmark' => [
        'token' => env('POSTMARK_TOKEN'),
    ],

    'ses' => [
        'key' => env('AWS_ACCESS_KEY_ID'),
        'secret' => env('AWS_SECRET_ACCESS_KEY'),
        'region' => env('AWS_DEFAULT_REGION', 'us-east-1'),
    ],

    'google' => [    
        'client_id' => env('GOOGLE_CLIENT_ID'),  
        'client_secret' => env('GOOGLE_CLIENT_SECRET'),  
        'redirect' => env('GOOGLE_REDIRECT_URI') 
    ],
    'facebook' => [    
        'client_id' => env('FACEBOOK_CLIENT_ID'),  
        'client_secret' => env('FACEBOOK_CLIENT_SECRET'),  
        'redirect' => env('FACEBOOK_REDIRECT_URI') 
    ],


];
//-------------------------------------------------------------video 46------------------------------------------------------------


app/Providers/EventServiceProvider.php 

video 46

<?php

namespace App\Providers;

use Illuminate\Auth\Events\Registered;
use Illuminate\Auth\Listeners\SendEmailVerificationNotification;
use Illuminate\Foundation\Support\Providers\EventServiceProvider as ServiceProvider;
use Illuminate\Support\Facades\Event;

class EventServiceProvider extends ServiceProvider
{
    /**
     * The event listener mappings for the application.
     *
     * @var array
     */
    protected $listen = [
        Registered::class => [
            SendEmailVerificationNotification::class,
        ],
        \SocialiteProviders\Manager\SocialiteWasCalled::class => [
        // ... other providers
            'SocialiteProviders\\Google\\GoogleExtendSocialite@handle',
            'SocialiteProviders\\Facebook\\FacebookExtendSocialite@handle',
        ],
    ];

    /**
     * Register any events for your application.
     *
     * @return void
     */
    public function boot()
    {
        parent::boot();

        //
    }
}
//-------------------------------------------------------------video 46------------------------------------------------------------


app/Http/Controllers/Auth/SocialLoginController.php 

video 46

<?php

namespace App\Http\Controllers\Auth;

use App\Http\Controllers\Controller;
use Illuminate\Http\Request;
use Laravel\Socialite\Facades\Socialite;
use App\User;
use Auth;

class SocialLoginController extends Controller
{
    //
    //--------------------------------------------------------------------
    function redirectToGoogle(){
        return Socialite::driver('google')->redirect();
    }

    public function processLoginGoogle(){
        $googleUser = Socialite::driver('google')->user();
        // dd($googleUser);  // in ra thông tin biến $googleUser
        
        /*
        if($googleUser){
            // cho phép 
            // Đăng nhập trên hệ thống của mình 
            // chưa có tài khoản trên hệ thống => đăng ký 

            // đã có tài khoản trên hệ thống => đăng nhập 

        }
        */

        if(!$googleUser){
            return ;

        }
        // dd($googleUser);
        $systemUser = User::where('google_id',$googleUser->id)->first();// gọi xuống bảng users sau đó lấy ra giá trị của trường google_id
                           
                           

        if(!$systemUser){
            $systemUser = User::create([
                'name' => $googleUser->name,
                'username' => 'gg_'.$googleUser->id,
                'email' => $googleUser->email,
                'google_id' => $googleUser->id
            ]);
        }


        // $systemUser->Auth::loginUsingId($systemUser->id);
        Auth::login($systemUser);

        return redirect('/home');


    }

    function redirectToFacebook(){
        return Socialite::driver('facebook')->redirect();
    }
  
    public function processLoginFacebook(){
        $facebookUser = Socialite::driver('facebook')->user();
        dd($facebookUser);
        
        if(!$facebookUser){
            return ;
        }

        $systemUser = User::where('facebook_id',$facebookUser->id)->first(); 

        if(!$systemUser){
            $systemUser = User::create([
                'name' => $facebookUser->name,
                'username' => 'gg_'.$facebookUser->id,
                'email' => $facebookUser->email ?? null,
                'facebook_id' => $facebookUser->id
            ]);
        }

        Auth::login($systemUser);

        return redirect('/home');
    }
    // ex : kết nối facebook 
/*
    function connectFacebook(){
        $facebookUser = Socialite::driver('facebook')->user();
        // dd($facebookUser); // biến nào cũng nên thử xuất ra thế này để xem thông tin của nó gồm những gì để thao tác với nó 
        if(!$facebookUser){
            return ;
        }

        $systemUser = auth()->user(); 
        $systemUser->facebookUser_id = $facebookUser->id; // tương tự , biến của hệ thống trỏ đến facebook_id trong database là lưu giá trị của biến facebook trỏ đến cái id của nó 
        $systemUser->save(); 
    }
    */

}
<-------------------------------------------------------------video 46------------------------------------------------------------->







Laravel 47 

// video 47

<?php
//-------------------------------------------------------------video 47------------------------------------------------------------
// Nói qua về Sử dụng Authentication trong vuejs
// Laravel => route => truy cập => refresh
// Vue => route => single page
// Queue: hàng đợi 
// php artisan make:job [tên_job] ex : php artisan make:job SendWelcomeMail (tạo file Jobs), file Jobs,sleep(),dispatch()
// config/queue.php
// php artisan queue:table (tạo bảng jobs)
// thông tin về bảng database : jobs 
// php artisan queue:work (thực hiện các công việc trong jobs)
// Delay, Sau bao nhiêu phút thì mới xử lí : delay() ex : ->delay(now()->addMinutes(5)); // sau 5 phút thì mới xử lí 
// onQueue() : đặt tên queue ex : SendWelcomeMail::dispatch($user)->onQueue('SendWelcomeMail'); // queue tên là SendWelcomeMail
// Chạy riêng một job theo tên queue php artisan queue:work --queue=[tên_queue] ex : php artisan queue:work --queue=SendWelcomeMail
// Bảng failed_jobs (chứa các queue bị lỗi)
// Chạy lại queue bị lỗi trong bảng failed_jobs
// php artisan queue:work --queue=[tên_queue] --tries=[số_lần_thử_lại]
// Chỉ định nơi lưu vào queue ...->onConnection('redis'); Drivers: "sync", "database", "beanstalkd", "sqs", "redis", "null" 
// Xem tất cả các queue bị lỗi bằng CMD (vào database xem cũng được) php artisan queue:failed 
// Chuyển queue từ bảng failed_jobs (bị lỗi) quay trở lại bảng jobs 
// php artisan queue:retry [id] : chuyển một queue có id đó từ bảng failed_jobs về bảng jobs (id của queue đó) 
// php artisan queue:retry all  : chuyển hết tất cả từ bảng failed_jobs về bảng jobs
// Xóa queue trong bảng failed_jobs
// php artisan queue:forget [id] : xóa một queue có id đó 
// php artisan queue:flush       : xóa hết tất cả queue trong bảng failed_jobs
// php artisan queue:work --once : mỗi lần chỉ xử lí một queue rồi thôi (ít dùng)
// dispatchSync() tự tạo ra một project riêng để xử lí 
// Schedule và command 
// Command, tạo một file command : php artisan make:command [tên command] ex : php artisan make:command ClearCacheCommand
// Schedule app/Console/Kernel.php
// Schedule Frequency Options : hourly(), hourlyAt(17), everyTwoHours(, daily(), dailyAt('13:00'), weekly(), weeklyOn(1, '8:00'), quarterly() , cron('* * * * *'),...
// Schedule kết hợp với Command 
// * * * * * cd /path-to-your-project && php artisan schedule:run >> /dev/null 2>&1 
// php artisan schedule:run
// Kết hợp cả queue, command và schedule



use Illuminate\Support\Facades\Route;

/*
|--------------------------------------------------------------------------
| Web Routes
|--------------------------------------------------------------------------
|
| Here is where you can register web routes for your application. These
| routes are loaded by the RouteServiceProvider within a group which
| contains the "web" middleware group. Now create something great!
|
*/

Route::get('/', function () {
    return view('welcome');
});

Auth::routes();

Route::get('/home', 'HomeController@index')->name('home');

//-----------------------------------------------------------------------------------------
// Route::get('/login/google',function(){ // nếu viết function ở đây thì đỡ phải tạo hàm bên file app/Http/Controllers/Auth/SocialLoginController.php
// còn không thì ở đây chỉ cần tạo route rồi viết hàm bên file kia  
//  return Socialite::driver('google')->redirect();
// })
Route::get('/login/google','Auth\SocialLoginController@redirectToGoogle')->name('google.redirect');
Route::get('/social-login/google','Auth\SocialLoginController@processLoginGoogle');

Route::get('/login/facebook','Auth\SocialLoginController@redirectToFacebook')->name('facebook.redirect');
Route::get('/social-login/facebook','Auth\SocialLoginController@processLoginFacebook');


//-------------------------------------------------------------video 47------------------------------------------------------------


app/Jobs/SendWelcomeMail.php

video 47 

<?php

namespace App\Jobs;

use Illuminate\Bus\Queueable;
use Illuminate\Contracts\Queue\ShouldQueue;
use Illuminate\Foundation\Bus\Dispatchable;
use Illuminate\Queue\InteractsWithQueue;
use Illuminate\Queue\SerializesModels;

class SendWelcomeMail implements ShouldQueue
{
    use Dispatchable, InteractsWithQueue, Queueable, SerializesModels;

    // protected $tries = 5;
    protected $name = '';
    /**
     * Create a new job instance.
     *
     * @return void
     */
    public function __construct($name)
    {
        //
        $this->name = $name;
    }

    /**
     * Execute the job.
     *
     * @return void
     */
    public function handle()
    {
        // Viết code xử lí tác vụ nặng 
        // Viết code gửi mail 
        // $this->user->books->delete();
        echo 'Đang gửi mail cho'.$this->name;
        // sleep(20); // xử lí 10 giây 
    }
}
//-------------------------------------------------------------video 47------------------------------------------------------------


app/Http/Controllers/Auth/RegisterController.php  

video 47

<?php

namespace App\Http\Controllers\Auth;

use App\Http\Controllers\Controller;
use App\Providers\RouteServiceProvider;
use App\User;
use Illuminate\Foundation\Auth\RegistersUsers;
use Illuminate\Support\Facades\Hash;
use Illuminate\Support\Facades\Validator;
use App\Jobs\SendWelcomeMail;

class RegisterController extends Controller
{
    /*
    |--------------------------------------------------------------------------
    | Register Controller
    |--------------------------------------------------------------------------
    |
    | This controller handles the registration of new users as well as their
    | validation and creation. By default this controller uses a trait to
    | provide this functionality without requiring any additional code.
    |
    */

    use RegistersUsers;

    /**
     * Where to redirect users after registration.
     *
     * @var string
     */
    protected $redirectTo = RouteServiceProvider::HOME; // có thể chuyển đến bất cứ thứ gì sau khi đăng kí xong, sửa lại thành route nào đó 

    /**
     * Create a new controller instance.
     *
     * @return void
     */
    public function __construct()
    {
        $this->middleware('guest');
    }

    /**
     * Get a validator for an incoming registration request.
     *
     * @param  array  $data
     * @return \Illuminate\Contracts\Validation\Validator
     */
    protected function validator(array $data)
    {
        return Validator::make($data, [
            'name' => ['required', 'string', 'max:255'],
            'username' => ['required', 'alpha', 'string', 'max:30', 'unique:users'],
            'phone' => ['required', 'max:15'],
            'address' => ['required'],
            'password' => ['required', 'string', 'min:8', 'confirmed'],
        ]);
    }

    /**
     * Create a new user instance after a valid registration.
     *
     * @param  array  $data
     * @return \App\User
     */
    protected function create(array $data)
    {
        // viết code gửi mail ở đây 
        // sleep(10);
        // SendWelcomeMail::dispatch($data['name']);
        // return User::create([
        //     'name' => $data['name'],
        //     'username' => $data['username'],
        //     'phone' => $data['phone'],
        //     'address' => $data['address'],
        //     'password' => Hash::make($data['password']),
        // ]);

        $user = User::create([
            'name' => $data['name'],
            'username' => $data['username'],
            'phone' => $data['phone'],
            'address' => $data['address'],
            'password' => Hash::make($data['password']),
        ]);
        // SendWelcomeMail::dispatch($user)->delay(now()->addMinutes(5)); // sau 5 phút thì thực hiện 
        // SendWelcomeMail::dispatch($user)->onQueue('SendWelcomeMail'); // đặt tên cho Queue đó 
        // SendWelcomeMail::dispatch($user)->onQueue('SendWelcomeMail')->onConnection('redis'); // lưu Queue này lên redis
        SendWelcomeMail::dispatchSync($user)->onQueue('SendWelcomeMail')->onConnection('redis'); // lưu Queue này lên redis


        return $user;
    }
}
//-------------------------------------------------------------video 47------------------------------------------------------------


.env

video 47 

APP_NAME=Laravel
APP_ENV=local
APP_KEY=base64:+OCNUfPCEC0pXu4bIrGSgKS1Vn4Vo7JbebMeVKdijZ8=
APP_DEBUG=true
APP_URL=http://localhost

LOG_CHANNEL=stack

DB_CONNECTION=mysql
DB_HOST=localhost
DB_PORT=3306
DB_DATABASE=auth
DB_USERNAME=root
DB_PASSWORD=

BROADCAST_DRIVER=log
CACHE_DRIVER=file
QUEUE_CONNECTION=database
SESSION_DRIVER=file
SESSION_LIFETIME=120

REDIS_HOST=127.0.0.1
REDIS_PASSWORD=null
REDIS_PORT=6379

MAIL_MAILER=smtp
MAIL_HOST=smtp.mailtrap.io
MAIL_PORT=2525
MAIL_USERNAME=null
MAIL_PASSWORD=null
MAIL_ENCRYPTION=null
MAIL_FROM_ADDRESS=null
MAIL_FROM_NAME="${APP_NAME}"

AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_DEFAULT_REGION=us-east-1
AWS_BUCKET=

PUSHER_APP_ID=
PUSHER_APP_KEY=
PUSHER_APP_SECRET=
PUSHER_APP_CLUSTER=mt1

MIX_PUSHER_APP_KEY="${PUSHER_APP_KEY}"
MIX_PUSHER_APP_CLUSTER="${PUSHER_APP_CLUSTER}"

GOOGLE_CLIENT_ID=779842371071-gn56d5d8o7l8blerqn3nb75v3vnhsbqf.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=YSVd1Sm_tIFsmsf5lp1YISs_
GOOGLE_REDIRECT_URI=http://localhost:8000/social-login/google

FACEBOOK_CLIENT_ID=238901438243111  
FACEBOOK_CLIENT_SECRET=65b85bdb2937ec8b142970630b689dab 
FACEBOOK_REDIRECT_URI=http://localhost:8000/social-login/facebook 
//-------------------------------------------------------------video 47------------------------------------------------------------


config/queue.php 

video 47 

<?php

return [

    /*
    |--------------------------------------------------------------------------
    | Default Queue Connection Name
    |--------------------------------------------------------------------------
    |
    | Laravel's queue API supports an assortment of back-ends via a single
    | API, giving you convenient access to each back-end using the same
    | syntax for every one. Here you may define a default connection.
    |
    */

    'default' => env('QUEUE_CONNECTION', 'sync'),

    /*
    |--------------------------------------------------------------------------
    | Queue Connections
    |--------------------------------------------------------------------------
    |
    | Here you may configure the connection information for each server that
    | is used by your application. A default configuration has been added
    | for each back-end shipped with Laravel. You are free to add more.
    |
    | Drivers: "sync", "database", "beanstalkd", "sqs", "redis", "null"
    |
    */

    'connections' => [

        'sync' => [
            'driver' => 'sync',
        ],

        'database' => [
            'driver' => 'database',
            'table' => 'jobs',
            'queue' => 'default',
            'retry_after' => 90,
        ],

        'beanstalkd' => [
            'driver' => 'beanstalkd',
            'host' => 'localhost',
            'queue' => 'default',
            'retry_after' => 90,
            'block_for' => 0,
        ],

        'sqs' => [
            'driver' => 'sqs',
            'key' => env('AWS_ACCESS_KEY_ID'),
            'secret' => env('AWS_SECRET_ACCESS_KEY'),
            'prefix' => env('SQS_PREFIX', 'https://sqs.us-east-1.amazonaws.com/your-account-id'),
            'queue' => env('SQS_QUEUE', 'your-queue-name'),
            'region' => env('AWS_DEFAULT_REGION', 'us-east-1'),
        ],

        'redis' => [
            'driver' => 'redis',
            'connection' => 'default',
            'queue' => env('REDIS_QUEUE', 'default'),
            'retry_after' => 90,
            'block_for' => null,
        ],

    ],

    /*
    |--------------------------------------------------------------------------
    | Failed Queue Jobs
    |--------------------------------------------------------------------------
    |
    | These options configure the behavior of failed queue job logging so you
    | can control which database and table are used to store the jobs that
    | have failed. You may change them to any database / table you wish.
    |
    */

    'failed' => [
        'driver' => env('QUEUE_FAILED_DRIVER', 'database'),
        'database' => env('DB_CONNECTION', 'mysql'),
        'table' => 'failed_jobs',
    ],

];
//-------------------------------------------------------------video 47------------------------------------------------------------


database/2021_09_17_103236_create_jobs_table.php

video 47

<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

class CreateJobsTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::create('jobs', function (Blueprint $table) {
            $table->bigIncrements('id');
            $table->string('queue')->index();
            $table->longText('payload');
            $table->unsignedTinyInteger('attempts');
            $table->unsignedInteger('reserved_at')->nullable();
            $table->unsignedInteger('available_at');
            $table->unsignedInteger('created_at');
        });
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::dropIfExists('jobs');
    }
}
//-------------------------------------------------------------video 47------------------------------------------------------------


database/2019_08_19_000000_create_failed_jobs_table.php

video 47 

<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

class CreateFailedJobsTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::create('failed_jobs', function (Blueprint $table) {
            $table->id();
            $table->text('connection');
            $table->text('queue');
            $table->longText('payload');
            $table->longText('exception');
            $table->timestamp('failed_at')->useCurrent();
        });
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::dropIfExists('failed_jobs');
    }
}
//-------------------------------------------------------------video 47------------------------------------------------------------


app/Console/Commands/ClearCacheCommand.php 

video 47

<?php

namespace App\Console\Commands;

use Illuminate\Console\Command;
// use Illuminate\Support\Facades\Artisan;

class ClearCacheCommand extends Command
{
    /**
     * The name and signature of the console command.
     *
     * @var string
     */
    // protected $signature = 'command:name'; 
    protected $signature = 'system:clear-cache'; 

    /**
     * The console command description.
     *
     * @var string
     */
    // protected $description = 'Command description';
    protected $description = 'Clear all cache of system'; // description là mô tả 

    /**
     * Create a new command instance.
     *
     * @return void
     */
    public function __construct()
    {
        parent::__construct();
    }

    /**
     * Execute the console command.
     *
     * @return int
     */
    public function handle()
    {
        // viết code 
        echo 'Đang clear cache';
        // return 0;
        // Artisan::call('cache:clear');
        // Artisan::call('config:cache');
        return 'Success'; // bắt buộc phải có return, return gì cũng được 
    }
}
//-------------------------------------------------------------video 47------------------------------------------------------------


app/Console/Kernel.php

video 47

<?php

namespace App\Console;

use Illuminate\Console\Scheduling\Schedule;
use Illuminate\Foundation\Console\Kernel as ConsoleKernel;
use App\Jobs\DailyReportJob;

class Kernel extends ConsoleKernel
{
    /**
     * The Artisan commands provided by your application.
     *
     * @var array
     */
    protected $commands = [
        //
    ];

    /**
     * Define the application's command schedule.
     *
     * @param  \Illuminate\Console\Scheduling\Schedule  $schedule
     * @return void
     */
    protected function schedule(Schedule $schedule)
    {
        // $schedule->command('inspire')->hourly();
        // $schedule->command('system:clear-cache')->hourly(); // hourly() là 
        $schedule->command('system:clear-cache')->everyFiveMinutes()->withoutOverlapping(); // chạy mỗi phút một lần 
        $schedule->job(new DailyReportJob)->daily(); // chạy App\Jobs\DailyReportJob; mỗi ngày một lần 
    }

    /**
     * Register the commands for the application.
     *
     * @return void
     */
    protected function commands()
    {
        $this->load(__DIR__.'/Commands');

        require base_path('routes/console.php');
    }
}
//-------------------------------------------------------------video 47------------------------------------------------------------


app/Jobs/DailyReportJob.php

video 47

<?php

namespace App\Jobs;

use Illuminate\Bus\Queueable;
use Illuminate\Contracts\Queue\ShouldQueue;
use Illuminate\Foundation\Bus\Dispatchable;
use Illuminate\Queue\InteractsWithQueue;
use Illuminate\Queue\SerializesModels;

class DailyReportJob implements ShouldQueue
{
    use Dispatchable, InteractsWithQueue, Queueable, SerializesModels;

    /**
     * Create a new job instance.
     *
     * @return void
     */
    public function __construct()
    {
        //
    }

    /**
     * Execute the job.
     *
     * @return void
     */
    public function handle()
    {
        //
    }
}


<-------------------------------------------------------------video 47------------------------------------------------------------->







Laravel 48

// video 48 

<?php
//-------------------------------------------------------------video 48------------------------------------------------------------
// code ứng dụng tin tức để có cái thực hành với cache 
// Cache
// config/cache.php, những nơi lưu cache, Drivers: "sync", "database", "beanstalkd", "sqs", "redis", "null"
// Cache driver: Chỉ định cache được lưu ở đâu 
// Cache cái gì
// Cache ở đâu 
// Cache bao lâu 
// Trigger cache bằng gì
// Cache bằng Schedule queue command
// Lưu xuống database : lock
// InnoDB và myIsam (hiểu thêm)
// Các hàm thao tác với Cache : store(), get(), increment(), decrement(), remember(), rememberForever(), pull(), put(), add(), forever(), forget(), flush(),...
// Nhắc lại : Authentication : xác thực
// Authorization : phân quyền 
// Các bước thao tác với Policy
// Là một class định nghĩa quyền
// Tạo policy : php artisan make:policy [Tên_model]Policy --model=[một hoạt nhiều Thư mục chứa model đó nếu có]/[Tên_model]
// Các hàm trong file policies,Map : Policy Method tương ứng với Controller Method
// Code các quy tắc(luật) vào hàm trong file Policy
// Gắn policy với một model (code vào file Model)
// Truyền biến vào hàm trong file Controller tương ứng với hàm trong file Policy đã viết luật 
// Đăng ký policy: authserviceprovider (vào file app/Providers/AuthServiceProvider.php)
// Đăng ký bằng tay
// Đăng ký tự động 





use Illuminate\Support\Facades\Route;

/*
|--------------------------------------------------------------------------
| Web Routes
|--------------------------------------------------------------------------
|
| Here is where you can register web routes for your application. These
| routes are loaded by the RouteServiceProvider within a group which
| contains the "web" middleware group. Now create something great!
|
*/

Route::get('/', function () {
    return view('welcome');
});

Auth::routes();

Route::get('/home', 'HomeController@index')->name('home');

//-----------------------------------------------------------------------------------------
// Route::get('/login/google',function(){ // nếu viết function ở đây thì đỡ phải tạo hàm bên file app/Http/Controllers/Auth/SocialLoginController.php
// còn không thì ở đây chỉ cần tạo route rồi viết hàm bên file kia  
//  return Socialite::driver('google')->redirect();
// })
Route::get('/login/google','Auth\SocialLoginController@redirectToGoogle')->name('google.redirect');
Route::get('/social-login/google','Auth\SocialLoginController@processLoginGoogle');

Route::get('/login/facebook','Auth\SocialLoginController@redirectToFacebook')->name('facebook.redirect');
Route::get('/social-login/facebook','Auth\SocialLoginController@processLoginFacebook');

Route::get('/','LandingPageController@index');

Route::resource('/article','ArticleController');


//-------------------------------------------------------------video 48------------------------------------------------------------


.env 

video 48

APP_NAME=Laravel
APP_ENV=local
APP_KEY=base64:+OCNUfPCEC0pXu4bIrGSgKS1Vn4Vo7JbebMeVKdijZ8=
APP_DEBUG=true
APP_URL=http://localhost

LOG_CHANNEL=stack

DB_CONNECTION=mysql
DB_HOST=localhost
DB_PORT=3306
DB_DATABASE=auth48
DB_USERNAME=root
DB_PASSWORD=

BROADCAST_DRIVER=log
CACHE_DRIVER=file
QUEUE_CONNECTION=database
SESSION_DRIVER=file
SESSION_LIFETIME=120

REDIS_HOST=127.0.0.1
REDIS_PASSWORD=null
REDIS_PORT=6379

MAIL_MAILER=smtp
MAIL_HOST=smtp.mailtrap.io
MAIL_PORT=2525
MAIL_USERNAME=null
MAIL_PASSWORD=null
MAIL_ENCRYPTION=null
MAIL_FROM_ADDRESS=null
MAIL_FROM_NAME="${APP_NAME}"

AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_DEFAULT_REGION=us-east-1
AWS_BUCKET=

PUSHER_APP_ID=
PUSHER_APP_KEY=
PUSHER_APP_SECRET=
PUSHER_APP_CLUSTER=mt1

MIX_PUSHER_APP_KEY="${PUSHER_APP_KEY}"
MIX_PUSHER_APP_CLUSTER="${PUSHER_APP_CLUSTER}"

GOOGLE_CLIENT_ID=779842371071-gn56d5d8o7l8blerqn3nb75v3vnhsbqf.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=YSVd1Sm_tIFsmsf5lp1YISs_
GOOGLE_REDIRECT_URI=http://localhost:8000/social-login/google

FACEBOOK_CLIENT_ID=238901438243111  
FACEBOOK_CLIENT_SECRET=65b85bdb2937ec8b142970630b689dab 
FACEBOOK_REDIRECT_URI=http://localhost:8000/social-login/facebook 
//-------------------------------------------------------------video 48------------------------------------------------------------


app/Models/Article.php

video 48

<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;

class Article extends Model
{
    //
    protected $fillable = ['title','content','user_id'];

    public function user(){
        return $this->belongsTo('App\User');
    }
}
//-------------------------------------------------------------video 48------------------------------------------------------------


database/migrations/2021_09_17_202607_create_articles_table.php

video 48

<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

class CreateArticlesTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::create('articles', function (Blueprint $table) {
            $table->id();
            $table->string('title');
            $table->string('content');
            $table->integer('user_id');
            $table->timestamps();
        });
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::dropIfExists('articles');
    }
}
//-------------------------------------------------------------video 48------------------------------------------------------------


database/seeds/ArticlesTableSeeder.php

video 48

<?php

use Illuminate\Database\Seeder;
use App\Models\Article;

class ArticlesTableSeeder extends Seeder
{
    /**
     * Run the database seeds.
     *
     * @return void
     */
    public function run(){
        for($i=0;$i<100;$i++){
            Article::create([
                'title' => 'bai viet '.$i,
                'content' => 'noi dung '.$i,
                'user_id' => 1
            ]);
        }
    }
}
//-------------------------------------------------------------video 48------------------------------------------------------------


database/seeds/DatabaseSeeder.php

video 48

<?php

use Illuminate\Database\Seeder;

class DatabaseSeeder extends Seeder
{
    /**
     * Seed the application's database.
     *
     * @return void
     */
    public function run()
    {
        // $this->call(UsersTableSeeder::class);
        $this->call(ArticlesTableSeeder::class);
        $this->call(UsersTableSeeder::class);
    }
}
//-------------------------------------------------------------video 48------------------------------------------------------------


app/Http/Controllers/LandingPageController.php 

video 48

<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use App\Models\Article;
use Illuminate\Support\Facades\Cache;

class LandingPageController extends Controller{
    public function index(Request $request){
        // $articles = Article::latest()->paginate(10);
        // $articles = Article::paginate(10);

        // $articles = Cache::remember('homeArticles',60,function(){
        //  return Article::limit(10)->get();
        // });
        $articles = Cache::get('homeArticles');
        return view('landing')->with('articles',$articles);
    }
}
//-------------------------------------------------------------video 48------------------------------------------------------------


resources/views/landing.blade.php

video 48

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Trang chủ</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"  crossorigin="anonymous">
</head>
<body>
<div>
@foreach($articles as $article)
    <div>
        <h2>{{$article->title}}</h2>
        <div>{{$article->content}}</div>
    </div>
@endforeach
</div>
</body>
</html>
//-------------------------------------------------------------video 48------------------------------------------------------------


config/cache.php

video 48

<?php

use Illuminate\Support\Str;

return [

    /*
    |--------------------------------------------------------------------------
    | Default Cache Store
    |--------------------------------------------------------------------------
    |
    | This option controls the default cache connection that gets used while
    | using this caching library. This connection is used when another is
    | not explicitly specified when executing a given caching function.
    |
    | Supported: "apc", "array", "database", "file",
    |            "memcached", "redis", "dynamodb"
    |
    */

    'default' => env('CACHE_DRIVER', 'file'),

    /*
    |--------------------------------------------------------------------------
    | Cache Stores
    |--------------------------------------------------------------------------
    |
    | Here you may define all of the cache "stores" for your application as
    | well as their drivers. You may even define multiple stores for the
    | same cache driver to group types of items stored in your caches.
    |
    */

    'stores' => [

        'apc' => [
            'driver' => 'apc',
        ],

        'array' => [
            'driver' => 'array',
        ],

        'database' => [
            'driver' => 'database',
            'table' => 'cache',
            'connection' => null,
        ],

        'file' => [
            'driver' => 'file',
            'path' => storage_path('framework/cache/data'),
        ],

        'memcached' => [ // giống redis 
            'driver' => 'memcached',
            'persistent_id' => env('MEMCACHED_PERSISTENT_ID'),
            'sasl' => [
                env('MEMCACHED_USERNAME'),
                env('MEMCACHED_PASSWORD'),
            ],
            'options' => [
                // Memcached::OPT_CONNECT_TIMEOUT => 2000,
            ],
            'servers' => [
                [
                    'host' => env('MEMCACHED_HOST', '127.0.0.1'),
                    'port' => env('MEMCACHED_PORT', 11211),
                    'weight' => 100,
                ],
            ],
        ],

        'redis' => [
            'driver' => 'redis',
            'connection' => 'cache',
        ],

        'dynamodb' => [
            'driver' => 'dynamodb',
            'key' => env('AWS_ACCESS_KEY_ID'),
            'secret' => env('AWS_SECRET_ACCESS_KEY'),
            'region' => env('AWS_DEFAULT_REGION', 'us-east-1'),
            'table' => env('DYNAMODB_CACHE_TABLE', 'cache'),
            'endpoint' => env('DYNAMODB_ENDPOINT'),
        ],

    ],

    /*
    |--------------------------------------------------------------------------
    | Cache Key Prefix
    |--------------------------------------------------------------------------
    |
    | When utilizing a RAM based store such as APC or Memcached, there might
    | be other applications utilizing the same cache. So, we'll specify a
    | value to get prefixed to all our keys so we can avoid collisions.
    |
    */

    'prefix' => env('CACHE_PREFIX', Str::slug(env('APP_NAME', 'laravel'), '_').'_cache'),

];
//-------------------------------------------------------------video 48------------------------------------------------------------


app/Console/Commands/CreateHomePageCache.php 

video 48

<?php

namespace App\Console\Commands;

use Illuminate\Console\Command;
use Illuminate\Support\Facades\Cache;
use App\Models\Article;

class CreateHomePageCache extends Command
{
    /**
     * The name and signature of the console command.
     *
     * @var string
     */
    protected $signature = 'home:cache';

    /**
     * The console command description.
     *
     * @var string
     */
    protected $description = 'Command description';

    /**
     * Create a new command instance.
     *
     * @return void
     */
    public function __construct()
    {
        parent::__construct();
    }

    /**
     * Execute the console command.
     *
     * @return int
     */
    public function handle()
    {
        // Cache::remember('homeArticles',60,function(){ 
        //     return Article::limit(10)->get();
        // });
        Cache::rememberForever('homeArticles',function(){ //rememberForever() là hàm lưu giữ mãi mãi 
            return Article::limit(10)->get();
        });
        return 0;
    }
}
//-------------------------------------------------------------video 48------------------------------------------------------------


app/Console/Kernel.php

video 48

<?php

namespace App\Console;

use Illuminate\Console\Scheduling\Schedule;
use Illuminate\Foundation\Console\Kernel as ConsoleKernel;
use App\Jobs\DailyReportJob;

class Kernel extends ConsoleKernel
{
    /**
     * The Artisan commands provided by your application.
     *
     * @var array
     */
    protected $commands = [
        //
    ];

    /**
     * Define the application's command schedule.
     *
     * @param  \Illuminate\Console\Scheduling\Schedule  $schedule
     * @return void
     */
    protected function schedule(Schedule $schedule)
    {
        // $schedule->command('inspire')->hourly();
        // $schedule->command('system:clear-cache')->hourly(); // hourly() là 
        $schedule->command('system:clear-cache')->everyFiveMinutes()->withoutOverlapping(); // chạy mỗi phút một lần 
        $schedule->command('home:cache')->hourly(); // chạy mỗi tiếng một lần 
        $schedule->job(new DailyReportJob)->daily(); // chạy App\Jobs\DailyReportJob; mỗi ngày một lần 
    }

    /**
     * Register the commands for the application.
     *
     * @return void
     */
    protected function commands()
    {
        $this->load(__DIR__.'/Commands');

        require base_path('routes/console.php');
    }
}
//-------------------------------------------------------------video 48------------------------------------------------------------


storage/framework/cache/data/f1/0d (chỉ đọc)

video 48

//-------------------------------------------------------------video 48------------------------------------------------------------


database/migrations/2014_10_12_000000_create_users_table.php

video 48

<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

class CreateUsersTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::create('users', function (Blueprint $table) {
            $table->id();
            $table->string('name');
            $table->string('username')->unique();
            $table->string('phone')->nullable();
            $table->string('address')->nullable();
            $table->string('password')->nullable();
            $table->string('google_id')->nullable();
            $table->string('facebook_id')->nullable();
            $table->string('role')->default('user');
            $table->rememberToken();
            $table->timestamps();
        });
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::dropIfExists('users');
    }
}
//-------------------------------------------------------------video 48------------------------------------------------------------


database/seeds/UsersTableSeeder.php

video 48

<?php

use Illuminate\Database\Seeder;
use Illuminate\Support\Facades\Hash;
use App\User;

class UsersTableSeeder extends Seeder
{
    /**
     * Run the database seeds.
     *
     * @return void
     */
    public function run(){
        User::create([
            'name' => 'admin Van Manh pro',
            'username' => 'admin',
            'role' => 'admin',
            'password' => Hash::make('123123123')
        ]);

        User::create([
            'name' => 'user binh thuong',
            'username' => 'user1',
            'role' => 'user',
            'password' => Hash::make('123123123')
        ]);
    }
}
//-------------------------------------------------------------video 48------------------------------------------------------------


app/User.php

video 48

<?php

namespace App;

use Illuminate\Contracts\Auth\MustVerifyEmail;
use Illuminate\Foundation\Auth\User as Authenticatable;
use Illuminate\Notifications\Notifiable;

class User extends Authenticatable
{
    use Notifiable;

    /**
     * The attributes that are mass assignable.
     *
     * @var array
     */
    protected $fillable = [
        'name', 'username','phone','address','password','google_id',
        'facebook_id',
    ];

    /**
     * The attributes that should be hidden for arrays.
     *
     * @var array
     */
    protected $hidden = [
        'password', 'remember_token',
    ];

    /**
     * The attributes that should be cast to native types.
     *
     * @var array
     */
    protected $casts = [
        'email_verified_at' => 'datetime',
    ];
    public function articles(){
        return $this->hasMany('App\Models\Article');
    }
}
//-------------------------------------------------------------video 48------------------------------------------------------------


app/Http/Controllers/ArticleController.php 

video 48

<?php

namespace App\Http\Controllers;

use App\Models\Article;
use Illuminate\Http\Request;

class ArticleController extends Controller
{
    public function __construct(){
        $this->authorizeResource(Article::class, 'article');
    }
    /**
     * Display a listing of the resource.
     *
     * @return \Illuminate\Http\Response
     */
    public function index()
    {
        //
        return 'Danh sách bài viết';
    }

    /**
     * Show the form for creating a new resource.
     *
     * @return \Illuminate\Http\Response
     */
    public function create()
    {
        //
        return 'Thêm bài viết';
    }

    /**
     * Store a newly created resource in storage.
     *
     * @param  \Illuminate\Http\Request  $request
     * @return \Illuminate\Http\Response
     */
    public function store(Request $request)
    {
        //
        return 'Lưu bài viết';
    }

    /**
     * Display the specified resource.
     *
     * @param  int  $id
     * @return \Illuminate\Http\Response
     */
    public function show($id)
    {
        //
        return 'Hiển thị chi tiết bài viết ';
    }

    /**
     * Show the form for editing the specified resource.
     *
     * @param  int  $id
     * @return \Illuminate\Http\Response
     */
    public function edit(Article $article)
    {
        //
        return 'Sửa bài viết';
    }

    /**
     * Update the specified resource in storage.
     *
     * @param  \Illuminate\Http\Request  $request
     * @param  int  $id
     * @return \Illuminate\Http\Response
     */
    public function update(Request $request, $id)
    {
        //
        return 'Cập nhật bài viết ';
    }

    /**
     * Remove the specified resource from storage.
     *
     * @param  int  $id
     * @return \Illuminate\Http\Response
     */
    public function destroy(Article $article)
    {
        //
        return 'Xóa bài viết';
    }
}
//-------------------------------------------------------------video 48------------------------------------------------------------


app/Policies/ArticlePolicy.php

video 48

<?php

namespace App\Policies;

use App\Models\Article;
use App\User;
use Illuminate\Auth\Access\HandlesAuthorization;

class ArticlePolicy
{
    use HandlesAuthorization;

    /**
     * Determine whether the user can view any models.
     *
     * @param  \App\User  $user
     * @return mixed
     */
    public function viewAny(User $user)
    {
        //
    }

    /**
     * Determine whether the user can view the model.
     *
     * @param  \App\User  $user
     * @param  \App\Models\Article  $article
     * @return mixed
     */
    public function view(User $user, Article $article)
    {
        //
    }

    /**
     * Determine whether the user can create models.
     *
     * @param  \App\User  $user
     * @return mixed
     */
    public function create(User $user)
    {
        //
    }

    /**
     * Determine whether the user can update the model.
     *
     * @param  \App\User  $user
     * @param  \App\Models\Article  $article
     * @return mixed
     */
    public function update(User $user, Article $article){
        
        if($user->role == 'admin'){ // nếu là admin thì pass 
            return true;
        }

        if($article->user_id == $user->id){
            return true;
        }
        // kiểm tra mà nếu user_id của bài viết đó và id của người đang đăng nhập giống nhau 
        // user_id của bài viết là id của user đăng bài viết đó 
        // tức là cùng một người, bài viết này của user này => có quyền 
        return false;
    }

    /**
     * Determine whether the user can delete the model.
     *
     * @param  \App\User  $user
     * @param  \App\Models\Article  $article
     * @return mixed
     */
    public function delete(User $user, Article $article)
    {
        //
        if($user->role == 'admin' || $article->user_id == $user->id){  
            return true;
        }
        // kiểm tra mà nếu user_id của bài viết đó và id của người đang đăng nhập giống nhau 
        // user_id của bài viết là id của user đăng bài viết đó 
        // tức là cùng một người, bài viết này của user này => có quyền 
        return false; // còn nếu không thì return false; không có quyền ;
    }

    /**
     * Determine whether the user can restore the model.
     *
     * @param  \App\User  $user
     * @param  \App\Models\Article  $article
     * @return mixed
     */
    public function restore(User $user, Article $article)
    {
        //
    }

    /**
     * Determine whether the user can permanently delete the model.
     *
     * @param  \App\User  $user
     * @param  \App\Models\Article  $article
     * @return mixed
     */
    public function forceDelete(User $user, Article $article)
    {
        //
    }
}
//-------------------------------------------------------------video 48------------------------------------------------------------


app/Providers/AuthServiceProvider.php

video 48

<?php

namespace App\Providers;

use Illuminate\Foundation\Support\Providers\AuthServiceProvider as ServiceProvider;
use Illuminate\Support\Facades\Gate;
// use App\Models\Article;
// use App\Policies\ArticlePolicy;

class AuthServiceProvider extends ServiceProvider
{
    /**
     * The policy mappings for the application.
     *
     * @var array
     */
    protected $policies = [
        // 'App\Model' => 'App\Policies\ModelPolicy',
       // Article::class => ArticlePolicy::class,
       'App\Models\Article' => 'App\Policies\ArticlePolicy',
    ];

    /**
     * Register any authentication / authorization services.
     *
     * @return void
     */
    public function boot()
    {
        $this->registerPolicies();

        //
    }
}


<-------------------------------------------------------------video 48------------------------------------------------------------->







Laravel 49

// video 49

<?php
//-------------------------------------------------------------video 49------------------------------------------------------------
// tiếp tục với Authorization, Policy
// Nói rõ hơn về Các bước thao tác với Policy
// nói thêm về php artisan route:list
// mối liên quan giữa implicit binding và url, ex : $this->authorizeResource(Article::class, 'article'); và article/{article}
// Một số lưu ý khi dùng Policy, truy cập url, luôn luôn phải sửa dụng implicit binding, Tự động nhận (thư mục Policies ngang hàng với file model)
// Tự đặt quyền khác
// Các cách khá của Authorization
// Tìm hiểu thêm : Index method removed in authorizeResource ? #772, viewAny - index 
// fix viewAny - index, create - create 
// tạo project mới qlct để code bảng kiểm soát,phân quyền
// Làm Menu đa cấp, cực kì hay, quan trọng




use Illuminate\Support\Facades\Route;

/*
|--------------------------------------------------------------------------
| Web Routes
|--------------------------------------------------------------------------
|
| Here is where you can register web routes for your application. These
| routes are loaded by the RouteServiceProvider within a group which
| contains the "web" middleware group. Now create something great!
|
*/

Route::get('/', function () {
    return view('welcome');
});

Auth::routes();

Route::get('/home', 'HomeController@index')->name('home');

//-----------------------------------------------------------------------------------------
// Route::get('/login/google',function(){ // nếu viết function ở đây thì đỡ phải tạo hàm bên file app/Http/Controllers/Auth/SocialLoginController.php
// còn không thì ở đây chỉ cần tạo route rồi viết hàm bên file kia  
//  return Socialite::driver('google')->redirect();
// })
Route::get('/login/google','Auth\SocialLoginController@redirectToGoogle')->name('google.redirect');
Route::get('/social-login/google','Auth\SocialLoginController@processLoginGoogle');

Route::get('/login/facebook','Auth\SocialLoginController@redirectToFacebook')->name('facebook.redirect');
Route::get('/social-login/facebook','Auth\SocialLoginController@processLoginFacebook');

Route::get('/','LandingPageController@index');

// Route::resource('/article','ArticleController'); //+

Route::get('/article/block/{article}','ArticleController@block');

// Route::get('/...','...')->middleware(['auth','can:update,delete']);

Route::resource('/article','ArticleController')->except('index');
Route::get('/article','ArticleController@index');
// Route::get('/article','ArticleController@index')->middleware(['auth','can::viewAny']);


//-------------------------------------------------------------video 49------------------------------------------------------------


.env 

video 49 

APP_NAME=Laravel
APP_ENV=local
APP_KEY=base64:+OCNUfPCEC0pXu4bIrGSgKS1Vn4Vo7JbebMeVKdijZ8=
APP_DEBUG=true
APP_URL=http://localhost

LOG_CHANNEL=stack

DB_CONNECTION=mysql
DB_HOST=localhost
DB_PORT=3306
DB_DATABASE=auth49
DB_USERNAME=root
DB_PASSWORD=

BROADCAST_DRIVER=log
CACHE_DRIVER=file
QUEUE_CONNECTION=database
SESSION_DRIVER=file
SESSION_LIFETIME=120

REDIS_HOST=127.0.0.1
REDIS_PASSWORD=null
REDIS_PORT=6379

MAIL_MAILER=smtp
MAIL_HOST=smtp.mailtrap.io
MAIL_PORT=2525
MAIL_USERNAME=null
MAIL_PASSWORD=null
MAIL_ENCRYPTION=null
MAIL_FROM_ADDRESS=null
MAIL_FROM_NAME="${APP_NAME}"

AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_DEFAULT_REGION=us-east-1
AWS_BUCKET=

PUSHER_APP_ID=
PUSHER_APP_KEY=
PUSHER_APP_SECRET=
PUSHER_APP_CLUSTER=mt1

MIX_PUSHER_APP_KEY="${PUSHER_APP_KEY}"
MIX_PUSHER_APP_CLUSTER="${PUSHER_APP_CLUSTER}"

GOOGLE_CLIENT_ID=779842371071-gn56d5d8o7l8blerqn3nb75v3vnhsbqf.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=YSVd1Sm_tIFsmsf5lp1YISs_
GOOGLE_REDIRECT_URI=http://localhost:8000/social-login/google

FACEBOOK_CLIENT_ID=238901438243111  
FACEBOOK_CLIENT_SECRET=65b85bdb2937ec8b142970630b689dab 
FACEBOOK_REDIRECT_URI=http://localhost:8000/social-login/facebook 
//-------------------------------------------------------------video 49------------------------------------------------------------


app/Models/Article.php

video 49 

<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;

class Article extends Model
{
    //
    protected $fillable = ['title','content','user_id'];

    public function user(){
      return $this->belongsTo('App\User');
    }
}
//-------------------------------------------------------------video 49------------------------------------------------------------


app/User.php

video 49 

<?php

namespace App;

use Illuminate\Contracts\Auth\MustVerifyEmail;
use Illuminate\Foundation\Auth\User as Authenticatable;
use Illuminate\Notifications\Notifiable;

class User extends Authenticatable
{
    use Notifiable;

    /**
     * The attributes that are mass assignable.
     *
     * @var array
     */
    protected $fillable = [
        'name', 'username','phone','address','password','google_id',
        'facebook_id',
    ];

    /**
     * The attributes that should be hidden for arrays.
     *
     * @var array
     */
    protected $hidden = [
        'password', 'remember_token',
    ];

    /**
     * The attributes that should be cast to native types.
     *
     * @var array
     */
    protected $casts = [
        'email_verified_at' => 'datetime',
    ];
    public function articles(){
        return $this->hasMany('App\Models\Article');
    }
}
//-------------------------------------------------------------video 49------------------------------------------------------------


app/Http/Controllers/ArticleController.php 

video 49 

<?php

namespace App\Http\Controllers;

use App\Models\Article;
use Illuminate\Http\Request;

class ArticleController extends Controller
{
    public function __construct(){
        $this->authorizeResource(Article::class, 'article',['except' => ['index']]);
    }
    /**
     * Display a listing of the resource.
     *
     * @return \Illuminate\Http\Response
     */
    public function index()
    {
        //
        $this->authorize('viewAny' ,Article::class);
        return 'Danh sách bài viết';
    }

    /**
     * Show the form for creating a new resource.
     *
     * @return \Illuminate\Http\Response
     */
    public function create()
    {
        //
        // $this->authorize('create' ,Article::class);
        return 'Thêm bài viết';
    }

    /**
     * Store a newly created resource in storage.
     *
     * @param  \Illuminate\Http\Request  $request
     * @return \Illuminate\Http\Response
     */
    public function store(Request $request)
    {
        //
        return 'Lưu bài viết';
    }

    /**
     * Display the specified resource.
     *
     * @param  int  $id
     * @return \Illuminate\Http\Response
     */
    public function show($id)
    {
        //
        return 'Hiển thị chi tiết bài viết ';
    }

    /**
     * Show the form for editing the specified resource.
     *
     * @param  int  $id
     * @return \Illuminate\Http\Response
     */
    public function edit(Article $article)
    {
        //
        return 'Sửa bài viết';
    }

    /**
     * Update the specified resource in storage.
     *
     * @param  \Illuminate\Http\Request  $request
     * @param  int  $id
     * @return \Illuminate\Http\Response
     */
    public function update(Request $request, $id)
    {
        //
        return 'Cập nhật bài viết ';
    }

    /**
     * Remove the specified resource from storage.
     *
     * @param  int  $id
     * @return \Illuminate\Http\Response
     */
    public function destroy(Article $article)
    {
        //
        return 'Xóa bài viết';
    }
    public function block(Request $request, Article $article){
        $this->authorize('blockArticle',$article);
    }

}
//-------------------------------------------------------------video 49------------------------------------------------------------


app/Policies/ArticlePolicy.php

video 49 

<?php

namespace App\Policies;

use App\Models\Article;
use App\User;
use Illuminate\Auth\Access\HandlesAuthorization;

class ArticlePolicy
{
    use HandlesAuthorization;

    /**
     * Determine whether the user can view any models.
     *
     * @param  \App\User  $user
     * @return mixed
     */
    public function viewAny(User $user)
    {
        //
        return true;
    }

    /**
     * Determine whether the user can view the model.
     *
     * @param  \App\User  $user
     * @param  \App\Models\Article  $article
     * @return mixed
     */
    public function view(User $user, Article $article)
    {
        //
    }

    /**
     * Determine whether the user can create models.
     *
     * @param  \App\User  $user
     * @return mixed
     */
    public function create(User $user)
    {
        //
    }

    /**
     * Determine whether the user can update the model.
     *
     * @param  \App\User  $user
     * @param  \App\Models\Article  $article
     * @return mixed
     */
    public function update(User $user, Article $article){
        
        if($user->role == 'admin'){ // nếu là admin thì pass 
            return true;
        }

        if($article->user_id == $user->id){
            return true;
        }
        // kiểm tra mà nếu user_id của bài viết đó và id của người đang đăng nhập giống nhau 
        // user_id của bài viết là id của user đăng bài viết đó 
        // tức là cùng một người, bài viết này của user này => có quyền 
        return false;
    }

    /**
     * Determine whether the user can delete the model.
     *
     * @param  \App\User  $user
     * @param  \App\Models\Article  $article
     * @return mixed
     */
    public function delete(User $user, Article $article)
    {
        //
        if($user->role == 'admin' || $article->user_id == $user->id){  
            return true;
        }
        // kiểm tra mà nếu user_id của bài viết đó và id của người đang đăng nhập giống nhau 
        // user_id của bài viết là id của user đăng bài viết đó 
        // tức là cùng một người, bài viết này của user này => có quyền 
        return false; // còn nếu không thì return false; không có quyền ;
    }

    /**
     * Determine whether the user can restore the model.
     *
     * @param  \App\User  $user
     * @param  \App\Models\Article  $article
     * @return mixed
     */
    public function restore(User $user, Article $article)
    {
        //
    }

    /**
     * Determine whether the user can permanently delete the model.
     *
     * @param  \App\User  $user
     * @param  \App\Models\Article  $article
     * @return mixed
     */
    public function forceDelete(User $user, Article $article)
    {
        //
    }
    public function blockArticle(User $user,Article $article){
        return true;
    }
}
//-------------------------------------------------------------video 49------------------------------------------------------------


app/Providers/AuthServiceProvider.php

video 49 

<?php

namespace App\Providers;

use Illuminate\Foundation\Support\Providers\AuthServiceProvider as ServiceProvider;
use Illuminate\Support\Facades\Gate;
// use App\Models\Article;
// use App\Policies\ArticlePolicy;

class AuthServiceProvider extends ServiceProvider
{
    /**
     * The policy mappings for the application.
     *
     * @var array
     */
    protected $policies = [
        // 'App\Model' => 'App\Policies\ModelPolicy',
       // Article::class => ArticlePolicy::class,
       'App\Models\Article' => 'App\Policies\ArticlePolicy',
    ];

    /**
     * Register any authentication / authorization services.
     *
     * @return void
     */
    public function boot()
    {
        $this->registerPolicies();

        //
    }
}
//-------------------------------------------------------------video 49------------------------------------------------------------


qlct (quản lý công ty)
database : qlct 
routes/web.php 

video 49

<?php

use Illuminate\Support\Facades\Route;

/*
|--------------------------------------------------------------------------
| Web Routes
|--------------------------------------------------------------------------
|
| Here is where you can register web routes for your application. These
| routes are loaded by the RouteServiceProvider within a group which
| contains the "web" middleware group. Now create something great!
|
*/

Route::get('/', function () {
    return view('welcome');
});

Auth::routes();

Route::get('/home', 'HomeController@index')->name('home');
Route::get('/admin', 'AdminController@index')->name('admin')->middleware('role:admin');

//-------------------------------------------------------------video 49------------------------------------------------------------


.env 

video 49 

APP_NAME=Laravel
APP_ENV=local
APP_KEY=base64:+QbiuPIW+Hf2sCQfOxWgQwL0UYbU/7rj4lC2nIn7SuU=
APP_DEBUG=true
APP_URL=http://localhost

LOG_CHANNEL=stack

DB_CONNECTION=mysql
DB_HOST=localhost 
DB_PORT=3306
DB_DATABASE=qlct
DB_USERNAME=root
DB_PASSWORD=

BROADCAST_DRIVER=log
CACHE_DRIVER=file
QUEUE_CONNECTION=sync
SESSION_DRIVER=file
SESSION_LIFETIME=120

REDIS_HOST=127.0.0.1
REDIS_PASSWORD=null
REDIS_PORT=6379

MAIL_MAILER=smtp
MAIL_HOST=smtp.mailtrap.io
MAIL_PORT=2525
MAIL_USERNAME=null
MAIL_PASSWORD=null
MAIL_ENCRYPTION=null
MAIL_FROM_ADDRESS=null
MAIL_FROM_NAME="${APP_NAME}"

AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_DEFAULT_REGION=us-east-1
AWS_BUCKET=

PUSHER_APP_ID=
PUSHER_APP_KEY=
PUSHER_APP_SECRET=
PUSHER_APP_CLUSTER=mt1

MIX_PUSHER_APP_KEY="${PUSHER_APP_KEY}"
MIX_PUSHER_APP_CLUSTER="${PUSHER_APP_CLUSTER}"
//-------------------------------------------------------------video 49------------------------------------------------------------


database/migrations/2014_10_12_000000_create_users_table.php

video 49

<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

class CreateUsersTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::create('users', function (Blueprint $table) {
            $table->id();
            $table->string('name');
            $table->string('email')->unique();
            $table->timestamp('email_verified_at')->nullable();
            $table->string('password');
            $table->string('role')->default('user');
            $table->rememberToken();
            $table->timestamps();
        });
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::dropIfExists('users');
    }
}
//-------------------------------------------------------------video 49------------------------------------------------------------


app/Http/Middleware/RoleMiddleware.php

video 49 

<?php

namespace App\Http\Middleware;

use Closure;

class RoleMiddleware
{
    /**
     * Handle an incoming request.
     *
     * @param  \Illuminate\Http\Request  $request
     * @param  \Closure  $next
     * @return mixed
     */
    public function handle($request, Closure $next,$role){
        if(auth()->user() && auth()->user()->role == $role){
            return $next($request);
        }
        abort(404,'Trang không tìm thấy');
    }
}
//-------------------------------------------------------------video 49------------------------------------------------------------


app/Http/Kernel.php 

video 49 

<?php

namespace App\Http;

use Illuminate\Foundation\Http\Kernel as HttpKernel;

class Kernel extends HttpKernel
{
    /**
     * The application's global HTTP middleware stack.
     *
     * These middleware are run during every request to your application.
     *
     * @var array
     */
    protected $middleware = [
        \App\Http\Middleware\TrustProxies::class,
        \Fruitcake\Cors\HandleCors::class,
        \App\Http\Middleware\CheckForMaintenanceMode::class,
        \Illuminate\Foundation\Http\Middleware\ValidatePostSize::class,
        \App\Http\Middleware\TrimStrings::class,
        \Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull::class,
    ];

    /**
     * The application's route middleware groups.
     *
     * @var array
     */
    protected $middlewareGroups = [
        'web' => [
            \App\Http\Middleware\EncryptCookies::class,
            \Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse::class,
            \Illuminate\Session\Middleware\StartSession::class,
            // \Illuminate\Session\Middleware\AuthenticateSession::class,
            \Illuminate\View\Middleware\ShareErrorsFromSession::class,
            \App\Http\Middleware\VerifyCsrfToken::class,
            \Illuminate\Routing\Middleware\SubstituteBindings::class,
        ],

        'api' => [
            'throttle:60,1',
            \Illuminate\Routing\Middleware\SubstituteBindings::class,
        ],
    ];

    /**
     * The application's route middleware.
     *
     * These middleware may be assigned to groups or used individually.
     *
     * @var array
     */
    protected $routeMiddleware = [
        'auth' => \App\Http\Middleware\Authenticate::class,
        'auth.basic' => \Illuminate\Auth\Middleware\AuthenticateWithBasicAuth::class,
        'bindings' => \Illuminate\Routing\Middleware\SubstituteBindings::class,
        'cache.headers' => \Illuminate\Http\Middleware\SetCacheHeaders::class,
        'can' => \Illuminate\Auth\Middleware\Authorize::class,
        'guest' => \App\Http\Middleware\RedirectIfAuthenticated::class,
        'password.confirm' => \Illuminate\Auth\Middleware\RequirePassword::class,
        'signed' => \Illuminate\Routing\Middleware\ValidateSignature::class,
        'throttle' => \Illuminate\Routing\Middleware\ThrottleRequests::class,
        'verified' => \Illuminate\Auth\Middleware\EnsureEmailIsVerified::class,
        'role' => \App\Http\Middleware\RoleMiddleware::class,
    ];
}
//-------------------------------------------------------------video 49------------------------------------------------------------


app/Http/Controllers/AdminController.php

video 49 

<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use App\Models\Menu;

class AdminController extends Controller
{
    //
  //   public function index(){
  //    $menus = Menu::whereNull('parent_id')
    //         ->with('children') 
    //          ->get();
  //    // dd($menus);
    // echo '<ul>';
    // foreach ($menus as $menu){
    //  echo '<li>'.$menu->text.'</li>';
    //  echo '<br>';
    //  echo '<ul>';
    //  foreach ($menu->children as $childMenu){
    //    echo $childMenu->text;
    //    echo '<br>';
    //    echo '<ul>';
    //    foreach ($childMenu->children as $chaudMenu){
    //      echo $chaudMenu->text;
    //      echo '<br>';
    //    }
    //    echo '</ul>';
    //  }
    //  echo '</ul>';
    // }
    // echo '</ul>';

  //    return view('home');
  //   }
   // => dùng while để tối ưu code, không dùng nhiều foreach 
  public function showMenu($menus){
    echo '<ul>';
    foreach ($menus as $menu){
      echo '<li>'.$menu->text.'</li>';
      echo '<br>';
      if($menu->children){ // đệ quy 
        $this->showMenu($menu->children); 
      }
      echo '</ul>';
    }
  }

    public function index(){
      $menus = Menu::whereNull('parent_id')
             ->with('children') 
              ->get();

      $this->showMenu($menus);

      return view('home');
    }
}
//-------------------------------------------------------------video 49------------------------------------------------------------


app/Models/Permission.php

video 49 

<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;

class Permission extends Model{
    protected $fillable = ['name'];

    public function users(){
      return $this->belongsToMany('App\User');
    }
}
//-------------------------------------------------------------video 49------------------------------------------------------------


database/migrations/2021_09_19_091429_create_permissions_table.php

video 49 

<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

class CreatePermissionsTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::create('permissions', function (Blueprint $table) {
            $table->id();
            $table->string('name');
            $table->timestamps();
        });
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::dropIfExists('permissions');
    }
}
//-------------------------------------------------------------video 49------------------------------------------------------------


app/User.php

video 49 

<?php

namespace App;

use Illuminate\Contracts\Auth\MustVerifyEmail;
use Illuminate\Foundation\Auth\User as Authenticatable;
use Illuminate\Notifications\Notifiable;

class User extends Authenticatable
{
    use Notifiable;

    /**
     * The attributes that are mass assignable.
     *
     * @var array
     */
    protected $fillable = [
        'name', 'email', 'password',
    ];

    /**
     * The attributes that should be hidden for arrays.
     *
     * @var array
     */
    protected $hidden = [
        'password', 'remember_token',
    ];

    /**
     * The attributes that should be cast to native types.
     *
     * @var array
     */
    protected $casts = [
        'email_verified_at' => 'datetime',
    ];

    public function permission(){
        return $this->belongsToMany('App\Models\Permission');
    }


}
//-------------------------------------------------------------video 49------------------------------------------------------------


database/migrations/2021_09_19_092226_create_user_permission_table.php 

video 49 

<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

class CreateUserPermissionTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::create('user_permission', function (Blueprint $table) {
            $table->id();
            $table->integer('user_id');
            $table->integer('permission_id');
            $table->timestamps();
        });
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::dropIfExists('user_permission');
    }
}
//-------------------------------------------------------------video 49------------------------------------------------------------


app/Policies/UserPolicy.php

video 49 

<?php

namespace App\Policies;

use App\User;
use Illuminate\Auth\Access\HandlesAuthorization;

class UserPolicy
{
    use HandlesAuthorization;

    /**
     * Determine whether the user can view any models.
     *
     * @param  \App\User  $user
     * @return mixed
     */
    public function viewAny(User $user)
    {
        //
    }

    /**
     * Determine whether the user can view the model.
     *
     * @param  \App\User  $user
     * @param  \App\User  $model
     * @return mixed
     */
    public function view(User $user, User $model)
    {
        //
    }

    /**
     * Determine whether the user can create models.
     *
     * @param  \App\User  $user
     * @return mixed
     */
    public function create(User $user)
    {
        //
    }

    /**
     * Determine whether the user can update the model.
     *
     * @param  \App\User  $user
     * @param  \App\User  $model
     * @return mixed
     */
    public function update(User $user, User $model)
    {
        //
    }

    /**
     * Determine whether the user can delete the model.
     *
     * @param  \App\User  $user
     * @param  \App\User  $model
     * @return mixed
     */
    public function delete(User $user, User $model)
    {
        //
    }

    /**
     * Determine whether the user can restore the model.
     *
     * @param  \App\User  $user
     * @param  \App\User  $model
     * @return mixed
     */
    public function restore(User $user, User $model)
    {
        //
    }

    /**
     * Determine whether the user can permanently delete the model.
     *
     * @param  \App\User  $user
     * @param  \App\User  $model
     * @return mixed
     */
    public function forceDelete(User $user, User $model)
    {
        //
    }
}
//-------------------------------------------------------------video 49------------------------------------------------------------


app/Policies/ArticlePolicy.php

video 49 

<?php

namespace App\Policies;

use App\Article;
use App\User;
use Illuminate\Auth\Access\HandlesAuthorization;

class ArticlePolicy
{
    use HandlesAuthorization;

    /**
     * Determine whether the user can view any models.
     *
     * @param  \App\User  $user
     * @return mixed
     */
    public function viewAny(User $user)
    {
        //
    }

    /**
     * Determine whether the user can view the model.
     *
     * @param  \App\User  $user
     * @param  \App\Article  $article
     * @return mixed
     */
    public function view(User $user, Article $article)
    {
        //
    }

    /**
     * Determine whether the user can create models.
     *
     * @param  \App\User  $user
     * @return mixed
     */
    public function create(User $user)
    {
        //
        $permission = $user->permissions()->where('name','create_article')->first();
        if($permission){
            return true;
        }
        return false;
    }

    /**
     * Determine whether the user can update the model.
     *
     * @param  \App\User  $user
     * @param  \App\Article  $article
     * @return mixed
     */
    public function update(User $user, Article $article)
    {
        //
    }

    /**
     * Determine whether the user can delete the model.
     *
     * @param  \App\User  $user
     * @param  \App\Article  $article
     * @return mixed
     */
    public function delete(User $user, Article $article)
    {
        //
    }

    /**
     * Determine whether the user can restore the model.
     *
     * @param  \App\User  $user
     * @param  \App\Article  $article
     * @return mixed
     */
    public function restore(User $user, Article $article)
    {
        //
    }

    /**
     * Determine whether the user can permanently delete the model.
     *
     * @param  \App\User  $user
     * @param  \App\Article  $article
     * @return mixed
     */
    public function forceDelete(User $user, Article $article)
    {
        //
    }
}
//-------------------------------------------------------------video 49------------------------------------------------------------


app/Models/Menu.php

video 49 

<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;

class Menu extends Model
{
    //
    public function parent(){
      return $this->belongsTo('App\Models\Menu', 'parent_id'); // quan hệ một nhiều với chính nó 
    }

    public function children(){
      return $this->hasMany('App\Models\Menu', 'parent_id');
            ->with('children'); // quan hệ một nhiều với chính nó 
    }
}
//-------------------------------------------------------------video 49------------------------------------------------------------


database/migrations/2021_09_19_094533_create_menus_table.php 

video 49 

<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

class CreateMenusTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::create('menus', function (Blueprint $table) {
            $table->id();
            $table->string('text');
            $table->string('link');
            $table->integer('parent_id')->nullable();//có thể null // để xác định menu cha của nó 
            $table->timestamps();
        });
    }

    /**
     * Reverse the migrations.
     *
     * @return void;
     */
    public function down()
    {
        Schema::dropIfExists('menus');
    }
}


<-------------------------------------------------------------video 49------------------------------------------------------------->
                                                       
                                                            Xong Laravel 
                                                           Xong Back-End

















